/*! tableau-2.8.0 */ !function(){/*! BEGIN MscorlibSlim */ var e,t,i,n,r,a,s,o,l,u,c,h,m,d,p,f,g,v,y,w,b,S,C,I,T,k,A,E,V,N,F,O,D,R,P,z,x,U,$,M,_,H,L,W,j={};e=j,a={__assemblies:{}},a.initAssembly=function(e,t,i){i=i||{},e.name=t,e.toString=function(){return this.name},e.__types={},e.getResourceNames=function(){return Object.keys(i)},e.getResourceDataBase64=function(e){return i[e]||null},e.getResourceData=function(e){var t=i[e];return t?a.dec64(t):null},a.__assemblies[t]=e},a.initAssembly(a,"mscorlib"),a.getAssemblies=function(){return Object.keys(a.__assemblies).map(function(e){return a.__assemblies[e]})},a.isNullOrUndefined=function(e){return null==e},a.isValue=function(e){return null!=e},a.referenceEquals=function(e,t){return a.isValue(e)?e===t:!a.isValue(t)},a.mkdict=function(){for(var e=1!==arguments.length?arguments:arguments[0],t={},i=0;i<e.length;i+=2)t[e[i]]=e[i+1];return t},a.clone=function(e,t){return t?e.$clone(t):t},a.coalesce=function(e,t){return a.isValue(e)?e:t},a.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},a.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},a.isTypedArrayType=function(e){return["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint16Array","Uint32Array","Uint8ClampedArray"].indexOf(a.getTypeFullName(e))>=0},a.isArrayOrTypedArray=function(e){return a.isArray(e)||a.isTypedArrayType(a.getInstanceType(e))},a.equals=function(e,t){if(a.isValue(e)){if(e!==a&&"function"==typeof e.equals)return e.equals(t)}else throw new H("Object is null");return a.isDate(e)&&a.isDate(t)?e.valueOf()===t.valueOf():"function"==typeof e&&"function"==typeof t?a.delegateEquals(e,t):!!(a.isNullOrUndefined(e)&&a.isNullOrUndefined(t))||e===t},a.compare=function(e,t){if(a.isValue(e))return"number"==typeof e||"string"==typeof e||"boolean"==typeof e?a.isValue(t)?e<t?-1:e>t?1:0:1:a.isDate(e)?a.isValue(t)?a.compare(e.valueOf(),t.valueOf()):1:e.compareTo(t);throw new H("Object is null")},a.equalsT=function(e,t){if(a.isValue(e))return"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e===t:a.isDate(e)?e.valueOf()===t.valueOf():e.equalsT(t);throw new H("Object is null")},a.staticEquals=function(e,t){return a.isValue(e)?!!a.isValue(t)&&a.equals(e,t):!a.isValue(t)},a.shallowCopy=!function(){try{return Object.getOwnPropertyDescriptor({a:0},"a").value,!0}catch(e){return!1}}()?function(e,t){for(var i=Object.keys(e),n=0,r=i.length;n<r;n++)t[i[n]]=e[i[n]]}:function(e,t){for(var i=Object.keys(e),n=0,r=i.length;n<r;n++)Object.defineProperty(t,i[n],Object.getOwnPropertyDescriptor(e,i[n]))},"object"==typeof window&&(window.Element||(window.Element=function(){},window.Element.isInstanceOfType=function(e){return e&&void 0===e.constructor&&"string"==typeof e.tagName}),window.Element.__typeName="Element",a.parseXml=function(e){return new DOMParser().parseFromString(e,"text/xml")}),a.clearKeys=function(e){for(var t in e)e.hasOwnProperty(t)&&delete e[t]},a.keyExists=function(e,t){return void 0!==e[t]},Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,i=!({toString:null}).propertyIsEnumerable("toString"),r=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw TypeError("Object.keys called on non-object");var a,s,o=[];for(a in e)t.call(e,a)&&o.push(a);if(i)for(s=0;s<r;s++)t.call(e,n[s])&&o.push(n[s]);return o})),a.getKeyCount=function(e){return Object.keys(e).length},a.__genericCache={},a._makeGenericTypeName=function(e,t){for(var i=a.getTypeFullName(e),n=0;n<t.length;n++)i+=(0===n?"[":",")+"["+a.getTypeFullName(t[n])+"]";return i+"]"},a.makeGenericType=function(e,t){var i=a._makeGenericTypeName(e,t);return a.__genericCache[a._makeQName(i,e.__assembly)]||e.apply(null,t)},a._registerGenericInstance=function(e,t,i,n,r,s){i||(i=function(){});var o=a._makeGenericTypeName(e,t);return a.__genericCache[a._makeQName(o,e.__assembly)]=i,i.__typeName=o,i.__assembly=e.__assembly,i.__genericTypeDefinition=e,i.__typeArguments=t,r&&a.shallowCopy(r,i),s(i),n&&a.shallowCopy(n,i.prototype),i},a.registerGenericClassInstance=function(e,t,i,n,r,s,o){return a._registerGenericInstance(e,t,i,n,r,function(e){a.initClass(e,s?s():null,o?o():null)})},a.registerGenericStructInstance=function(e,t,i,n,r,s){return a._registerGenericInstance(e,t,i,n,r,function(e){a.initStruct(e,s?s():null)})},a.registerGenericInterfaceInstance=function(e,t,i,n){return a._registerGenericInstance(e,t,null,i,null,function(e){a.initInterface(e,i,n?n():null)})},a.isGenericTypeDefinition=function(e){return e.__isGenericTypeDefinition||!1},a.getGenericTypeDefinition=function(e){return e.__genericTypeDefinition||null},a.getGenericParameterCount=function(e){return e.__typeArgumentCount||0},a.getGenericArguments=function(e){return e.__typeArguments||null},a.__anonymousCache={},a.anonymousType=function(){var e=Array.prototype.slice.call(arguments),t="Anonymous<"+e.map(function(e){return e[1]+":"+a.getTypeFullName(e[0])}).join(",")+">",i=a.__anonymousCache[t];if(!i){(i=Function(e.map(function(e){return e[1]}).join(","),e.map(function(e){return"this."+e[1]+"="+e[1]+";"}).join(""))).__typeName=t;var n=e.map(function(e){return{name:e[1],typeDef:i,type:16,returnType:e[0],getter:{name:"get_"+e[1],typeDef:i,params:[],returnType:e[0],fget:e[1]}}});n.push({name:".ctor",typeDef:i,type:1,params:e.map(function(e){return e[0]})}),i.__metadata={members:n},a.__anonymousCache[t]=i}return i},a.setMetadata=function(e,t){if(t.members)for(var i=0;i<t.members.length;i++){var n=t.members[i];n.typeDef=e,n.adder&&(n.adder.typeDef=e),n.remover&&(n.remover.typeDef=e),n.getter&&(n.getter.typeDef=e),n.setter&&(n.setter.typeDef=e)}e.__metadata=t,t.variance&&(e.isAssignableFrom=function(e){var t=function(e,t){if(t.__genericTypeDefinition===e.__genericTypeDefinition&&t.__typeArguments.length===e.__typeArguments.length){for(var i=0;i<e.__typeArguments.length;i++){var n=e.__metadata.variance[i],r=e.__typeArguments[i],s=t.__typeArguments[i];switch(n){case 1:if(!a.isAssignableFrom(r,s))return!1;break;case 2:if(!a.isAssignableFrom(s,r))return!1;break;default:if(s!==r)return!1}}return!0}return!1};if(e.__interface&&t(this,e))return!0;for(var i=a.getInterfaces(e),n=0;n<i.length;n++)if(i[n]===this||t(this,i[n]))return!0;return!1})},a.setMetadata=function(e,t){},a.mkType=function(e,t,i,n,r){return i||(i=function(){}),i.__assembly=e,i.__typeName=t,e&&(e.__types[t]=i),n&&(i.__members=n),r&&a.shallowCopy(r,i),i},a.mkEnum=function(e,t,i,n){var r=a.mkType(e,t);return a.shallowCopy(i,r.prototype),r.__enum=!0,r.getDefaultValue=r.createInstance=function(){return n?null:0},r.isInstanceOfType=function(e){return typeof e==(n?"string":"number")},r},a.initClass=function(e,t,i){if(e.__class=!0,t&&t!==Object){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}e.__members&&(a.shallowCopy(e.__members,e.prototype),delete e.__members),i&&(e.__interfaces=i)},a.initStruct=function(e,t){a.initClass(e,null,t),e.__class=!1,e.getDefaultValue=e.getDefaultValue||e.createInstance||function(){return new e}},a.initGenericClass=function(e,t){e.__class=!0,e.__typeArgumentCount=t,e.__isGenericTypeDefinition=!0},a.initGenericStruct=function(e,t){a.initGenericClass(e,t),e.__class=!1},a.initInterface=function(e,t,i){e.__interface=!0,i&&(e.__interfaces=i),a.shallowCopy(t,e.prototype),e.isAssignableFrom=function(e){return a.contains(a.getInterfaces(e),this)}},a.initGenericInterface=function(e,t){e.__interface=!0,e.__typeArgumentCount=t,e.__isGenericTypeDefinition=!0},a.getBaseType=function(e){if(e===Object||e.__interface)return null;if(Object.getPrototypeOf)return Object.getPrototypeOf(e.prototype).constructor;var t=e.prototype;if(Object.prototype.hasOwnProperty.call(t,"constructor")){var i=t.constructor;try{delete t.constructor}finally{t.constructor=i}}return t.constructor},a.getTypeFullName=function(e){return e.__typeName||e.name||(e.toString().match(/^\s*function\s*([^\s(]+)/)||[])[1]||"Object"},a._makeQName=function(e,t){return e+(t?", "+t.name:"")},a.getTypeQName=function(e){return a._makeQName(a.getTypeFullName(e),e.__assembly)},a.getTypeName=function(e){var t=a.getTypeFullName(e),i=t.indexOf("["),n=t.lastIndexOf(".",i>=0?i:t.length);return n>0?t.substr(n+1):t},a.getTypeNamespace=function(e){var t=a.getTypeFullName(e),i=t.indexOf("["),n=t.lastIndexOf(".",i>=0?i:t.length);return n>0?t.substr(0,n):""},a.getTypeAssembly=function(e){return a.contains([Date,Number,Boolean,String,Function,Array],e)?a:e.__assembly||null},a._getAssemblyType=function(e,t){if(e.__types)return e.__types[t]||null;for(var i=t.split("."),n=0;n<i.length;n++)if(e=e[i[n]],!a.isValue(e))return null;return"function"!=typeof e?null:e},a.getAssemblyTypes=function(e){var t=[];if(e.__types)for(var i in e.__types)e.__types.hasOwnProperty(i)&&t.push(e.__types[i]);else{var n=function(e,i){for(var r in e)e.hasOwnProperty(r)&&n(e[r],r);"function"==typeof e&&a.isUpper(i.charCodeAt(0))&&t.push(e)};n(e,"")}return t},a.createAssemblyInstance=function(e,t){var i=a.getType(t,e);return i?a.createInstance(i):null},a.getInterfaces=function(e){return e.__interfaces?e.__interfaces:e===Date||e===Number?[l,o,s]:e===Boolean||e===String?[l,o]:e===Array||a.isTypedArrayType(e)?[h,m,v,d,y]:[]},a.isInstanceOfType=function(e,t){return!a.isNullOrUndefined(e)&&("function"==typeof t.isInstanceOfType?t.isInstanceOfType(e):a.isAssignableFrom(t,a.getInstanceType(e)))},a.isAssignableFrom=function(e,t){return e===t||"function"==typeof e.isAssignableFrom&&e.isAssignableFrom(t)||t.prototype instanceof e},a.isClass=function(e){return!0===e.__class||e===Array||e===Function||e===RegExp||e===String||e===Error||e===Object},a.isEnum=function(e){return!!e.__enum},a.isFlags=function(e){return e.__metadata&&e.__metadata.enumFlags||!1},a.isInterface=function(e){return!!e.__interface},a.safeCast=function(e,t){return!0===t?e:!1===t?null:a.isInstanceOfType(e,t)?e:null},a.cast=function(e,t){if(null==e||!0===t||!1!==t&&a.isInstanceOfType(e,t))return e;throw new M("Cannot cast object to type "+a.getTypeFullName(t))},a.getInstanceType=function(e){if(!a.isValue(e))throw new H("Cannot get type of null");try{return e.constructor}catch(t){return Object}},a._getType=function(t,i,n){var r,s,o=!n,l=(n=n||/[[,\]]/g).lastIndex,u=n.exec(t),c=[];if(u)switch(s=t.substring(l,u.index),u[0]){case"[":if("["!==t[u.index+1])return null;for(;;){if(n.exec(t),!(r=a._getType(t,e,n)))return null;if(c.push(r),"]"===(u=n.exec(t))[0])break;if(","!==u[0])return null}if((u=n.exec(t))&&","===u[0]&&(n.exec(t),!(i=a.__assemblies[(n.lastIndex>0?t.substring(u.index+1,n.lastIndex-1):t.substring(u.index+1)).trim()])))return null;break;case"]":break;case",":if(n.exec(t),!(i=a.__assemblies[(n.lastIndex>0?t.substring(u.index+1,n.lastIndex-1):t.substring(u.index+1)).trim()]))return null}else s=t.substring(l);return o&&n.lastIndex?null:(r=a._getAssemblyType(i,s.trim()),c.length?a.makeGenericType(r,c):r)},a.getType=function(t,i){return t?a._getType(t,i||e):null},a.getDefaultValue=function(e){return"function"==typeof e.getDefaultValue?e.getDefaultValue():e!==Boolean&&(e===Date?new Date(0):e===Number?0:null)},a.createInstance=function(e){if("function"==typeof e.createInstance)return e.createInstance();if(e===Boolean)return!1;if(e===Date)return new Date(0);if(e===Number)return 0;if(e===String)return"";else return new e},s=a.IFormattable=a.mkType(a,"ss.IFormattable"),a.initInterface(s,{format:null}),o=a.IComparable=a.mkType(a,"ss.IComparable"),a.initInterface(o,{compareTo:null}),l=a.IEquatable=a.mkType(a,"ss.IEquatable"),a.initInterface(l,{equalsT:null}),a.isNullOrEmptyString=function(e){return!e||!e.length},String.prototype.trim||(String.prototype.trim=function(){return a.trimStartString(a.trimEndString(this))}),a.trimEndString=function(e,t){return e.replace(t?RegExp("["+String.fromCharCode.apply(null,t)+"]+$"):/\s*$/,"")},a.trimStartString=function(e,t){return e.replace(t?RegExp("^["+String.fromCharCode.apply(null,t)+"]+"):/^\s*/,"")},a.trimString=function(e,t){return a.trimStartString(a.trimEndString(e,t),t)},a.arrayClone=function(e){return 1===e.length?[e[0]]:Array.apply(null,e)},Array.prototype.map||(Array.prototype.map=function(e,t){for(var i=this.length,n=Array(i),r=0;r<i;r++)r in this&&(n[r]=e.call(t,this[r],r,this));return n}),Array.prototype.some||(Array.prototype.some=function(e,t){for(var i=this.length,n=0;n<i;n++)if(n in this&&e.call(t,this[n],n,this))return!0;return!1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){if(this==null)throw TypeError(" this is null or not defined");var i,n,r,a=Object(this),s=a.length>>>0;if("function"!=typeof e)throw TypeError(e+" is not a function");for(arguments.length>1&&(i=t),n=0;n<s;)n in a&&(r=a[n],e.call(i,r,n,a)),n++}),Array.prototype.filter||(Array.prototype.filter=function(e){if(void 0===this||this===null)throw TypeError();var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw TypeError();for(var n=[],r=arguments.length>=2?arguments[1]:void 0,a=0;a<i;a++)if(a in t){var s=t[a];e.call(r,s,a,t)&&n.push(s)}return n}),a._delegateContains=function(e,t,i){for(var n=0;n<e.length;n+=2)if(e[n]===t&&e[n+1]===i)return!0;return!1},a._mkdel=function(e){var t=function(){if(2===e.length)return e[1].apply(e[0],arguments);for(var t=a.arrayClone(e),i=0;i<t.length;i+=2)a._delegateContains(e,t[i],t[i+1])&&t[i+1].apply(t[i],arguments);return null};return t._targets=e,t},a.mkdel=function(e,t){return e?("string"==typeof t&&(t=e[t]),a._mkdel([e,t])):t},a.delegateCombine=function(e,t){if(!e)return t._targets?t:a.mkdel(null,t);if(!t)return e._targets?e:a.mkdel(null,e);var i=e._targets?e._targets:[null,e],n=t._targets?t._targets:[null,t];return a._mkdel(i.concat(n))},a.delegateRemove=function(e,t){if(!e||e===t)return null;var i,n=e._targets;if(!t||!n)return e;var r=null;t._targets?(r=t._targets[0],i=t._targets[1]):i=t;for(var s=0;s<n.length;s+=2)if(n[s]===r&&n[s+1]===i){if(2===n.length)return null;var o=a.arrayClone(n);return o.splice(s,2),a._mkdel(o)}return e},a.delegateEquals=function(e,t){if(e===t)return!0;if(!e._targets&&!t._targets)return!1;var i=e._targets||[null,e],n=t._targets||[null,t];if(i.length!==n.length)return!1;for(var r=0;r<i.length;r++)if(i[r]!==n[r])return!1;return!0},u=a.Enum=a.mkType(a,"ss.Enum",{}),a.initClass(u),u.getValues=function e(t){var i=[],n=t.prototype;for(var r in n)n.hasOwnProperty(r)&&i.push(n[r]);return i},c=a.IEnumerator=a.mkType(a,"ss.IEnumerator"),a.initInterface(c,{current:null,moveNext:null,reset:null},[k]),h=a.IEnumerable=a.mkType(a,"ss.IEnumerable"),a.initInterface(h,{getEnumerator:null}),a.getEnumerator=function(e){return e.getEnumerator?e.getEnumerator():new S(e)},m=a.ICollection=a.mkType(a,"ss.ICollection"),a.initInterface(m,{get_count:null,add:null,clear:null,remove:null,contains:null},[h]),a.count=function(e){return e.get_count?e.get_count():e.length},a.add=function(e,t){if(e.add)e.add(t);else if(a.isArray(e))e.push(t);else throw new F},a.clear=function(e){if(e.clear)e.clear();else if(a.isArray(e))e.length=0;else throw new F},a.remove=function(e,t){if(e.remove)return e.remove(t);if(a.isArray(e)){var i=a.indexOf(e,t);return i>=0&&(e.splice(i,1),!0)}throw new F},a.contains=function(e,t){return e.contains?e.contains(t):a.indexOf(e,t)>=0},d=a.IReadOnlyCollection=a.mkType(a,"ss.IReadOnlyCollection"),a.initInterface(d,{get_count:null,contains:null},[h]),p=a.IEqualityComparer=a.mkType(a,"ss.IEqualityComparer"),a.initInterface(p,{areEqual:null,getObjectHashCode:null}),f=a.IComparer=a.mkType(a,"ss.IComparer"),a.initInterface(f,{compare:null}),a.unbox=function(e){if(!a.isValue(e))throw new _("Nullable object must have a value.");return e},g=a.Nullable$1=a.mkType(a,"ss.Nullable$1",function(e){return a.registerGenericClassInstance(g,[e],null,{},{isInstanceOfType:function(t){return a.isInstanceOfType(t,e)}})},null,{eq:function(e,t){return a.isValue(e)?e===t:!a.isValue(t)},ne:function(e,t){return a.isValue(e)?e!==t:a.isValue(t)},le:function(e,t){return a.isValue(e)&&a.isValue(t)&&e<=t},ge:function(e,t){return a.isValue(e)&&a.isValue(t)&&e>=t},lt:function(e,t){return a.isValue(e)&&a.isValue(t)&&e<t},gt:function(e,t){return a.isValue(e)&&a.isValue(t)&&e>t},sub:function(e,t){return a.isValue(e)&&a.isValue(t)?e-t:null},add:function(e,t){return a.isValue(e)&&a.isValue(t)?e+t:null},mod:function(e,t){return a.isValue(e)&&a.isValue(t)?e%t:null},div:function(e,t){return a.isValue(e)&&a.isValue(t)?e/t:null},mul:function(e,t){return a.isValue(e)&&a.isValue(t)?e*t:null},band:function(e,t){return a.isValue(e)&&a.isValue(t)?e&t:null},bor:function(e,t){return a.isValue(e)&&a.isValue(t)?e|t:null},bxor:function(e,t){return a.isValue(e)&&a.isValue(t)?e^t:null},shl:function(e,t){return a.isValue(e)&&a.isValue(t)?e<<t:null},srs:function(e,t){return a.isValue(e)&&a.isValue(t)?e>>t:null},sru:function(e,t){return a.isValue(e)&&a.isValue(t)?e>>>t:null},and:function(e,t){return!0===e&&!0===t||!1!==e&&!1!==t&&null},or:function(e,t){return!0===e||!0===t||(!1!==e||!1!==t)&&null},xor:function(e,t){return a.isValue(e)&&a.isValue(t)?!!(e^t):null},not:function(e){return a.isValue(e)?!e:null},neg:function(e){return a.isValue(e)?-e:null},pos:function(e){return a.isValue(e)?+e:null},cpl:function(e){return a.isValue(e)?~e:null},lift1:function(e,t){return a.isValue(t)?e(t):null},lift2:function(e,t,i){return a.isValue(t)&&a.isValue(i)?e(t,i):null},liftcmp:function(e,t,i){return!!(a.isValue(t)&&a.isValue(i))&&e(t,i)},lifteq:function(e,t,i){var n=a.isValue(t),r=a.isValue(i);return!n&&!r||n&&r&&e(t,i)},liftne:function(e,t,i){var n=a.isValue(t);return n!==a.isValue(i)||n&&e(t,i)}}),a.initGenericClass(g,1),v=a.IList=a.mkType(a,"ss.IList"),a.initInterface(v,{get_item:null,set_item:null,indexOf:null,insert:null,removeAt:null},[m,h]),a.getItem=function(e,t){return e.get_item?e.get_item(t):e[t]},a.setItem=function(e,t,i){e.set_item?e.set_item(t,i):e[t]=i},a.indexOf=function(e,t){if((!t||"function"!=typeof t.equals)&&"function"==typeof e.indexOf||!a.isArrayOrTypedArray(e))return e.indexOf(t);for(var i=0;i<e.length;i++)if(a.staticEquals(e[i],t))return i;return -1},a.insert=function(e,t,i){if(e.insert)e.insert(t,i);else if(a.isArray(e))e.splice(t,0,i);else throw new F},a.removeAt=function(e,t){if(e.removeAt)e.removeAt(t);else if(a.isArray(e))e.splice(t,1);else throw new F},y=a.IReadOnlyList=a.mkType(a,"ss.IReadOnlyList"),a.initInterface(y,{get_item:null},[d,h]),w=function(e,t,i){var n=a[e]=a.mkType(a,"ss."+e,function(){},null,{isInstanceOfType:function(e){return"number"==typeof e&&Math.round(e,0)===e&&e>=t&&e<=i},createInstance:function(){return 0}});return a.initStruct(n,[l,o,s]),n},w("Byte",0,255),w("SByte",-128,127),w("Int16",-32768,32767),w("UInt16",0,65535),w("Int32",-2147483648,2147483647),w("UInt32",0,4294967295),w("Int64",0x8000000000000000,0x7fffffffffffffff),w("UInt64",0,18446744073709552e3),w("Char",0,65535),a.sxb=function(e){return e|(128&e?4294967040:0)},a.sxs=function(e){return e|(32768&e?4294901760:0)},a.clip8=function(e){return a.isValue(e)?a.sxb(255&e):null},a.clipu8=function(e){return a.isValue(e)?255&e:null},a.clip16=function(e){return a.isValue(e)?a.sxs(65535&e):null},a.clipu16=function(e){return a.isValue(e)?65535&e:null},a.clip32=function(e){return a.isValue(e)?0|e:null},a.clipu32=function(e){return a.isValue(e)?e>>>0:null},a.clip64=function(e){return a.isValue(e)?(0|Math.floor(e/4294967296))*4294967296+(e>>>0):null},a.clipu64=function(e){return a.isValue(e)?(Math.floor(e/4294967296)>>>0)*4294967296+(e>>>0):null},a.ck=function(e,t){if(a.isValue(e)&&!t.isInstanceOfType(e))throw new U;return e},a.trunc=function(e){return a.isValue(e)?e>0?Math.floor(e):Math.ceil(e):null},a.idiv=function(e,t){if(!a.isValue(e)||!a.isValue(t))return null;if(!t)throw new $;return a.trunc(e/t)},a.imod=function(e,t){if(!a.isValue(e)||!a.isValue(t))return null;if(!t)throw new $;return e%t},b=a.JsDate=a.mkType(a,"ss.JsDate",function(){},null,{createInstance:function(){return new Date},isInstanceOfType:function(e){return e instanceof Date}}),a.initClass(b,null,[l,o]),S=a.ArrayEnumerator=a.mkType(a,"ss.ArrayEnumerator",function(e){this._array=e,this._index=-1},{moveNext:function(){return this._index++,this._index<this._array.length},reset:function(){this._index=-1},current:function(){if(this._index<0||this._index>=this._array.length)throw"Invalid operation";return this._array[this._index]},dispose:function(){}}),a.initClass(S,null,[c,k]),C=a.ObjectEnumerator=a.mkType(a,"ss.ObjectEnumerator",function(e){this._keys=Object.keys(e),this._index=-1,this._object=e},{moveNext:function(){return this._index++,this._index<this._keys.length},reset:function(){this._index=-1},current:function(){if(this._index<0||this._index>=this._keys.length)throw new _("Invalid operation");var e=this._keys[this._index];return{key:e,value:this._object[e]}},dispose:function(){}}),a.initClass(C,null,[c,k]),I=a.EqualityComparer=a.mkType(a,"ss.EqualityComparer",function(){},{areEqual:function(e,t){return a.staticEquals(e,t)},getObjectHashCode:function(e){return a.isValue(e)?a.getHashCode(e):0}}),a.initClass(I,null,[p]),I.def=new I,T=a.Comparer=a.mkType(a,"ss.Comparer",function(e){this.f=e},{compare:function(e,t){return this.f(e,t)}}),a.initClass(T,null,[f]),T.def=new T(function(e,t){return a.isValue(e)?a.isValue(t)?a.compare(e,t):1:a.isValue(t)?-1:0}),k=a.IDisposable=a.mkType(a,"ss.IDisposable"),a.initInterface(k,{dispose:null}),A=a.StringBuilder=a.mkType(a,"ss.StringBuilder",function(e){this._parts=a.isValue(e)&&""!==e?[e]:[],this.length=a.isValue(e)?e.length:0},{append:function(e){if(a.isValue(e)){var t=e.toString();a.add(this._parts,t),this.length+=t.length}return this},appendChar:function(e){return this.append(String.fromCharCode(e))},appendLine:function(e){return this.append(e),this.append("\r\n"),this},appendLineChar:function(e){return this.appendLine(String.fromCharCode(e))},clear:function(){this._parts=[],this.length=0},toString:function(){return this._parts.join("")}}),a.initClass(A),E=a.EventArgs=a.mkType(a,"ss.EventArgs",function(){}),a.initClass(E),E.Empty=new E,V=a.Exception=a.mkType(a,"ss.Exception",function(e,t){this._message=e||"An error occurred.",this._innerException=t||null,this._error=Error()},{get_message:function(){return this._message},get_innerException:function(){return this._innerException},get_stack:function(){return this._error.stack},toString:function(){var e=this._message;return a.isNullOrEmptyString(e)&&(e=a.isValue(a.getInstanceType(this))&&a.isValue(a.getTypeFullName(a.getInstanceType(this)))?a.getTypeFullName(a.getInstanceType(this)):"[object Exception]"),e}},{wrap:function(e){return a.isInstanceOfType(e,V)?e:e instanceof TypeError?new H(e.message,new O(e)):e instanceof RangeError?new P(null,e.message,new O(e)):e instanceof Error?new O(e):new V(e.toString())}}),a.initClass(V),N=a.NotImplementedException=a.mkType(a,"ss.NotImplementedException",function(e,t){V.call(this,e||"The method or operation is not implemented.",t)}),a.initClass(N,V),F=a.NotSupportedException=a.mkType(a,"ss.NotSupportedException",function(e,t){V.call(this,e||"Specified method is not supported.",t)}),a.initClass(F,V),O=a.JsErrorException=a.mkType(a,"ss.JsErrorException",function(e,t,i){V.call(this,t||e.message,i),this.error=e},{get_stack:function(){return this.error.stack}}),a.initClass(O,V),D=a.ArgumentException=a.mkType(a,"ss.ArgumentException",function(e,t,i){V.call(this,e||"Value does not fall within the expected range.",i),this.paramName=t||null}),a.initClass(D,V),R=a.ArgumentNullException=a.mkType(a,"ss.ArgumentNullException",function(e,t,i){!t&&(t="Value cannot be null.",e&&(t+="\nParameter name: "+e)),D.call(this,t,e,i)}),a.initClass(R,D),P=a.ArgumentOutOfRangeException=a.mkType(a,"ss.ArgumentOutOfRangeException",function(e,t,i,n){!t&&(t="Value is out of range.",e&&(t+="\nParameter name: "+e)),D.call(this,t,e,i),this.actualValue=n||null}),a.initClass(P,D),z=a.FormatException=a.mkType(a,"ss.FormatException",function(e,t){V.call(this,e||"Invalid format.",t)}),a.initClass(z,V),x=a.ArithmeticException=a.mkType(a,"ss.ArithmeticException",function(e,t){V.call(this,e||"Overflow or underflow in the arithmetic operation.",t)}),a.initClass(x,V),U=a.OverflowException=a.mkType(a,"ss.OverflowException",function(e,t){x.call(this,e||"Arithmetic operation resulted in an overflow.",t)}),a.initClass(U,x),$=a.DivideByZeroException=a.mkType(a,"ss.DivideByZeroException",function(e,t){x.call(this,e||"Division by 0.",t)}),a.initClass($,x),M=a.InvalidCastException=a.mkType(a,"ss.InvalidCastException",function(e,t){V.call(this,e||"The cast is not valid.",t)}),a.initClass(M,V),_=a.InvalidOperationException=a.mkType(a,"ss.InvalidOperationException",function(e,t){V.call(this,e||"Operation is not valid due to the current state of the object.",t)}),a.initClass(_,V),H=a.NullReferenceException=a.mkType(a,"ss.NullReferenceException",function(e,t){V.call(this,e||"Object is null.",t)}),a.initClass(H,V),L=a.KeyNotFoundException=a.mkType(a,"ss.KeyNotFoundException",function(e,t){V.call(this,e||"Key not found.",t)}),a.initClass(L,V),W=a.AmbiguousMatchException=a.mkType(a,"ss.AmbiguousMatchException",function(e,t){V.call(this,e||"Ambiguous match.",t)}),a.initClass(W,V),e.ss=a;var G,B,q,Q,K,Y,J,X,Z,ee,et,ei,en=j.ss;G={},j.tab=j.tab||{},en.initAssembly(G,"tabcoreslim"),B=j.tab.BaseLogAppender=en.mkType(G,"tab.BaseLogAppender",function(){this.$filters=null,this.$filters=[]},{clearFilters:function e(){en.clear(this.$filters)},addFilter:function e(t){this.$filters.push(t)},removeFilter:function e(t){en.remove(this.$filters,t)},log:function e(t,i,n,r){for(var a=0;a<this.$filters.length;a++)if((0,this.$filters[a])(t,i)){this.logInternal(t,i,n,r);return}},logInternal:null,formatMessage:function e(t,i){if(en.isNullOrUndefined(i)||0===i.length)return t;for(var n=new en.StringBuilder,r=0,a=!1,s=0;s<t.length;s++){var o=t.charCodeAt(s);if(37===o)a?(n.append("%"),a=!1):a=!0;else{if(a)switch(o){case 98:case 115:case 100:case 110:case 111:n.append(i.length>r?i[r]:""),r++}else n.appendChar(o);a=!1}}return n.toString()}}),q=j.tab.ConsoleLogAppender=en.mkType(G,"tab.ConsoleLogAppender",function(){this.$levelMethods=null,B.call(this)},{logInternal:function e(t,i,n,r){if("object"==typeof window.console){n=t.get_name()+": "+n;var a=[],s=a.concat(n);a=s.concat.apply(s,r);try{Function.prototype.apply.call(this.$getConsoleMethod(i),window.console,a)}catch(o){}}},$getConsoleMethod:function e(t){var i=window.self.console;en.isNullOrUndefined(this.$levelMethods)&&(this.$levelMethods={},this.$levelMethods[1..toString()]=i.log,this.$levelMethods[4..toString()]=i.error,this.$levelMethods[2..toString()]=i.info,this.$levelMethods[3..toString()]=i.warn);var n=this.$levelMethods[t.toString()];return en.isNullOrUndefined(n)&&(n=i.log),n}}),Q=j.tab.CookieHelper=en.mkType(G,"tab.CookieHelper",null,null,{getValueForCookie:function e(t){var i=K.getCookie().match(RegExp("(?:^|;) ?"+t+"=([^;]*)(?:;|$)"));return en.isNullOrUndefined(i)||i.length<2?null:i[1]},setCookie:function e(t,i,n,r){var a=t+"="+i+";path="+n+";";en.staticEquals(r,null)||(a+="expires="+r.toUTCString()),K.setCookie(a)},deleteCookie:function e(t,i){var n=new Date(0);K.setCookie(t+"=;path="+i+";expires="+n.toUTCString())}}),K=j.tab.DocumentHelper=en.mkType(G,"tab.DocumentHelper",null,null,{get_documentClientWidth:function e(){return document.documentElement.clientWidth},get_documentClientHeight:function e(){return document.documentElement.clientHeight},getCookie:function e(){return document.cookie},setCookie:function e(t){document.cookie=t}}),Y=j.tab.EscapingUtil=en.mkType(G,"tab.EscapingUtil",null,null,{escapeHtml:function e(t){var i=en.coalesce(t,"");return i=(i=(i=(i=(i=(i=i.replace(RegExp("&","g"),"&amp;")).replace(RegExp("<","g"),"&lt;")).replace(RegExp(">","g"),"&gt;")).replace(RegExp('"',"g"),"&quot;")).replace(RegExp("'","g"),"&#39;")).replace(RegExp("/","g"),"&#47;"),RegExp("^ +$").test(i)&&(i=i.replace(RegExp(" ","g"),"&nbsp;")),i}}),J=j.tab.Log=en.mkType(G,"tab.Log",function(){},null,{get:function e(t){return Z.lazyGetLogger(en.getInstanceType(t))},get$1:function e(t){return Z.lazyGetLogger(t)}}),X=j.tab.LogAppenderInstance=en.mkType(G,"tab.LogAppenderInstance",function(e){this.$appenderFactoryFunc=null,this.$1$InstanceField=null,this.$appenderFactoryFunc=e},{get_instance:function e(){return this.$1$InstanceField},set_instance:function e(t){this.$1$InstanceField=t},enableLogging:function e(t){en.isNullOrUndefined(this.get_instance())?(this.set_instance(this.$appenderFactoryFunc()),Z.addAppender(this.get_instance())):Z.hasAppender(this.get_instance())||Z.addAppender(this.get_instance()),this.get_instance().addFilter(en.coalesce(t,function(e,t){return!0}))},disableLogging:function e(){!en.isNullOrUndefined(this.get_instance())&&(Z.removeAppender(this.get_instance()),this.set_instance(null))}}),Z=j.tab.Logger=en.mkType(G,"tab.Logger",function(e){this.$name=null,this.$name=e},{get_name:function e(){return this.$name},debug:function e(t,i){this.$logInternal(1,t,i)},info:function e(t,i){this.$logInternal(2,t,i)},warn:function e(t,i){this.$logInternal(3,t,i)},error:function e(t,i){this.$logInternal(4,t,i)},log:function e(t,i,n){this.$logInternal(t,i,n)},$logInternal:function e(t,i,n){try{for(var r=0;r<Z.$appenders.length;r++)Z.$appenders[r].log(this,t,i,n)}catch(a){}}},{get_globalLog:function e(){return Z.global},clearFilters:function e(){for(var t=0;t<Z.$appenders.length;t++)Z.$appenders[t].clearFilters();Z.$filters.splice(0,Z.$filters.length)},filterByLogger:function e(t,i){i=i||0,Z.$addFilter(function(e,n){return en.referenceEquals(e,t)&&n>=i})},filterByType:function e(t,i){i=i||0,Z.$addFilter(function(e,n){return n>=i&&en.referenceEquals(e.get_name(),en.getTypeName(t))})},filterByName:function e(t,i){i=i||0;var n=RegExp(t,"i");Z.$addFilter(function(e,t){return t>=i&&en.isValue(e.get_name().match(n))})},clearAppenders:function e(){Z.$appenders.splice(0,Z.$filters.length)},hasAppender:function e(t){return Z.$appenders.indexOf(t)>-1},addAppender:function e(t){for(var i=0;i<Z.$filters.length;i++){var n=Z.$filters[i];t.addFilter(n)}Z.$appenders.push(t)},removeAppender:function e(t){var i=Z.$appenders.indexOf(t);i>-1&&Z.$appenders.splice(i,1)},lazyGetLogger:function e(t){var i="_logger",n=t[i];return en.isNullOrUndefined(n)&&(n=Z.getLogger(t,null),t[i]=n),n},getLogger:function e(t,i){var n=Z.getLoggerWithName(en.getTypeName(t));return en.isValue(i)&&Z.filterByLogger(n,en.unbox(i)),n},getLoggerWithName:function e(t){return new Z(t)},$setupUrlFilters:function e(){var t=et.getUriQueryParameters(window.self.location.search);if(en.keyExists(t,Z.$logQueryParam)){Z.clearFilters();var i=t[Z.$logQueryParam];0===i.length&&Z.filterByName(".*",0);for(var n=0;n<i.length;n++){var r=i[n].split(":"),a=1;if(r.length>0&&en.isValue(r[1])){var s=r[1].toLowerCase(),o=Z.loggerLevelNames.indexOf(s);o>=0&&(a=o)}Z.filterByName(r[0],a)}}},$addFilter:function e(t){Z.$filters.push(t);for(var i=0;i<Z.$appenders.length;i++)Z.$appenders[i].addFilter(t)}}),j.tab.LoggerLevel=en.mkEnum(G,"tab.LoggerLevel",{all:0,debug:1,info:2,warn:3,error:4,off:5}),ee=j.tab.ScriptEx=en.mkType(G,"tab.ScriptEx"),et=j.tab.UriExtensions=en.mkType(G,"tab.UriExtensions",null,null,{getUriQueryParameters:function e(t){var i={};if(en.isNullOrUndefined(t))return i;var n=t.indexOf("?");if(n<0)return i;var r=t.substr(n+1),a=r.indexOf("#");if(a>=0&&(r=r.substr(0,a)),en.isNullOrEmptyString(r))return i;for(var s=r.split("&"),o=0;o<s.length;o++){var l,u=s[o].split("="),c=decodeURIComponent(u[0]);en.keyExists(i,c)?l=i[c]:(l=[],i[c]=l),u.length>1&&l.push(decodeURIComponent(u[1]))}return i}}),ei=j.tab.WindowHelper=en.mkType(G,"tab.WindowHelper",function(e){this.$window=null,this.$window=e},{get_pageXOffset:function e(){return ei.$pageXOffsetFunc(this.$window)},get_pageYOffset:function e(){return ei.$pageYOffsetFunc(this.$window)},get_clientWidth:function e(){return ei.$clientWidthFunc(this.$window)},get_clientHeight:function e(){return ei.$clientHeightFunc(this.$window)},get_innerWidth:function e(){return ei.$innerWidthFunc(this.$window)},get_outerWidth:function e(){return ei.$outerWidthFunc(this.$window)},get_innerHeight:function e(){return ei.$innerHeightFunc(this.$window)},get_outerHeight:function e(){return ei.$outerHeightFunc(this.$window)},get_screenLeft:function e(){return ei.$screenLeftFunc(this.$window)},get_screenTop:function e(){return ei.$screenTopFunc(this.$window)},isQuirksMode:function e(){return"BackCompat"===document.compatMode}},{get_windowSelf:function e(){return window.self},get_windowParent:function e(){return window.parent},get_selection:function e(){return"function"==typeof window.getSelection?window.getSelection():"function"==typeof document.getSelection?document.getSelection():null},close:function e(t){t.close()},getOpener:function e(t){return t.opener},getLocation:function e(t){return t.location},getPathAndSearch:function e(t){return t.location.pathname+t.location.search},setLocationHref:function e(t,i){t.location.href=i},locationReplace:function e(t,i){t.location.replace(i)},open:function e(t,i,n){return window.open(t,i,n)},reload:function e(t,i){t.location.reload(i)},requestAnimationFrame:function e(t){return ei.$requestAnimationFrameFunc(t)},cancelAnimationFrame:function e(t){en.isValue(t)&&ei.$cancelAnimationFrameFunc(t)},setTimeout:function e(t,i){return window.setTimeout(t,i)},setInterval:function e(t,i){return window.setInterval(t,i)},addListener:function e(t,i,n){"addEventListener"in t?t.addEventListener(i,n,!1):t.attachEvent("on"+i,n)},removeListener:function e(t,i,n){"removeEventListener"in t?t.removeEventListener(i,n,!1):t.detachEvent("on"+i,n)},$setDefaultRequestAnimationFrameImpl:function e(){var t=0;ei.$requestAnimationFrameFunc=function(e){var i=new Date().getTime(),n=Math.max(0,16-(i-t));return t=i+n,window.setTimeout(e,n)}},clearSelection:function e(){var t=ei.get_selection();en.isValue(t)&&("function"==typeof t.removeAllRanges?t.removeAllRanges():"function"==typeof t.empty&&t.empty())}}),en.initClass(B),en.initClass(q,B),en.initClass(Q),en.initClass(K),en.initClass(Y),en.initClass(J),en.initClass(X),en.initClass(Z),en.initClass(ee),en.initClass(et),en.initClass(ei),Z.global=Z.getLoggerWithName("global"),Z.loggerLevelNames=[],Z.$logQueryParam=":log",Z.$appenders=[],Z.$filters=[],Z.$nullLog=new Z(""),Z.$setupUrlFilters(),Z.loggerLevelNames[0]="all",Z.loggerLevelNames[1]="debug",Z.loggerLevelNames[2]="info",Z.loggerLevelNames[3]="warn",Z.loggerLevelNames[4]="error",Z.loggerLevelNames[5]="off",q.globalAppender=new X(function(){return new q}),q.globalAppender.enableLogging(function(e,t){return t>=2}),function(){ei.blank="_blank",ei.$innerWidthFunc=null,ei.$innerHeightFunc=null,ei.$clientWidthFunc=null,ei.$clientHeightFunc=null,ei.$pageXOffsetFunc=null,ei.$pageYOffsetFunc=null,ei.$screenLeftFunc=null,ei.$screenTopFunc=null,ei.$outerWidthFunc=null,ei.$outerHeightFunc=null,ei.$requestAnimationFrameFunc=null,ei.$cancelAnimationFrameFunc=null,"innerWidth"in window?ei.$innerWidthFunc=function(e){return e.innerWidth}:ei.$innerWidthFunc=function(e){return e.document.documentElement.offsetWidth},"outerWidth"in window?ei.$outerWidthFunc=function(e){return e.outerWidth}:ei.$outerWidthFunc=ei.$innerWidthFunc,"innerHeight"in window?ei.$innerHeightFunc=function(e){return e.innerHeight}:ei.$innerHeightFunc=function(e){return e.document.documentElement.offsetHeight},"outerHeight"in window?ei.$outerHeightFunc=function(e){return e.outerHeight}:ei.$outerHeightFunc=ei.$innerHeightFunc,"clientWidth"in window?ei.$clientWidthFunc=function(e){return e.clientWidth}:ei.$clientWidthFunc=function(e){return e.document.documentElement.clientWidth},"clientHeight"in window?ei.$clientHeightFunc=function(e){return e.clientHeight}:ei.$clientHeightFunc=function(e){return e.document.documentElement.clientHeight},en.isValue(window.self.pageXOffset)?ei.$pageXOffsetFunc=function(e){return e.pageXOffset}:ei.$pageXOffsetFunc=function(e){return e.document.documentElement.scrollLeft},en.isValue(window.self.pageYOffset)?ei.$pageYOffsetFunc=function(e){return e.pageYOffset}:ei.$pageYOffsetFunc=function(e){return e.document.documentElement.scrollTop},"screenLeft"in window?ei.$screenLeftFunc=function(e){return en.unbox(en.cast(e.screenLeft,en.Int32))}:ei.$screenLeftFunc=function(e){return e.screenX},"screenTop"in window?ei.$screenTopFunc=function(e){return en.unbox(en.cast(e.screenTop,en.Int32))}:ei.$screenTopFunc=function(e){return e.screenY};var e="requestAnimationFrame",t="cancelAnimationFrame",i=["ms","moz","webkit","o"],n=null,r=null;e in window&&(n=e),t in window&&(r=t);for(var a=0;a<i.length&&(en.isNullOrUndefined(n)||en.isNullOrUndefined(r));++a){var s=i[a],o=s+"RequestAnimationFrame";en.isNullOrUndefined(n)&&o in window&&(n=o),en.isNullOrUndefined(r)&&((o=s+"CancelAnimationFrame")in window&&(r=o),(o=s+"CancelRequestAnimationFrame")in window&&(r=o))}en.isValue(n)?ei.$requestAnimationFrameFunc=function(e){return window[n](e)}:ei.$setDefaultRequestAnimationFrameImpl(),en.isValue(r)?ei.$cancelAnimationFrameFunc=function(e){window[r](e)}:ei.$cancelAnimationFrameFunc=window.clearTimeout}();var er,ea,es,eo,el,eu,ec,eh,em,ed,ep,ef,eg,e9,ev,ey,e8,ew,eb,eS,eC,eI,eT,ek,eA,eE,eV,eN,eF,eO,eD,eR,eP,ez,ex,eU,e$,eM,e_,eH,eL,eW,ej,eG,eB,eq,eQ,eK,e0,eY,eJ,e1,eX,e2,e4,eZ,e5,e6,e3,e7,te,tt,ti,tn,tr,ta,ts,to,tl,tu,tc,th,tm,td,tp,tf,tg,t9,tv,ty,t8,tw,tb,tS,tC,tI,tT,tk,tA,tE,tV,tN,tF,tO,tD,tR,tP,tz,tx,tU,t$,tM,t_,tH,tL,tW,tj,tG,tB,tq,tQ=j.tab;j.tableauSoftware=j.tableauSoftware||{},er={},j.tab=j.tab||{},j.tableauSoftware=j.tableauSoftware||{},en.initAssembly(er,"vqlapishared"),ea=j.tab._ApiCommand=en.mkType(er,"tab._ApiCommand",function(e,t,i,n){this.$1$NameField=null,this.$1$HostIdField=null,this.$1$CommandIdField=null,this.$1$ParametersField=null,this.set_name(e),this.set_commandId(t),this.set_hostId(i),this.set_parameters(n)},{get_name:function e(){return this.$1$NameField},set_name:function e(t){this.$1$NameField=t},get_hostId:function e(){return this.$1$HostIdField},set_hostId:function e(t){this.$1$HostIdField=t},get_commandId:function e(){return this.$1$CommandIdField},set_commandId:function e(t){this.$1$CommandIdField=t},get_parameters:function e(){return this.$1$ParametersField},set_parameters:function e(t){this.$1$ParametersField=t},get_isApiCommandName:function e(){return 0===this.get_rawName().indexOf("api.",0)},get_rawName:function e(){return this.get_name().toString()},serialize:function e(){var t=[];t.push(this.get_name()),t.push(this.get_commandId()),t.push(this.get_hostId()),en.isValue(this.get_parameters())&&t.push(this.get_parameters());var i=t.join(",");return ea.lastRequestMessage=i,i}},{generateNextCommandId:function e(){var t="cmd"+ea.$nextCommandId;return ea.$nextCommandId++,t},parse:function e(t){var i,n,r,a=t.indexOf(",");if(a<0)return i=en.cast(t,String),new ea(i,null,null,null);i=en.cast(t.substr(0,a),String);var s=t.substr(a+1);if((a=s.indexOf(","))<0)return n=s,new ea(i,n,null,null);n=s.substr(0,a);var o=s.substr(a+1);if((a=o.indexOf(","))<0)return r=o,new ea(i,n,r,null);r=o.substr(0,a);var l=o.substr(a+1);return ea.lastResponseMessage=t,"api.GetClientInfoCommand"===i&&(ea.lastClientInfoResponseMessage=t),new ea(i,n,r,l)}}),es=j.tab._ApiObjectRegistry=en.mkType(er,"tab._ApiObjectRegistry",null,null,{registerApiMessageRouter:function e(t){return es.$registerType(Object).call(null,t)},getApiMessageRouter:function e(){return es.$getSingleton(Object).call(null)},disposeApiMessageRouter:function e(){es.$clearSingletonInstance(Object).call(null)},$registerType:function(e){return function t(i){var n=window._ApiObjectRegistryGlobalState.creationRegistry,r=en.getTypeFullName(e),a=n[r];return n[r]=i,a}},$createType:function(e){return function t(){var i=en.getTypeFullName(e),n=window._ApiObjectRegistryGlobalState.creationRegistry[i];if(en.isNullOrUndefined(n))throw e9.createInternalError("No creation function has been registered for interface type '"+i+"'.");return n()}},$getSingleton:function(e){return function t(){var i=window._ApiObjectRegistryGlobalState.singletonInstanceRegistry,n=en.getTypeFullName(e),r=en.cast(i[n],e);return en.isNullOrUndefined(r)&&(r=es.$createType(e).call(null),i[n]=r),r}},$clearSingletonInstance:function(e){return function t(){var i=window._ApiObjectRegistryGlobalState.singletonInstanceRegistry,n=en.getTypeFullName(e),r=en.cast(i[n],e);return delete i[n],r}}}),eo=j.tab._ApiServerNotification=en.mkType(er,"tab._ApiServerNotification",function(e,t,i){this.$workbookName=null,this.$worksheetName=null,this.$data=null,this.$workbookName=e,this.$worksheetName=t,this.$data=i},{get_workbookName:function e(){return this.$workbookName},get_worksheetName:function e(){return this.$worksheetName},get_data:function e(){return this.$data},serialize:function e(){var t={};return t["api.workbookName"]=this.$workbookName,t["api.worksheetName"]=this.$worksheetName,t["api.commandData"]=this.$data,JSON.stringify(t)}},{deserialize:function e(t){var i=JSON.parse(t),n=en.cast(i["api.workbookName"],String),r=en.cast(i["api.worksheetName"],String),a=i["api.commandData"];return new eo(n,r,a)}}),el=j.tab._ApiServerResultParser=en.mkType(er,"tab._ApiServerResultParser",function(e){this.$commandResult=null,this.$commandData=null;var t=JSON.parse(e);this.$commandResult=en.cast(t["api.commandResult"],String),this.$commandData=t["api.commandData"]},{get_result:function e(){return this.$commandResult},get_data:function e(){return this.$commandData}}),eu=j.tab._CollectionImpl=en.mkType(er,"tab._CollectionImpl",function(){this.$items=[],this.$itemMap={}},{get__length:function e(){return this.$items.length},get__rawArray:function e(){return this.$items},get_item:function e(t){return this.$items[t]},_get:function e(t){var i=this.$ensureValidKey(t);if(en.isValue(this.$itemMap[i]))return this.$itemMap[i]},_has:function e(t){return en.isValue(this._get(t))},_add:function e(t,i){this.$verifyKeyAndItemParameters(t,i);var n=this.$ensureValidKey(t);this.$items.push(i),this.$itemMap[n]=i},_addToFirst:function e(t,i){this.$verifyKeyAndItemParameters(t,i);var n=this.$ensureValidKey(t);this.$items.unshift(i),this.$itemMap[n]=i},_remove:function e(t){var i=this.$ensureValidKey(t);if(en.isValue(this.$itemMap[i])){var n=this.$itemMap[i];delete this.$itemMap[i];for(var r=0;r<this.$items.length;r++)if(en.referenceEquals(this.$items[r],n)){this.$items.splice(r,1);break}}},_toApiCollection:function e(){var t=this.$items.concat();return t.get=en.mkdel(this,function(e){return this._get(e)}),t.has=en.mkdel(this,function(e){return this._has(e)}),t},$verifyUniqueKeyParameter:function e(t){if(ev.isNullOrEmpty(t))throw new en.Exception("Null key");if(this._has(t))throw new en.Exception("Duplicate key '"+t+"'")},$verifyKeyAndItemParameters:function e(t,i){if(this.$verifyUniqueKeyParameter(t),en.isNullOrUndefined(i))throw new en.Exception("Null item")},$ensureValidKey:function e(t){return"_"+t}}),ec=j.tab._ColumnImpl=en.mkType(er,"tab._ColumnImpl",function(e,t,i,n){this.$fieldName=null,this.$dataType=null,this.$isReferenced=!1,this.$index=0,ep.verifyString(e,"Column Field Name"),this.$fieldName=e,this.$dataType=t,this.$isReferenced=en.coalesce(i,!1),this.$index=n},{get_fieldName:function e(){return this.$fieldName},get_dataType:function e(){return this.$dataType},get_isReferenced:function e(){return this.$isReferenced},get_index:function e(){return this.$index}}),eh=j.tab._DataTableImpl=en.mkType(er,"tab._DataTableImpl",function(e,t,i,n){this.$name=null,this.$rows=null,this.$totalRowCount=0,this.$columns=null,this.$isSummaryData=!1,this.$rows=e,this.$totalRowCount=i,this.$columns=n,this.$isSummaryData=t,this.$name=t?"Summary Data Table":"Underlying Data Table"},{get_name:function e(){return this.$name},get_rows:function e(){return this.$rows},get_columns:function e(){return this.$columns},get_totalRowCount:function e(){return this.$totalRowCount},get_isSummaryData:function e(){return this.$isSummaryData}}),em=j.tab._DeferredImpl=en.mkType(er,"tab._DeferredImpl",function(){this.$promise=null,this.$thenFunc=null,this.$listeners=[],this.$resolveFunc=null,this.$promise=new ef(en.mkdel(this,this.then)),this.$thenFunc=en.mkdel(this,this.$preResolutionThen),this.$resolveFunc=en.mkdel(this,this.$transitionToFulfilled)},{get_promise:function e(){return this.$promise},all:function e(t){var i=new em,n=t.length,r=n,a=[];if(0===n)return i.resolve(a),i.get_promise();for(var s=function(e,t){ey.$coerceToTrustedPromise(e).then(function(e){return a[t]=e,0==--r&&i.resolve(a),null},function(e){return i.reject(e),null})},o=0;o<n;o++)s(t[o],o);return i.get_promise()},then:function e(t,i){return this.$thenFunc(t,i)},resolve:function e(t){return this.$resolveFunc(t)},reject:function e(t){return this.$resolveFunc(ey.$rejected(t))},$preResolutionThen:function e(t,i){var n=new em;return this.$listeners.push(function(e){e.then(t,i).then(en.mkdel(n,n.resolve),en.mkdel(n,n.reject))}),n.get_promise()},$transitionToFulfilled:function e(t){var i=ey.$coerceToTrustedPromise(t);this.$thenFunc=i.then,this.$resolveFunc=ey.$coerceToTrustedPromise;for(var n=0;n<this.$listeners.length;n++)(0,this.$listeners[n])(i);return this.$listeners=null,i}}),ed=j.tab._jQueryShim=en.mkType(er,"tab._jQueryShim",null,null,{isFunction:function e(t){return en.referenceEquals(ed.type(t),ed.$functionType)},isArray:function e(t){return en.isValue(Array.isArray)?en.unbox(en.cast(Array.isArray(t),Boolean)):en.referenceEquals(ed.type(t),ed.$arrayType)},type:function e(t){return en.isNullOrUndefined(t)?String(t):ed.$class2type[en.cast(ed.$toString.call(t),String)]||ed.$objectType},trim:function e(t){return en.isValue(ed.$trim)?en.isNullOrUndefined(t)?"":en.cast(ed.$trim.call(t),String):en.isNullOrUndefined(t)?"":t.toString().replace(ed.$trimLeft,"").replace(ed.$trimRight,"")},parseJSON:function e(t){if("string"!=typeof t||en.isNullOrUndefined(t))return null;if(t=ed.trim(t),en.isValue(JSON)&&en.isValue(JSON.parse))return JSON.parse(t);if(ed.$rvalidchars.test(t.replace(ed.$rvalidescape,"@").replace(ed.$rvalidtokens,"]").replace(ed.$rvalidbraces,"")))return Function("return "+t)();throw new en.Exception("Invalid JSON: "+t)}}),ep=j.tab._Param=en.mkType(er,"tab._Param",null,null,{verifyString:function e(t,i){if(en.isNullOrUndefined(t)||0===t.length)throw e9.createInternalStringArgumentException(i)},verifyValue:function e(t,i){if(en.isNullOrUndefined(t))throw e9.createInternalNullArgumentException(i)}}),ef=j.tab._PromiseImpl=en.mkType(er,"tab._PromiseImpl",function(e){this.then=null,this.then=e},{always:function e(t){return en.cast(this.then(t,en.cast(t,Function)),ef)},otherwise:function e(t){return en.cast(this.then(null,t),ef)}}),eg=j.tab._Rect=en.mkType(er,"tab._Rect",function(e,t,i,n){this.left=0,this.top=0,this.width=0,this.height=0,this.left=e,this.top=t,this.width=i,this.height=n},{intersect:function e(t){var i=Math.max(this.left,t.left),n=Math.max(this.top,t.top),r=Math.min(this.left+this.width,t.left+t.width),a=Math.min(this.top+this.height,t.top+t.height);return r<=i||a<=n?new eg(0,0,0,0):new eg(i,n,r-i,a-n)}}),e9=j.tab._TableauException=en.mkType(er,"tab._TableauException",null,null,{create:function e(t,i){var n=new en.Exception(i);return n.tableauSoftwareErrorCode=t,n},createInternalError:function e(t){return en.isValue(t)?e9.create("internalError","Internal error. Please contact Tableau support with the following information: "+t):e9.create("internalError","Internal error. Please contact Tableau support")},createInternalNullArgumentException:function e(t){return e9.createInternalError("Null/undefined argument '"+t+"'.")},createInternalStringArgumentException:function e(t){return e9.createInternalError("Invalid string argument '"+t+"'.")},createServerError:function e(t){return e9.create("serverError",t)},createNotActiveSheet:function e(){return e9.create("notActiveSheet","Operation not allowed on non-active sheet")},createInvalidCustomViewName:function e(t){return e9.create("invalidCustomViewName","Invalid custom view name: "+t)},createInvalidParameter:function e(t){return e9.create("invalidParameter","Invalid parameter: "+t)},createInvalidFilterFieldNameOrValue:function e(t){return e9.create("invalidFilterFieldNameOrValue","Invalid filter field name or value: "+t)},createInvalidDateParameter:function e(t){return e9.create("invalidDateParameter","Invalid date parameter: "+t)},createNullOrEmptyParameter:function e(t){return e9.create("nullOrEmptyParameter","Parameter cannot be null or empty: "+t)},createMissingMaxSize:function e(){return e9.create("missingMaxSize","Missing maxSize for SheetSizeBehavior.ATMOST")},createMissingMinSize:function e(){return e9.create("missingMinSize","Missing minSize for SheetSizeBehavior.ATLEAST")},createMissingMinMaxSize:function e(){return e9.create("missingMinMaxSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},createInvalidRangeSize:function e(){return e9.create("invalidSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},createInvalidSizeValue:function e(){return e9.create("invalidSize","Size value cannot be less than zero")},createInvalidSheetSizeParam:function e(){return e9.create("invalidSize","Invalid sheet size parameter")},createSizeConflictForExactly:function e(){return e9.create("invalidSize","Conflicting size values for SheetSizeBehavior.EXACTLY")},createInvalidSizeBehaviorOnWorksheet:function e(){return e9.create("invalidSizeBehaviorOnWorksheet","Only SheetSizeBehavior.AUTOMATIC is allowed on Worksheets")},createNoUrlForHiddenWorksheet:function e(){return e9.create("noUrlForHiddenWorksheet","Hidden worksheets do not have a URL.")},createInvalidAggregationFieldName:function e(t){return e9.create("invalidAggregationFieldName","Invalid aggregation type for field '"+t+"'")},createInvalidToolbarButtonName:function e(t){return e9.create("invalidToolbarButtonName","Invalid toolbar button name: '"+t+"'")},createIndexOutOfRange:function e(t){return e9.create("indexOutOfRange","Index '"+t+"' is out of range.")},createUnsupportedEventName:function e(t){return e9.create("unsupportedEventName","Unsupported event '"+t+"'.")},createBrowserNotCapable:function e(){return e9.create("browserNotCapable","This browser is incapable of supporting the Tableau JavaScript API.")}}),ev=j.tab._Utility=en.mkType(er,"tab._Utility",null,null,{isNullOrEmpty:function e(t){return en.isNullOrUndefined(t)||0>=(t.length||0)},isString:function e(t){return"string"==typeof t},isNumber:function e(t){return"number"==typeof t},isDate:function e(t){return!!("object"==typeof t&&en.isInstanceOfType(t,en.JsDate))||"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(en.cast(t,en.JsDate).getTime())},isDateValid:function e(t){return!isNaN(t.getTime())},indexOf:function e(t,i,n){if(en.isValue(Array.prototype.indexOf))return en.unbox(en.cast(t.indexOf(i,n),en.Int32));n=n||0;var r=t.length;if(r>0){for(var a=n;a<r;a++)if(en.referenceEquals(t[a],i))return a}return -1},contains:function e(t,i,n){return ev.indexOf(t,i,n)>=0},getTopmostWindow:function e(){for(var t=window.self;en.isValue(t.parent)&&!en.referenceEquals(t.parent,t);)t=t.parent;return t},toInt:function e(t){if(ev.isNumber(t))return en.trunc(t);var i=parseInt(t.toString(),10);return isNaN(i)?0:i},hasClass:function e(t,i){var n=RegExp("[\\n\\t\\r]","g");return en.isValue(t)&&(" "+t.className+" ").replace(n," ").indexOf(" "+i+" ")>-1},findParentWithClassName:function e(t,i,n){var r=en.isValue(t)?en.cast(t.parentNode,HTMLElement):null;for(n=n||document.body;en.isValue(r)&&!ev.hasClass(r,i);)r=en.referenceEquals(r,n)?null:en.cast(r.parentNode,HTMLElement);return r},hasJsonParse:function e(){return!!(en.isValue(JSON)&&en.isValue(JSON.parse))},hasWindowPostMessage:function e(){return!!en.isValue(window.postMessage)},isPostMessageSynchronous:function e(){if(ev.isIE()){var t;return 8>=parseInt(RegExp("(msie) ([\\w.]+)").exec(window.navigator.userAgent.toLowerCase())[2]||"0",10)}return!1},hasDocumentAttachEvent:function e(){return!!en.isValue(document.attachEvent)},hasWindowAddEventListener:function e(){return!!en.isValue(window.addEventListener)},isElementOfTag:function e(t,i){return en.isValue(t)&&1===t.nodeType&&en.referenceEquals(t.tagName.toLowerCase(),i.toLowerCase())},elementToString:function e(t){var i=new en.StringBuilder;if(i.append(t.tagName.toLowerCase()),ev.isNullOrEmpty(t.id)||i.append("#").append(t.id),!ev.isNullOrEmpty(t.className)){var n=t.className.split(" ");i.append(".").append(n.join("."))}return i.toString()},tableauGCS:function e(t){return"function"==typeof window.getComputedStyle?window.getComputedStyle(t):t.currentStyle},isIE:function e(){return!!(window.navigator.userAgent.indexOf("MSIE")>-1&&en.isNullOrUndefined(window.opera))},isSafari:function e(){var t=window.navigator.userAgent,i=t.indexOf("Chrome")>=0;return t.indexOf("Safari")>=0&&!i},mobileDetect:function e(){var t=window.navigator.userAgent;return -1!==t.indexOf("iPad")||-1!==t.indexOf("Android")||-1!==t.indexOf("AppleWebKit")&&-1!==t.indexOf("Mobile")},visibleContentRectInDocumentCoordinates:function e(t){for(var i=ev.contentRectInDocumentCoordinates(t),n=t.parentElement;en.isValue(n)&&en.isValue(n.parentElement);n=n.parentElement){var r=ev.$getComputedStyle(n).overflow;("auto"===r||"scroll"===r||"hidden"===r)&&(i=i.intersect(ev.contentRectInDocumentCoordinates(n)))}var a=ev.$getViewportRect();return i.intersect(a)},getVisualViewportRect:function e(t){var i=t.visualViewport;return en.isValue(i)?new eg(en.trunc(i.pageLeft),en.trunc(i.pageTop),en.trunc(i.width),en.trunc(i.height)):null},$getViewportRect:function e(){var t=ev.getVisualViewportRect(window.self);if(en.isValue(t))return t;var i=ev.contentRectInDocumentCoordinates(document.documentElement),n=new tQ.WindowHelper(window.self);return n.isQuirksMode()&&(i.height=document.body.clientHeight-i.left,i.width=document.body.clientWidth-i.top),i.left+=n.get_pageXOffset(),i.top+=n.get_pageYOffset(),i},contentRectInDocumentCoordinates:function e(t){var i=ev.getBoundingClientRect(t),n=ev.$getComputedStyle(t),r=ev.toInt(n.paddingLeft),a=ev.toInt(n.paddingTop),s=ev.toInt(n.borderLeftWidth),o=ev.toInt(n.borderTopWidth),l=ev.computeContentSize(t),u=new tQ.WindowHelper(window.self),c=i.left+r+s+u.get_pageXOffset(),h=i.top+a+o+u.get_pageYOffset();return new eg(c,h,l.width,l.height)},getBoundingClientRect:function e(t){var i=t.getBoundingClientRect(),n=en.trunc(i.top),r=en.trunc(i.left),a=en.trunc(i.right),s=en.trunc(i.bottom);return new eg(r,n,a-r,s-n)},convertRawValue:function e(t,i){if(en.isNullOrUndefined(t))return null;switch(i){case"bool":default:case"string":return t;case"date":case"number":if(en.isNullOrUndefined(t))return Number.NaN;return t}},getDataValue:function e(t){return en.isNullOrUndefined(t)?eV.$ctor(null,null,null):eV.$ctor(ev.convertRawValue(t.value,t.type),t.formattedValue,t.aliasedValue)},serializeDateForServer:function e(t){var i="";if(en.isValue(t)&&ev.isDate(t)){var n,r=t.getUTCFullYear(),a=t.getUTCMonth()+1,s=t.getUTCDate(),o=t.getUTCHours();i=r+"-"+a+"-"+s+" "+o+":"+t.getUTCMinutes()+":"+t.getUTCSeconds()}return i},computeContentSize:function e(t){var i=ev.$getComputedStyle(t),n=parseFloat(i.paddingLeft),r=parseFloat(i.paddingTop),a=parseFloat(i.paddingRight),s=parseFloat(i.paddingBottom),o=t.clientWidth-Math.round(n+a),l=t.clientHeight-Math.round(r+s);return e_.$ctor(o,l)},$getComputedStyle:function e(t){return"function"==typeof window.getComputedStyle?en.isValue(t.ownerDocument.defaultView.opener)?t.ownerDocument.defaultView.getComputedStyle(t):window.getComputedStyle(t):en.isValue(t.currentStyle)?t.currentStyle:t.style},roundVizSizeInPixels:function e(t){return en.isNullOrUndefined(t)||!(-1!==t.indexOf("px"))?t:Math.round(parseFloat(t.split("px")[0]))+"px"},noResultPromiseHelper:function e(t,i,n){var r=new tQ._Deferred,a=new(en.makeGenericType(eA,[Object]))(t,1,function(e){r.resolve()},function(e,t){r.reject(e9.createServerError(t))});return n.sendCommand(Object).call(n,i,a),r.get_promise()},clone:function(e){return function e(t){return JSON.parse(JSON.stringify(t))}}}),ey=en.mkType(er,"tab.$DeferredUtil",null,null,{$coerceToTrustedPromise:function e(t){var i;if(t instanceof tableauSoftware.Promise)i=en.cast(t,ef);else if(en.isValue(t)&&"function"==typeof t.valueOf&&(t=t.valueOf()),ey.$isPromise(t)){var n=new em;en.cast(t,ef).then(en.mkdel(n,n.resolve),en.mkdel(n,n.reject)),i=n.get_promise()}else i=ey.$resolved(t);return i},$reject:function e(t){return ey.$coerceToTrustedPromise(t).then(function(e){return ey.$rejected(en.cast(e,en.Exception))},null)},$resolved:function e(t){return new ef(function(e,i){try{return ey.$coerceToTrustedPromise(en.isValue(e)?e(t):t)}catch(n){var r=en.Exception.wrap(n);return ey.$rejected(r)}})},$rejected:function e(t){return new ef(function(e,i){try{return en.isValue(i)?ey.$coerceToTrustedPromise(i(t)):ey.$rejected(t)}catch(n){var r=en.Exception.wrap(n);return ey.$rejected(r)}})},$isPromise:function e(t){return en.isValue(t)&&"function"==typeof t.then}}),e8=en.mkType(er,"tab.$DoNothingCrossDomainHandler",function(){this.$hostId=null,this.$1$StateReadyForQueryField=null},{add_stateReadyForQuery:function e(t){this.$1$StateReadyForQueryField=en.delegateCombine(this.$1$StateReadyForQueryField,t)},remove_stateReadyForQuery:function e(t){this.$1$StateReadyForQueryField=en.delegateRemove(this.$1$StateReadyForQueryField,t)},get_iframe:function e(){return null},get_hostId:function e(){return this.$hostId},set_hostId:function e(t){this.$hostId=t},get_$serverRoot:function e(){return"*"},handleEventNotification:function e(t,i){},$silenceTheCompilerWarning:function e(){this.$1$StateReadyForQueryField(null)}}),j.tab.ApiDashboardObjectType=en.mkEnum(er,"tab.ApiDashboardObjectType",{blank:"blank",worksheet:"worksheet",quickFilter:"quickFilter",parameterControl:"parameterControl",pageFilter:"pageFilter",legend:"legend",title:"title",text:"text",image:"image",webPage:"webPage",addIn:"addIn"},!0),ew=j.tab.ApiDateRangeType=en.mkEnum(er,"tab.ApiDateRangeType",{last:"last",lastn:"lastn",next:"next",nextn:"nextn",curr:"curr",todate:"todate"},!0),j.tab.ApiDeviceType=en.mkEnum(er,"tab.ApiDeviceType",{default:"default",desktop:"desktop",tablet:"tablet",phone:"phone"},!0),eb=j.tab.ApiEnumConverter=en.mkType(er,"tab.ApiEnumConverter",null,null,{convertDashboardObjectType:function e(t){switch(t){case"blank":return"blank";case"image":return"image";case"legend":return"legend";case"pageFilter":return"pageFilter";case"parameterControl":return"parameterControl";case"quickFilter":return"quickFilter";case"text":return"text";case"title":return"title";case"webPage":return"webPage";case"worksheet":return"worksheet";default:throw e9.createInternalError("Unknown ApiCrossDomainDashboardObjectType: "+t)}},convertDateRange:function e(t){switch(t){case"curr":return"curr";case"last":return"last";case"lastn":return"lastn";case"next":return"next";case"nextn":return"nextn";case"todate":return"todate";default:throw e9.createInternalError("Unknown ApiCrossDomainDateRangeType: "+t)}},convertFieldAggregation:function e(t){switch(t){case"ATTR":return"ATTR";case"AVG":return"AVG";case"COLLECT":return"COLLECT";case"COUNT":return"COUNT";case"COUNTD":return"COUNTD";case"DAY":return"DAY";case"END":return"END";case"HOUR":return"HOUR";case"INOUT":return"INOUT";case"KURTOSIS":return"KURTOSIS";case"MAX":return"MAX";case"MDY":return"MDY";case"MEDIAN":return"MEDIAN";case"MIN":return"MIN";case"MINUTE":return"MINUTE";case"MONTH":return"MONTH";case"MONTHYEAR":return"MONTHYEAR";case"NONE":return"NONE";case"PERCENTILE":return"PERCENTILE";case"QUART1":return"QUART1";case"QUART3":return"QUART3";case"QTR":return"QTR";case"SECOND":return"SECOND";case"SKEWNESS":return"SKEWNESS";case"STDEV":return"STDEV";case"STDEVP":return"STDEVP";case"SUM":return"SUM";case"SUM_XSQR":return"SUM_XSQR";case"TRUNC_DAY":return"TRUNC_DAY";case"TRUNC_HOUR":return"TRUNC_HOUR";case"TRUNC_MINUTE":return"TRUNC_MINUTE";case"TRUNC_MONTH":return"TRUNC_MONTH";case"TRUNC_QTR":return"TRUNC_QTR";case"TRUNC_SECOND":return"TRUNC_SECOND";case"TRUNC_WEEK":return"TRUNC_WEEK";case"TRUNC_YEAR":return"TRUNC_YEAR";case"USER":return"USER";case"VAR":return"VAR";case"VARP":return"VARP";case"WEEK":return"WEEK";case"WEEKDAY":return"WEEKDAY";case"YEAR":return"YEAR";default:throw e9.createInternalError("Unknown ApiCrossDomainFieldAggregationType: "+t)}},convertFieldRole:function e(t){switch(t){case"dimension":return"dimension";case"measure":return"measure";case"unknown":return"unknown";default:throw e9.createInternalError("Unknown ApiCrossDomainFieldRoleType: "+t)}},convertFilterType:function e(t){switch(t){case"categorical":return"categorical";case"hierarchical":return"hierarchical";case"quantitative":return"quantitative";case"relativedate":return"relativedate";default:throw e9.createInternalError("Unknown ApiCrossDomainFilterType: "+t)}},convertParameterAllowableValuesType:function e(t){switch(t){case"all":return"all";case"list":return"list";case"range":return"range";default:throw e9.createInternalError("Unknown ApiCrossDomainParameterAllowableValuesType: "+t)}},convertParameterDataType:function e(t){switch(t){case"boolean":return"boolean";case"date":return"date";case"datetime":return"datetime";case"float":return"float";case"integer":return"integer";case"string":return"string";default:throw e9.createInternalError("Unknown ApiCrossDomainParameterDataType: "+t)}},convertPeriodType:function e(t){switch(t){case"year":return"year";case"quarter":return"quarter";case"month":return"month";case"week":return"week";case"day":return"day";case"hour":return"hour";case"minute":return"minute";case"second":return"second";default:throw e9.createInternalError("Unknown ApiCrossDomainPeriodType: "+t)}},convertSheetType:function e(t){switch(t){case"worksheet":return"worksheet";case"dashboard":return"dashboard";case"story":return"story";default:throw e9.createInternalError("Unknown ApiCrossDomainSheetType: "+t)}},convertDataType:function e(t){switch(t){case"boolean":return"boolean";case"date":return"date";case"datetime":return"datetime";case"float":return"float";case"integer":return"integer";case"string":return"string";default:throw e9.createInternalError("Unknown ApiCrossDomainParameterDataType: "+t)}}}),j.tab.ApiErrorCode=en.mkEnum(er,"tab.ApiErrorCode",{internalError:"internalError",serverError:"serverError",invalidAggregationFieldName:"invalidAggregationFieldName",invalidToolbarButtonName:"invalidToolbarButtonName",invalidParameter:"invalidParameter",invalidUrl:"invalidUrl",staleDataReference:"staleDataReference",vizAlreadyInManager:"vizAlreadyInManager",noUrlOrParentElementNotFound:"noUrlOrParentElementNotFound",invalidFilterFieldName:"invalidFilterFieldName",invalidFilterFieldValue:"invalidFilterFieldValue",invalidFilterFieldNameOrValue:"invalidFilterFieldNameOrValue",filterCannotBePerformed:"filterCannotBePerformed",notActiveSheet:"notActiveSheet",invalidCustomViewName:"invalidCustomViewName",missingRangeNForRelativeDateFilters:"missingRangeNForRelativeDateFilters",missingMaxSize:"missingMaxSize",missingMinSize:"missingMinSize",missingMinMaxSize:"missingMinMaxSize",invalidSize:"invalidSize",invalidSizeBehaviorOnWorksheet:"invalidSizeBehaviorOnWorksheet",sheetNotInWorkbook:"sheetNotInWorkbook",indexOutOfRange:"indexOutOfRange",downloadWorkbookNotAllowed:"downloadWorkbookNotAllowed",nullOrEmptyParameter:"nullOrEmptyParameter",browserNotCapable:"browserNotCapable",unsupportedEventName:"unsupportedEventName",invalidDateParameter:"invalidDateParameter",invalidSelectionFieldName:"invalidSelectionFieldName",invalidSelectionValue:"invalidSelectionValue",invalidSelectionDate:"invalidSelectionDate",noUrlForHiddenWorksheet:"noUrlForHiddenWorksheet",maxVizResizeAttempts:"maxVizResizeAttempts"},!0),j.tab.ApiFieldAggregationType=en.mkEnum(er,"tab.ApiFieldAggregationType",{SUM:"SUM",AVG:"AVG",MIN:"MIN",MAX:"MAX",STDEV:"STDEV",STDEVP:"STDEVP",VAR:"VAR",VARP:"VARP",COUNT:"COUNT",COUNTD:"COUNTD",MEDIAN:"MEDIAN",ATTR:"ATTR",NONE:"NONE",PERCENTILE:"PERCENTILE",YEAR:"YEAR",QTR:"QTR",MONTH:"MONTH",DAY:"DAY",HOUR:"HOUR",MINUTE:"MINUTE",SECOND:"SECOND",WEEK:"WEEK",WEEKDAY:"WEEKDAY",MONTHYEAR:"MONTHYEAR",MDY:"MDY",END:"END",TRUNC_YEAR:"TRUNC_YEAR",TRUNC_QTR:"TRUNC_QTR",TRUNC_MONTH:"TRUNC_MONTH",TRUNC_WEEK:"TRUNC_WEEK",TRUNC_DAY:"TRUNC_DAY",TRUNC_HOUR:"TRUNC_HOUR",TRUNC_MINUTE:"TRUNC_MINUTE",TRUNC_SECOND:"TRUNC_SECOND",QUART1:"QUART1",QUART3:"QUART3",SKEWNESS:"SKEWNESS",KURTOSIS:"KURTOSIS",INOUT:"INOUT",SUM_XSQR:"SUM_XSQR",USER:"USER",COLLECT:"COLLECT"},!0),j.tab.ApiFieldRoleType=en.mkEnum(er,"tab.ApiFieldRoleType",{dimension:"dimension",measure:"measure",unknown:"unknown"},!0),j.tab.ApiFilterType=en.mkEnum(er,"tab.ApiFilterType",{categorical:"categorical",quantitative:"quantitative",hierarchical:"hierarchical",relativedate:"relativedate"},!0),eS=j.tab.ApiFilterUpdateType=en.mkEnum(er,"tab.ApiFilterUpdateType",{all:"all",replace:"replace",add:"add",remove:"remove"},!0),eC=j.tab.ApiMessageHandler=en.mkType(er,"tab.ApiMessageHandler",function(){},{handleEventNotification:function e(t,i){throw new en.NotImplementedException}}),eI=j.tab.ApiMessagingOptions=en.mkType(er,"tab.ApiMessagingOptions",function(e,t){this.$router=null,this.$handler=null,ep.verifyValue(e,"router"),this.$router=e,this.$handler=t},{get_handler:function e(){return this.$handler},get_router:function e(){return this.$router},sendCommand:function(e){return function t(i,n){this.$router.sendCommand(e).call(this.$router,this.$handler,i,n)}},dispose:function e(){this.$router.unregisterHandler(this.$handler)}}),eT=j.tab.ApiNullOption=en.mkEnum(er,"tab.ApiNullOption",{nullValues:"nullValues",nonNullValues:"nonNullValues",allValues:"allValues"},!0),j.tab.ApiParameterAllowableValuesType=en.mkEnum(er,"tab.ApiParameterAllowableValuesType",{all:"all",list:"list",range:"range"},!0),j.tab.ApiParameterDataType=en.mkEnum(er,"tab.ApiParameterDataType",{float:"float",integer:"integer",string:"string",boolean:"boolean",date:"date",datetime:"datetime"},!0),ek=j.tab.ApiPeriodType=en.mkEnum(er,"tab.ApiPeriodType",{year:"year",quarter:"quarter",month:"month",week:"week",day:"day",hour:"hour",minute:"minute",second:"second"},!0),j.tab.ApiSelectionUpdateType=en.mkEnum(er,"tab.ApiSelectionUpdateType",{replace:"replace",add:"add",remove:"remove"},!0),j.tab.ApiSheetSizeBehavior=en.mkEnum(er,"tab.ApiSheetSizeBehavior",{automatic:"automatic",exactly:"exactly",range:"range",atleast:"atleast",atmost:"atmost"},!0),j.tab.ApiSheetType=en.mkEnum(er,"tab.ApiSheetType",{worksheet:"worksheet",dashboard:"dashboard",story:"story"},!0),j.tab.ApiTableauEventName=en.mkEnum(er,"tab.ApiTableauEventName",{customviewload:"customviewload",customviewremove:"customviewremove",customviewsave:"customviewsave",customviewsetdefault:"customviewsetdefault",filterchange:"filterchange",firstinteractive:"firstinteractive",firstvizsizeknown:"firstvizsizeknown",marksselection:"marksselection",markshighlight:"markshighlight",parametervaluechange:"parametervaluechange",storypointswitch:"storypointswitch",tabswitch:"tabswitch",toolbarstatechange:"toolbarstatechange",urlaction:"urlaction",vizresize:"vizresize"},!0),j.tab.ApiToolbarButtonName=en.mkEnum(er,"tab.ApiToolbarButtonName",{redo:"redo",undo:"undo"},!0),j.tab.ApiToolbarPosition=en.mkEnum(er,"tab.ApiToolbarPosition",{top:"top",bottom:"bottom"},!0),eA=j.tab.CommandReturnHandler$1=en.mkType(er,"tab.CommandReturnHandler$1",function(e){return en.registerGenericClassInstance(eA,[e],function(e,t,i,n){this.$commandName=null,this.$successCallbackTiming=0,this.$successCallback=null,this.$errorCallback=null,this.$commandName=e,this.$successCallback=i,this.$successCallbackTiming=t,this.$errorCallback=n},{get_commandName:function e(){return this.$commandName},get_successCallback:function e(){return this.$successCallback},get_successCallbackTiming:function e(){return this.$successCallbackTiming},get_errorCallback:function e(){return this.$errorCallback}})}),en.initGenericClass(eA,1),eE=j.tab.CrossDomainMessager=en.mkType(er,"tab.CrossDomainMessager",function(e){if(this.$nextHandlerId=0,this.$handlers={},this.$commandCallbacks={},this.$commandReturnAfterStateReadyQueues={},this.$legacyHandler=null,this.$legacyHandler=e,ev.hasWindowAddEventListener())window.addEventListener("message",en.mkdel(this,this.$handleCrossDomainMessage),!1);else if(ev.hasDocumentAttachEvent()){var t=en.mkdel(this,this.$handleCrossDomainMessage);document.attachEvent("onmessage",t),window.attachEvent("onmessage",t)}else window.onmessage=en.mkdel(this,this.$handleCrossDomainMessage);this.$nextHandlerId=0},{registerHandler:function e(t){var i="host"+this.$nextHandlerId;if(en.isValue(t.get_hostId())||en.isValue(this.$handlers[t.get_hostId()]))throw e9.createInternalError("Host '"+t.get_hostId()+"' is already registered.");this.$nextHandlerId++,t.set_hostId(i),this.$handlers[i]=t,t.add_stateReadyForQuery(en.mkdel(this,this.$handleStateReadyForQuery))},unregisterHandler:function e(t){(en.isValue(t.get_hostId())||en.isValue(this.$handlers[t.get_hostId()]))&&(delete this.$handlers[t.get_hostId()],t.remove_stateReadyForQuery(en.mkdel(this,this.$handleStateReadyForQuery)))},sendCommand:function(e){return function e(t,i,n){var r=t.get_iframe(),a=t.get_hostId();if(!(!ev.hasWindowPostMessage()||en.isNullOrUndefined(r)||en.isNullOrUndefined(r.contentWindow))){var s=ea.generateNextCommandId(),o=this.$commandCallbacks[a];en.isNullOrUndefined(o)&&(o={},this.$commandCallbacks[a]=o),o[s]=n;var l=n.get_commandName(),u=null;en.isValue(i)&&(u=JSON.stringify(i));var c=new ea(l,s,a,u).serialize();ev.isPostMessageSynchronous()?window.setTimeout(function(){r.contentWindow.postMessage(c,"*")},0):r.contentWindow.postMessage(c,"*")}}},$handleStateReadyForQuery:function e(t){var i=this.$commandReturnAfterStateReadyQueues[t.get_hostId()];if(!ev.isNullOrEmpty(i))for(;i.length>0;){var n=i.pop();en.isValue(n)&&n()}},$handleCrossDomainMessage:function e(t){var i=en.cast(t,MessageEvent);if(!en.isNullOrUndefined(i.data)){var n=ea.parse(i.data.toString()),r=n.get_hostId(),a=this.$handlers[r];if((en.isNullOrUndefined(a)||!en.referenceEquals(a.get_hostId(),n.get_hostId()))&&(a=this.$findHostIdByDomComparison(i)),n.get_isApiCommandName()){if(en.referenceEquals(n.get_commandId(),ea.crossDomainEventNotificationId)){if(a.handleEventNotification(n.get_name(),n.get_parameters()),"api.FirstVizSizeKnownEvent"===n.get_name()){var s=new eP("tableau.bootstrap",[]);i.source.postMessage(s.serialize(),"*")}}else this.$handleCrossDomainResponse(n)}else if(!en.isNullOrUndefined(this.$legacyHandler)){var o=eP.parse(i.data.toString());this.$legacyHandler(o,a)}}},$handleCrossDomainResponse:function e(t){var i=this.$commandCallbacks[t.get_hostId()],n=en.isValue(i)?i[t.get_commandId()]:null;if(!en.isNullOrUndefined(n)){if(delete i[t.get_commandId()],t.get_name()===n.get_commandName()){var r=new el(t.get_parameters()),a=r.get_data();if("api.success"===r.get_result())switch(n.get_successCallbackTiming()){case 0:en.isValue(n.get_successCallback())&&n.get_successCallback()(a);break;case 1:var s=function(){en.isValue(n.get_successCallback())&&n.get_successCallback()(a)},o=this.$commandReturnAfterStateReadyQueues[t.get_hostId()];en.isNullOrUndefined(o)&&(o=[],this.$commandReturnAfterStateReadyQueues[t.get_hostId()]=o),o.push(s);break;default:throw e9.createInternalError("Unknown timing value: "+n.get_successCallbackTiming())}else if(en.isValue(n.get_errorCallback())){var l="api.remotefailed"===r.get_result(),u=en.isValue(a)?a.toString():"";n.get_errorCallback()(l,u)}}}},$findHostIdByDomComparison:function e(t){var i=new en.ObjectEnumerator(this.$handlers);try{for(;i.moveNext();){var n=i.current();if(this.$handlers.hasOwnProperty(n.key)&&en.referenceEquals(n.value.get_iframe().contentWindow,t.source))return n.value}}finally{i.dispose()}return new e8}}),j.tab.DataType=en.mkEnum(er,"tab.DataType",{float:"float",integer:"integer",string:"string",boolean:"boolean",date:"date",datetime:"datetime"},!0),eV=j.tab.DataValue=en.mkType(er,"tab.DataValue",null,null,{$ctor:function(e,t,i){var n={};return n.value=null,n.formattedValue=null,n.value=e,ev.isNullOrEmpty(i)?n.formattedValue=t:n.formattedValue=i,n},isInstanceOfType:function(){return!0}}),eN=j.tab.FilterCommandsBuilder=en.mkType(er,"tab.FilterCommandsBuilder",function(){},{buildApplyFiltersCommandParams:function e(t,i,n,r){if(ev.isNullOrEmpty(t))throw e9.createNullOrEmptyParameter("fieldName");n=ex.normalizeEnum(eS).call(null,n,"updateType");var a=[];if(ed.isArray(i))for(var s=0;s<i.length;s++)a.push(i[s].toString());else en.isValue(i)&&a.push(i.toString());var o={};return o["api.fieldCaption"]=t,o["api.filterUpdateType"]=n,o["api.exclude"]=!!en.isValue(r)&&!!r.isExcludeMode,"all"!==n&&(o["api.filterCategoricalValues"]=a),o},buildRangeFilterCommandParams:function e(t,i){if(ev.isNullOrEmpty(t))throw e9.createNullOrEmptyParameter("fieldName");if(en.isNullOrUndefined(i))throw e9.createNullOrEmptyParameter("filterOptions");var n={};if(n["api.fieldCaption"]=t,en.isValue(i.min)){if(ev.isDate(i.min)){var r=en.cast(i.min,en.JsDate);if(ev.isDateValid(r))n["api.filterRangeMin"]=ev.serializeDateForServer(r);else throw e9.createInvalidDateParameter("filterOptions.min")}else n["api.filterRangeMin"]=i.min}if(en.isValue(i.max)){if(ev.isDate(i.max)){var a=en.cast(i.max,en.JsDate);if(ev.isDateValid(a))n["api.filterRangeMax"]=ev.serializeDateForServer(a);else throw e9.createInvalidDateParameter("filterOptions.max")}else n["api.filterRangeMax"]=i.max}return en.isValue(i.nullOption)&&(n["api.filterRangeNullOption"]=i.nullOption),n},buildRelativeDateFilterCommandParams:function e(t,i){if(ev.isNullOrEmpty(t))throw e9.createInvalidParameter("fieldName");if(en.isNullOrUndefined(i))throw e9.createInvalidParameter("filterOptions");var n={};if(n["api.fieldCaption"]=t,en.isValue(i)){if(n["api.filterPeriodType"]=i.periodType,n["api.filterDateRangeType"]=i.rangeType,"lastn"===i.rangeType||"nextn"===i.rangeType){if(en.isNullOrUndefined(i.rangeN))throw e9.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");n["api.filterDateRange"]=i.rangeN}en.isValue(i.anchorDate)&&(n["api.filterDateArchorValue"]=ev.serializeDateForServer(i.anchorDate))}return n},buildHierarchicalFilterCommandParams:function e(t,i,n,r){if(ev.isNullOrEmpty(t))throw e9.createNullOrEmptyParameter("fieldName");n=ex.normalizeEnum(eS).call(null,n,"updateType");var a=null,s=null;if(ed.isArray(i)){a=[];for(var o=i,l=0;l<o.length;l++)a.push(o[l].toString())}else if(ev.isString(i))(a=[]).push(i.toString());else if(en.isValue(i)&&en.isValue(i.levels)){var u=i.levels;if(s=[],ed.isArray(u))for(var c=u,h=0;h<c.length;h++)s.push(c[h].toString());else s.push(u.toString())}else if(en.isValue(i))throw e9.createInvalidParameter("values");var m={};return m["api.fieldCaption"]=t,m["api.filterUpdateType"]=n,m["api.exclude"]=!!en.isValue(r)&&!!r.isExcludeMode,en.isValue(a)&&(m["api.filterHierarchicalValues"]=JSON.stringify(a)),en.isValue(s)&&(m["api.filterHierarchicalLevels"]=JSON.stringify(s)),m},buildClearFilterCommandsParam:function e(t){if(ev.isNullOrEmpty(t))throw e9.createNullOrEmptyParameter("fieldName");var i={};return i["api.fieldCaption"]=t,i},filterCommandError:function e(t){var i=t;if(en.isValue(i)&&en.isValue(i.errorCode)){var n=en.isValue(i.additionalInformation)?i.additionalInformation.toString():"";switch(i.errorCode){case"invalidFilterFieldName":return e9.create("invalidFilterFieldName",n);case"invalidFilterFieldValue":return e9.create("invalidFilterFieldValue",n);case"invalidAggregationFieldName":return e9.createInvalidAggregationFieldName(n);default:return e9.createServerError(n)}}return null},normalizeRangeFilterOption:function e(t){if(en.isNullOrUndefined(t))throw e9.createNullOrEmptyParameter("filterOptions");if(en.isNullOrUndefined(t.min)&&en.isNullOrUndefined(t.max)&&en.isNullOrUndefined(t.nullOption))throw e9.create("invalidParameter","At least one of filterOptions.min or filterOptions.max or filterOptions.nullOption must be specified.");var i={};return en.isValue(t.min)&&(i.min=t.min),en.isValue(t.max)&&(i.max=t.max),en.isValue(t.nullOption)&&(i.nullOption=ex.normalizeEnum(eT).call(null,t.nullOption,"filterOptions.nullOption")),i},normalizeRelativeDateFilterOptions:function e(t){if(en.isNullOrUndefined(t))throw e9.createNullOrEmptyParameter("filterOptions");var i={};if(i.rangeType=ex.normalizeEnum(ew).call(null,t.rangeType,"filterOptions.rangeType"),i.periodType=ex.normalizeEnum(ek).call(null,t.periodType,"filterOptions.periodType"),"lastn"===i.rangeType||"nextn"===i.rangeType){if(en.isNullOrUndefined(t.rangeN))throw e9.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");i.rangeN=ev.toInt(t.rangeN)}if(en.isValue(t.anchorDate)){if(!ev.isDate(t.anchorDate)||!ev.isDateValid(t.anchorDate))throw e9.createInvalidDateParameter("filterOptions.anchorDate");i.anchorDate=t.anchorDate}return i},createFilterCommandReturnHandler:function e(t,i,n){return new(en.makeGenericType(eA,[Object]))(t,0,en.mkdel(this,function(e){var t=this.filterCommandError(e);en.isNullOrUndefined(t)?n.resolve(i):n.reject(t)}),function(e,t){if(e)n.reject(e9.createInvalidFilterFieldNameOrValue(i));else{var r=e9.create("filterCannotBePerformed",t);n.reject(r)}})}}),eF=j.tab.GetDataCommandsBuilder=en.mkType(er,"tab.GetDataCommandsBuilder",function(){},{getSummaryDataCommandParams:function e(t){var i={};return t=t||{},i["api.ignoreAliases"]=en.coalesce(t.ignoreAliases,!1),i["api.ignoreSelection"]=en.coalesce(t.ignoreSelection,!1),i["api.maxRows"]=en.coalesce(t.maxRows,0),i},getUnderlyingDataCommandParams:function e(t){var i={};return t=t||{},i["api.ignoreAliases"]=en.coalesce(t.ignoreAliases,!1),i["api.ignoreSelection"]=en.coalesce(t.ignoreSelection,!1),i["api.includeAllColumns"]=en.coalesce(t.includeAllColumns,!1),i["api.maxRows"]=en.coalesce(t.maxRows,0),i},getUnderlyingTablesCommandParams:function e(){return{}},getUnderlyingTableDataCommandParams:function e(t,i){var n={};return i=i||{},n["api.ignoreAliases"]=en.coalesce(i.ignoreAliases,!1),n["api.ignoreSelection"]=en.coalesce(i.ignoreSelection,!1),n["api.includeAllColumns"]=en.coalesce(i.includeAllColumns,!1),n["api.maxRows"]=en.coalesce(i.maxRows,0),n["api.tableId"]=en.coalesce(t,""),n},getSummaryDataResponseHandler:function e(t){return new(en.makeGenericType(eA,[Object]))("api.GetSummaryTableCommand",0,en.mkdel(this,function(e){var i=this.processGetDataPresModel(e);t.resolve(i)}),function(e,i){t.reject(e9.createServerError(i))})},getUnderlyingDataResponseHandler:function e(t){return new(en.makeGenericType(eA,[Object]))("api.GetUnderlyingTableCommand",0,en.mkdel(this,function(e){var i=this.processGetDataPresModel(e);t.resolve(i)}),function(e,i){t.reject(e9.createServerError(i))})},processGetDataPresModel:function e(t){var i=this.$processUnderlyingTable(t.dataTable),n=this.$processUnderlyingColumns(t.headers),r=new eh(i,t.isSummary,i.length,n);return new eL(r)},$processUnderlyingTable:function e(t){for(var i=[],n=0;n<t.length;n++){for(var r=t[n],a=[],s=0;s<r.length;s++){var o=r[s];a.push(ev.getDataValue(o))}i.push(a)}return i},$processUnderlyingColumns:function e(t){for(var i=[],n=0;n<t.length;n++){var r=t[n],a=new ec(r.fieldName,eb.convertDataType(r.dataType),r.isReferenced,r.index);i.push(new eH(a))}return i},$appendErrorMessageIfNeededThenLog:function e(t,i){var n=i;if(!t){var r=new en.StringBuilder(i);r.append("\nPossible reasons:"),r.append("\nCalling newer version of API against an older version of Tableau Server"),n=r.toString()}return console.error(n),n},getUnderlyingTablesResponseHandler:function e(t){return new(en.makeGenericType(eA,[Object]))("api.GetUnderlyingTablesCommand",0,en.mkdel(this,function(e){var i=this.$processGetLogicalTablesPresModel(e);t.resolve(i._toApiCollection())}),en.mkdel(this,function(e,i){t.reject(e9.createServerError(this.$appendErrorMessageIfNeededThenLog(e,i)))}))},$processGetLogicalTablesPresModel:function e(t){for(var i=new tQ._Collection,n=0;n<t.logicalTables.length;n++){var r=t.logicalTables[n];i._add(r.tableId,new eW(r.tableId,r.caption))}return i},getUnderlyingTableDataResponseHandler:function e(t){return new(en.makeGenericType(eA,[Object]))("api.GetUnderlyingTableDataCommand",0,en.mkdel(this,function(e){var i=this.processGetDataPresModel(e);t.resolve(i)}),en.mkdel(this,function(e,i){t.reject(e9.createServerError(this.$appendErrorMessageIfNeededThenLog(e,i)))}))}}),eO=j.tab.HostedApiMessageHandler=en.mkType(er,"tab.HostedApiMessageHandler",function(){this.$2$StateReadyForQueryField=null,eC.call(this)},{add_stateReadyForQuery:function e(t){this.$2$StateReadyForQueryField=en.delegateCombine(this.$2$StateReadyForQueryField,t)},remove_stateReadyForQuery:function e(t){this.$2$StateReadyForQueryField=en.delegateRemove(this.$2$StateReadyForQueryField,t)},get_hostId:function e(){return null},set_hostId:function e(t){},get_iframe:function e(){return null}}),eD=j.tab.HostedApiMessageRouter=en.mkType(er,"tab.HostedApiMessageRouter",function(){this.$crossDomainMessager=null,this.$crossDomainMessager=new eE(null)},{registerHandler:function e(t){this.$crossDomainMessager.registerHandler(t)},unregisterHandler:function e(t){this.$crossDomainMessager.unregisterHandler(t)},sendCommand:function(e){return function t(i,n,r){this.$crossDomainMessager.sendCommand(e).call(this.$crossDomainMessager,i,n,r)}}}),eR=j.tab.MarkImpl=en.mkType(er,"tab.MarkImpl",function(e){if(this.$clonedPairs=null,this.$collection=new tQ._Collection,this.$tupleId=0,ed.isArray(e))for(var t=e,i=0;i<t.length;i++){var n=t[i];if(!en.isValue(n.fieldName))throw e9.createInvalidParameter("pair.fieldName");if(!en.isValue(n.value))throw e9.createInvalidParameter("pair.value");var r=new eG(n.fieldName,n.value);this.$collection._add(r.fieldName,r)}else this.$tupleId=e},{get_pairs:function e(){return this.$collection},get_tupleId:function e(){return this.$tupleId},get_$clonedPairs:function e(){return en.isNullOrUndefined(this.$clonedPairs)&&(this.$clonedPairs=this.$collection._toApiCollection()),this.$clonedPairs},$addPair:function e(t){this.$collection._add(t.fieldName,t)}},{processActiveMarks:function e(t){var i=new tQ._Collection;if(en.isNullOrUndefined(t)||ev.isNullOrEmpty(t.marks))return i;for(var n=0;n<t.marks.length;n++){var r=t.marks[n],a=r.tupleId,s=new ej(a);i._add(a.toString(),s);for(var o=0;o<r.pairs.length;o++){var l=r.pairs[o],u=ev.convertRawValue(l.value,l.valueDataType),c=new eG(l.fieldName,u);c.formattedValue=l.formattedValue,s.impl.get_pairs()._has(c.fieldName)||s.impl.$addPair(c)}}return i}}),eP=j.tab.NonApiCommand=en.mkType(er,"tab.NonApiCommand",function(e,t){this.$parameters=null,this.$1$NameField=null,this.set_name(e),this.$parameters=t},{get_name:function e(){return this.$1$NameField},set_name:function e(t){this.$1$NameField=t},get_parameters:function e(){return this.$parameters},serialize:function e(){var t=[];return t.push(this.get_name().toString()),(t=t.concat.apply(t,this.$parameters)).join(",")}},{parse:function e(t){var i=t.split(","),n=en.cast(i[0],String),r=i.slice(1);return new eP(n,r)}}),ez=j.tab.Point=en.mkType(er,"tab.Point",null,null,{$ctor:function(e,t){var i={};return i.x=0,i.y=0,i.x=e,i.y=t,i},isInstanceOfType:function(){return!0}}),ex=j.tab.PublicEnums=en.mkType(er,"tab.PublicEnums",null,null,{tryNormalizeEnum:function(e){return function t(i,n){if(en.isValue(i))for(var r=i.toString().toUpperCase(),a=en.Enum.getValues(e),s=0;s<a.length;s++){var o=en.cast(a[s],String),l=o.toUpperCase();if(en.referenceEquals(r,l))return n.$=o,!0}return n.$=en.getDefaultValue(e),!1}},normalizeEnum:function(e){return function t(i,n){var r={};if(!ex.tryNormalizeEnum(e).call(null,i,r))throw e9.createInvalidParameter(n);return r.$}},isValidEnum:function(e){return function t(i){return ex.tryNormalizeEnum(e).call(null,i,{})}}}),eU=j.tab.SharedUtils=en.mkType(er,"tab.SharedUtils",function(){},{addVisualIdForWorksheet:function e(t,i,n){t["api.worksheetName"]=i,en.isValue(n)&&(t["api.dashboardName"]=n)}}),e$=j.tab.SheetSize=en.mkType(er,"tab.SheetSize",null,null,{$ctor:function(e,t,i){var n={};return n.behavior=null,n.minSize=null,n.maxSize=null,n.behavior=en.coalesce(e,"automatic"),en.isValue(t)?n.minSize=t:delete n.minSize,en.isValue(i)?n.maxSize=i:delete n.maxSize,n},isInstanceOfType:function(){return!0}}),eM=j.tab.SheetSizeFactory=en.mkType(er,"tab.SheetSizeFactory",null,null,{createAutomatic:function e(){return e$.$ctor("automatic",null,null)},fromSizeConstraints:function e(t){var i=t.minHeight,n=t.minWidth,r=t.maxHeight,a=t.maxWidth,s="automatic",o=null,l=null;return 0===i&&0===n?0===r&&0===a||(s="atmost",l=e_.$ctor(a,r)):0===r&&0===a?(s="atleast",o=e_.$ctor(n,i)):r===i&&a===n&&n>0?(s="exactly",o=e_.$ctor(n,i),l=e_.$ctor(n,i)):(s="range",0===n&&0===a&&(a=2147483647),o=e_.$ctor(n,i),l=e_.$ctor(a,r)),e$.$ctor(s,o,l)}}),e_=j.tab.Size=en.mkType(er,"tab.Size",null,null,{$ctor:function(e,t){var i={};return i.width=0,i.height=0,i.width=e,i.height=t,i},isInstanceOfType:function(){return!0}}),eH=j.tableauSoftware.Column=en.mkType(er,"tableauSoftware.Column",function(e){this.$impl=null,this.$impl=e},{getFieldName:function e(){return this.$impl.get_fieldName()},getDataType:function e(){return this.$impl.get_dataType()},getIsReferenced:function e(){return this.$impl.get_isReferenced()},getIndex:function e(){return this.$impl.get_index()}}),eL=j.tableauSoftware.DataTable=en.mkType(er,"tableauSoftware.DataTable",function(e){this.$impl=null,this.$impl=e},{getName:function e(){return this.$impl.get_name()},getData:function e(){return this.$impl.get_rows()},getColumns:function e(){return this.$impl.get_columns()},getTotalRowCount:function e(){return this.$impl.get_totalRowCount()},getIsSummaryData:function e(){return this.$impl.get_isSummaryData()}}),eW=j.tableauSoftware.LogicalTable=en.mkType(er,"tableauSoftware.LogicalTable",function(e,t){this.$tableId=null,this.$caption=null,this.$tableId=e,this.$caption=t},{getTableId:function e(){return this.$tableId},getCaption:function e(){return this.$caption}}),ej=j.tableauSoftware.Mark=en.mkType(er,"tableauSoftware.Mark",function(e){this.impl=null,this.impl=new eR(e)},{getPairs:function e(){return this.impl.get_$clonedPairs()}}),eG=j.tableauSoftware.Pair=en.mkType(er,"tableauSoftware.Pair",function(e,t){this.fieldName=null,this.value=null,this.formattedValue=null,this.fieldName=e,this.value=t,this.formattedValue=en.isValue(t)?t.toString():""}),en.initClass(ea),en.initClass(es),en.initClass(eo),en.initClass(el),en.initClass(eu),en.initClass(ec),en.initClass(eh),en.initClass(em),en.initClass(ed),en.initClass(ep),en.initClass(ef),en.initClass(eg),en.initClass(e9),en.initClass(ev),en.initClass(ey),en.initClass(e8),en.initClass(eb),en.initClass(eC),en.initClass(eI),en.initClass(eE),en.initClass(eV,Object),en.initClass(eN),en.initClass(eF),en.initClass(eO,eC),en.initClass(eD),en.initClass(eR),en.initClass(eP),en.initClass(ez,Object),en.initClass(ex),en.initClass(eU),en.initClass(e$,Object),en.initClass(eM),en.initClass(e_,Object),en.initClass(eH),en.initClass(eL),en.initClass(eW),en.initClass(ej),en.initClass(eG),ea.crossDomainEventNotificationId="xdomainSourceId",ea.lastRequestMessage=null,ea.lastResponseMessage=null,ea.lastClientInfoResponseMessage=null,ea.$nextCommandId=0,eB=window._ApiObjectRegistryGlobalState,en.isNullOrUndefined(eB)&&(eB={}),window._ApiObjectRegistryGlobalState=eB,window._ApiObjectRegistryGlobalState.creationRegistry=window._ApiObjectRegistryGlobalState.creationRegistry||{},window._ApiObjectRegistryGlobalState.singletonInstanceRegistry=window._ApiObjectRegistryGlobalState.singletonInstanceRegistry||{},ed.$arrayType="array",ed.$booleanType="boolean",ed.$dateType="date",ed.$functionType="function",ed.$numberType="number",ed.$objectType="object",ed.$regExpType="regexp",ed.$stringType="string",ed.$class2type=en.mkdict(["[object Boolean]",ed.$booleanType,"[object Number]",ed.$numberType,"[object String]",ed.$stringType,"[object Function]",ed.$functionType,"[object Array]",ed.$arrayType,"[object Date]",ed.$dateType,"[object RegExp]",ed.$regExpType,"[object Object]",ed.$objectType]),ed.$trim=en.cast(String.prototype.trim,Function),ed.$toString=en.cast(Object.prototype.toString,Function),ed.$trimLeft=RegExp("^[\\s\\xA0]+"),ed.$trimRight=RegExp("[\\s\\xA0]+$"),ed.$rvalidchars=RegExp("^[\\],:{}\\s]*$"),ed.$rvalidescape=RegExp('\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})',"g"),ed.$rvalidtokens=RegExp('"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?',"g"),ed.$rvalidbraces=RegExp("(?:^|:|,)(?:\\s*\\[)+","g"),(eq=j.tableauSoftware).DeviceType={DEFAULT:"default",DESKTOP:"desktop",TABLET:"tablet",PHONE:"phone"},eq.DashboardObjectType={BLANK:"blank",WORKSHEET:"worksheet",QUICK_FILTER:"quickFilter",PARAMETER_CONTROL:"parameterControl",PAGE_FILTER:"pageFilter",LEGEND:"legend",TITLE:"title",TEXT:"text",IMAGE:"image",WEB_PAGE:"webPage",ADDIN:"addIn"},eq.DataType={FLOAT:"float",INTEGER:"integer",STRING:"string",BOOLEAN:"boolean",DATE:"date",DATETIME:"datetime"},eq.DateRangeType={LAST:"last",LASTN:"lastn",NEXT:"next",NEXTN:"nextn",CURR:"curr",TODATE:"todate"},eq.ErrorCode={INTERNAL_ERROR:"internalError",SERVER_ERROR:"serverError",INVALID_AGGREGATION_FIELD_NAME:"invalidAggregationFieldName",INVALID_TOOLBAR_BUTTON_NAME:"invalidToolbarButtonName",INVALID_PARAMETER:"invalidParameter",INVALID_URL:"invalidUrl",STALE_DATA_REFERENCE:"staleDataReference",VIZ_ALREADY_IN_MANAGER:"vizAlreadyInManager",NO_URL_OR_PARENT_ELEMENT_NOT_FOUND:"noUrlOrParentElementNotFound",INVALID_FILTER_FIELDNAME:"invalidFilterFieldName",INVALID_FILTER_FIELDVALUE:"invalidFilterFieldValue",INVALID_FILTER_FIELDNAME_OR_VALUE:"invalidFilterFieldNameOrValue",FILTER_CANNOT_BE_PERFORMED:"filterCannotBePerformed",NOT_ACTIVE_SHEET:"notActiveSheet",INVALID_CUSTOM_VIEW_NAME:"invalidCustomViewName",MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS:"missingRangeNForRelativeDateFilters",MISSING_MAX_SIZE:"missingMaxSize",MISSING_MIN_SIZE:"missingMinSize",MISSING_MINMAX_SIZE:"missingMinMaxSize",INVALID_SIZE:"invalidSize",INVALID_SIZE_BEHAVIOR_ON_WORKSHEET:"invalidSizeBehaviorOnWorksheet",SHEET_NOT_IN_WORKBOOK:"sheetNotInWorkbook",INDEX_OUT_OF_RANGE:"indexOutOfRange",DOWNLOAD_WORKBOOK_NOT_ALLOWED:"downloadWorkbookNotAllowed",NULL_OR_EMPTY_PARAMETER:"nullOrEmptyParameter",BROWSER_NOT_CAPABLE:"browserNotCapable",UNSUPPORTED_EVENT_NAME:"unsupportedEventName",INVALID_DATE_PARAMETER:"invalidDateParameter",INVALID_SELECTION_FIELDNAME:"invalidSelectionFieldName",INVALID_SELECTION_VALUE:"invalidSelectionValue",INVALID_SELECTION_DATE:"invalidSelectionDate",NO_URL_FOR_HIDDEN_WORKSHEET:"noUrlForHiddenWorksheet",MAX_VIZ_RESIZE_ATTEMPTS:"maxVizResizeAttempts"},eq.FieldAggregationType={SUM:"SUM",AVG:"AVG",MIN:"MIN",MAX:"MAX",STDEV:"STDEV",STDEVP:"STDEVP",VAR:"VAR",VARP:"VARP",COUNT:"COUNT",COUNTD:"COUNTD",MEDIAN:"MEDIAN",ATTR:"ATTR",NONE:"NONE",PERCENTILE:"PERCENTILE",YEAR:"YEAR",QTR:"QTR",MONTH:"MONTH",DAY:"DAY",HOUR:"HOUR",MINUTE:"MINUTE",SECOND:"SECOND",WEEK:"WEEK",WEEKDAY:"WEEKDAY",MONTHYEAR:"MONTHYEAR",MDY:"MDY",END:"END",TRUNC_YEAR:"TRUNC_YEAR",TRUNC_QTR:"TRUNC_QTR",TRUNC_MONTH:"TRUNC_MONTH",TRUNC_WEEK:"TRUNC_WEEK",TRUNC_DAY:"TRUNC_DAY",TRUNC_HOUR:"TRUNC_HOUR",TRUNC_MINUTE:"TRUNC_MINUTE",TRUNC_SECOND:"TRUNC_SECOND",QUART1:"QUART1",QUART3:"QUART3",SKEWNESS:"SKEWNESS",KURTOSIS:"KURTOSIS",INOUT:"INOUT",SUM_XSQR:"SUM_XSQR",USER:"USER",COLLECT:"COLLECT"},eq.FieldRoleType={DIMENSION:"dimension",MEASURE:"measure",UNKNOWN:"unknown"},eq.FilterUpdateType={ALL:"all",REPLACE:"replace",ADD:"add",REMOVE:"remove"},eq.FilterType={CATEGORICAL:"categorical",QUANTITATIVE:"quantitative",HIERARCHICAL:"hierarchical",RELATIVEDATE:"relativedate"},eq.NullOption={NULL_VALUES:"nullValues",NON_NULL_VALUES:"nonNullValues",ALL_VALUES:"allValues"},eq.ParameterAllowableValuesType={ALL:"all",LIST:"list",RANGE:"range"},eq.ParameterDataType={FLOAT:"float",INTEGER:"integer",STRING:"string",BOOLEAN:"boolean",DATE:"date",DATETIME:"datetime"},eq.PeriodType={YEAR:"year",QUARTER:"quarter",MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTE:"minute",SECOND:"second"},eq.SelectionUpdateType={REPLACE:"replace",ADD:"add",REMOVE:"remove"},eq.SheetSizeBehavior={AUTOMATIC:"automatic",EXACTLY:"exactly",RANGE:"range",ATLEAST:"atleast",ATMOST:"atmost"},eq.SheetType={WORKSHEET:"worksheet",DASHBOARD:"dashboard",STORY:"story"},eq.TableauEventName={CUSTOM_VIEW_LOAD:"customviewload",CUSTOM_VIEW_REMOVE:"customviewremove",CUSTOM_VIEW_SAVE:"customviewsave",CUSTOM_VIEW_SET_DEFAULT:"customviewsetdefault",FILTER_CHANGE:"filterchange",FIRST_INTERACTIVE:"firstinteractive",FIRST_VIZ_SIZE_KNOWN:"firstvizsizeknown",MARKS_SELECTION:"marksselection",MARKS_HIGHLIGHT:"markshighlight",PARAMETER_VALUE_CHANGE:"parametervaluechange",STORY_POINT_SWITCH:"storypointswitch",TAB_SWITCH:"tabswitch",TOOLBAR_STATE_CHANGE:"toolbarstatechange",URL_ACTION:"urlaction",VIZ_RESIZE:"vizresize"},eq.ToolbarPosition={TOP:"top",BOTTOM:"bottom"},eq.ToolbarButtonName={REDO:"redo",UNDO:"undo"},eQ={},j.tab=j.tab||{},j.tableauSoftware=j.tableauSoftware||{},en.initAssembly(eQ,"Tableau.JavaScript.Vql.Api"),eK=j.tab._ApiBootstrap=en.mkType(eQ,"tab._ApiBootstrap",null,null,{initialize:function e(){tQ._ApiObjectRegistry.registerApiMessageRouter(function(){return new tp})}}),e0=j.tab._CustomViewImpl=en.mkType(eQ,"tab._CustomViewImpl",function(e,t,i){this.$customView=null,this.$presModel=null,this.$workbookImpl=null,this.$messagingOptions=null,this.$name=null,this.$ownerName=null,this.$url=null,this.$isPublic=!1,this.$isDefault=!1,this.$isStale=!1,this.$workbookImpl=e,this.$name=t,this.$messagingOptions=i,this.$isPublic=!1,this.$isDefault=!1,this.$isStale=!1},{get_$customView:function e(){return en.isNullOrUndefined(this.$customView)&&(this.$customView=new tE(this)),this.$customView},get_$workbook:function e(){return this.$workbookImpl.get_workbook()},get_$url:function e(){return this.$url},get_$name:function e(){return this.$name},set_$name:function e(t){if(this.$isStale)throw tQ._TableauException.create("staleDataReference","Stale data");this.$name=t},get_$ownerName:function e(){return this.$ownerName},get_$advertised:function e(){return this.$isPublic},set_$advertised:function e(t){if(this.$isStale)throw tQ._TableauException.create("staleDataReference","Stale data");this.$isPublic=t},get_$isDefault:function e(){return this.$isDefault},saveAsync:function e(){if(this.$isStale||en.isNullOrUndefined(this.$presModel))throw tQ._TableauException.create("staleDataReference","Stale data");this.$presModel.isPublic=this.$isPublic,this.$presModel.name=this.$name;var t=new tQ._Deferred,i={};i["api.customViewParam"]=this.$presModel;var n=e0.$createCustomViewCommandReturnHandler("api.UpdateCustomViewCommand",t,en.mkdel(this,function(e){e0._processCustomViewUpdate(this.$workbookImpl,this.$messagingOptions,e,!0),t.resolve(this.get_$customView())}));return this.$messagingOptions.sendCommand(Object).call(this.$messagingOptions,i,n),t.get_promise()},$removeAsync:function e(){var t=new tQ._Deferred,i={};i["api.customViewParam"]=this.$presModel;var n=e0.$createCustomViewCommandReturnHandler("api.RemoveCustomViewCommand",t,en.mkdel(this,function(e){this.$isStale=!0,e0._processCustomViews(this.$workbookImpl,this.$messagingOptions,e),t.resolve(this.get_$customView())}));return this.$messagingOptions.sendCommand(Object).call(this.$messagingOptions,i,n),t.get_promise()},_showAsync:function e(){if(this.$isStale||en.isNullOrUndefined(this.$presModel))throw tQ._TableauException.create("staleDataReference","Stale data");return e0._showCustomViewAsync(this.$workbookImpl,this.$messagingOptions,this.$presModel)}},{_getAsync:function e(t){var i=new tQ._Deferred;return i.resolve(t.get__customViewImpl().get_$customView()),i.get_promise()},_createNew:function e(t,i,n,r){var a=new e0(t,n.name,i);return a.$isPublic=n.isPublic,a.$url=n.url,a.$ownerName=n.owner.friendlyName,a.$isDefault=en.isValue(r)&&en.unbox(r)===n.id,a.$presModel=n,a},_saveNewAsync:function e(t,i,n){var r=new tQ._Deferred,a={};a["api.customViewName"]=n;var s=e0.$createCustomViewCommandReturnHandler("api.SaveNewCustomViewCommand",r,function(e){e0._processCustomViewUpdate(t,i,e,!0);var n=null;en.isValue(t.get_$updatedCustomViews())&&(n=t.get_$updatedCustomViews().get_item(0)),r.resolve(n)});return i.sendCommand(Object).call(i,a,s),r.get_promise()},_showCustomViewAsync:function e(t,i,n){var r=new tQ._Deferred,a={};en.isValue(n)&&(a["api.customViewParam"]=n);var s=e0.$createCustomViewCommandReturnHandler("api.ShowCustomViewCommand",r,function(e){var i=t.get_activeCustomView();r.resolve(i)});return i.sendCommand(Object).call(i,a,s),r.get_promise()},_makeCurrentCustomViewDefaultAsync:function e(t,i){var n=new tQ._Deferred,r=e0.$createCustomViewCommandReturnHandler("api.MakeCurrentCustomViewDefaultCommand",n,function(e){var i=t.get_activeCustomView();n.resolve(i)});return i.sendCommand(Object).call(i,{},r),n.get_promise()},_getCustomViewsAsync:function e(t,i){var n=new tQ._Deferred,r=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.FetchCustomViewsCommand",0,function(e){e0._processCustomViews(t,i,e),n.resolve(t.get_$customViews()._toApiCollection())},function(e,t){n.reject(tQ._TableauException.create("serverError",t))});return i.sendCommand(Object).call(i,null,r),n.get_promise()},_processCustomViews:function e(t,i,n){e0._processCustomViewUpdate(t,i,n,!1)},_processCustomViewUpdate:function e(t,i,n,r){if(t.set_$currentCustomView(null),t.set_$removedCustomViews(t.get_$customViews()),t.set_$customViews(new tQ._Collection),r&&(t.set_$updatedCustomViews(new tQ._Collection),en.isValue(n.newView)&&e0.$processOneCustomViewUpdate(t,i,n,n.newView,r)),en.isValue(n.customViews))for(var a=0;a<n.customViews.length;a++){var s=n.customViews[a];e0.$processOneCustomViewUpdate(t,i,n,s,r)}},buildCustomViewKeyForDuplicate:function e(t,i){return t+"/"+i},$processOneCustomViewUpdate:function e(t,i,n,r,a){var s=null,o=null;en.isValue(n.currentView)&&(s=n.currentView.name,o=n.currentView.owner.friendlyName);var l=n.defaultCustomViewId,u=e0._createNew(t,i,r,l),c=u.get_$name();t.get_$customViews()._has(c)&&(c=e0.buildCustomViewKeyForDuplicate(u.get_$name(),r.owner.username)),t.get_$customViews()._add(c,u.get_$customView()),t.get_$removedCustomViews()._has(c)?t.get_$removedCustomViews()._remove(c):a&&!t.get_$updatedCustomViews()._has(c)&&t.get_$updatedCustomViews()._add(c,u.get_$customView()),en.isValue(s)&&en.referenceEquals(u.get_$name(),s)&&en.referenceEquals(u.get_$ownerName(),o)&&t.set_$currentCustomView(u.get_$customView())},$createCustomViewCommandReturnHandler:function e(t,i,n){var r=function(e,t){i.reject(tQ._TableauException.create("serverError",t))};return new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))(t,0,n,r)}}),eY=j.tab._DashboardImpl=en.mkType(eQ,"tab._DashboardImpl",function(e,t,i){this.$dashboard=null,this.$worksheets=new tQ._Collection,this.$dashboardObjects=new tQ._Collection,this.$filterCommandsBuilder=new tQ.FilterCommandsBuilder,this.$sharedUtils=new tQ.SharedUtils,e1.call(this,e,t,i)},{get_sheet:function e(){return this.get_dashboard()},get_dashboard:function e(){return en.isNullOrUndefined(this.$dashboard)&&(this.$dashboard=new tV(this)),this.$dashboard},get_worksheets:function e(){return this.$worksheets},get_objects:function e(){return this.$dashboardObjects},$addObjects:function e(t,i){this.$dashboardObjects=new tQ._Collection,this.$worksheets=new tQ._Collection;for(var n=0;n<t.length;n++){var r=t[n],a=null;if("worksheet"===t[n].objectType){var s=r.name;if(en.isNullOrUndefined(s))continue;var o=this.$worksheets.get__length(),l=tQ.SheetSizeFactory.createAutomatic(),u=i(s),c=en.isNullOrUndefined(u),h=c?"":u.getUrl(),m=eX.$ctor(s,"worksheet",o,l,this.get_workbook(),h,!1,c,r.zoneId),d=new te(m,this.get_workbookImpl(),this.get_messagingOptions(),this);a=d.get_worksheet(),this.$worksheets._add(s,d.get_worksheet())}var p=new tN(r,this.get_dashboard(),a);this.$dashboardObjects._add(n.toString(),p)}},$getFiltersAsync:function e(){var t=new tQ._Deferred,i=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.GetDashboardFiltersListCommand",0,en.mkdel(this,function(e){var i=Object.keys(e.filters),n=[],r=en.getEnumerator(i);try{for(;r.moveNext();)for(var a=r.current(),s=0;s<this.get_worksheets().get__length();s++)if(en.referenceEquals(this.get_worksheets().get_item(s)._impl.get_name(),a)){var o={};o.filters=Array.prototype.slice.call(e.filters[a]);var l=o,u=tD.processFiltersList(this.get_worksheets().get_item(s)._impl,l);n=n.concat(u._toApiCollection())}}finally{r.dispose()}t.resolve(n)}),function(e,i){t.reject(tQ._TableauException.createServerError(i))});return this.sendCommand(Object).call(this,{},i),t.get_promise()},$applyFilterAsync:function e(t,i,n,r){this.$verifyActiveDashboard();var a=this.$filterCommandsBuilder.buildApplyFiltersCommandParams(t,i,n,r);a["api.dashboardName"]=this.get_name();var s=new tQ._Deferred,o=this.$filterCommandsBuilder.createFilterCommandReturnHandler("api.ApplyDashboardCategoricalFilterCommand",t,s);return this.sendCommand(Object).call(this,a,o),s.get_promise()},$verifyActiveDashboard:function e(){var t=this.get_isActive(),i=en.isValue(this.get_parentStoryPointImpl())&&this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();if(!t&&!i)throw tQ._TableauException.createNotActiveSheet()}}),eJ=j.tab._DataSourceImpl=en.mkType(eQ,"tab._DataSourceImpl",function(e,t){this.$name=null,this.$fields=new tQ._Collection,this.$isPrimary=!1,this.$dataSource=null,tQ._Param.verifyString(e,"name"),this.$name=e,this.$isPrimary=t},{get_dataSource:function e(){return en.isNullOrUndefined(this.$dataSource)&&(this.$dataSource=new tF(this)),this.$dataSource},get_name:function e(){return this.$name},get_fields:function e(){return this.$fields},get_isPrimary:function e(){return this.$isPrimary},addField:function e(t){this.$fields._add(t.getName(),t)}},{processDataSource:function e(t){for(var i=new eJ(t.name,t.isPrimary),n=en.coalesce(t.fields,[]),r=0;r<n.length;r++){var a=n[r],s=tQ.ApiEnumConverter.convertFieldRole(a.role),o=tQ.ApiEnumConverter.convertFieldAggregation(a.aggregation),l=new tO(i.get_dataSource(),a.name,s,o);i.addField(l)}return i},processDataSourcesForWorksheet:function e(t){for(var i=new tQ._Collection,n=null,r=0;r<t.dataSources.length;r++){var a=t.dataSources[r],s=eJ.processDataSource(a);a.isPrimary?n=s:i._add(a.name,s.get_dataSource())}return en.isValue(n)&&i._addToFirst(n.get_name(),n.get_dataSource()),i}}),e1=j.tab._SheetImpl=en.mkType(eQ,"tab._SheetImpl",function(e,t,i){this.$name=null,this.$index=0,this.$isActive=!1,this.$isHidden=!1,this.$sheetType=null,this.$size=null,this.$url=null,this.$workbookImpl=null,this.$messagingOptions=null,this.$parentStoryPointImpl=null,this.$zoneId=0,tQ._Param.verifyValue(e,"sheetInfoImpl"),tQ._Param.verifyValue(t,"workbookImpl"),tQ._Param.verifyValue(i,"messagingOptions"),this.$name=e.name,this.$index=e.index,this.$isActive=e.isActive,this.$isHidden=e.isHidden,this.$sheetType=e.sheetType,this.$size=e.size,this.$url=e.url,this.$workbookImpl=t,this.$messagingOptions=i,this.$zoneId=e.zoneId},{get_sheet:null,get_name:function e(){return this.$name},get_index:function e(){return this.$index},get_workbookImpl:function e(){return this.$workbookImpl},get_workbook:function e(){return this.$workbookImpl.get_workbook()},get_url:function e(){if(this.$isHidden)throw tQ._TableauException.createNoUrlForHiddenWorksheet();return this.$url},get_size:function e(){return this.$size},get_isHidden:function e(){return this.$isHidden},get_isActive:function e(){return this.$isActive},set_isActive:function e(t){this.$isActive=t},get_isDashboard:function e(){return"dashboard"===this.$sheetType},get_isStory:function e(){return"story"===this.$sheetType},get_sheetType:function e(){return this.$sheetType},get_parentStoryPoint:function e(){return en.isValue(this.$parentStoryPointImpl)?this.$parentStoryPointImpl.get_storyPoint():null},get_parentStoryPointImpl:function e(){return this.$parentStoryPointImpl},set_parentStoryPointImpl:function e(t){if("story"===this.$sheetType)throw tQ._TableauException.createInternalError("A story cannot be a child of another story.");this.$parentStoryPointImpl=t},get_zoneId:function e(){return this.$zoneId},get_messagingOptions:function e(){return this.$messagingOptions},changeSizeAsync:function e(t){if(t=e1.$normalizeSheetSize(t),"worksheet"===this.$sheetType&&"automatic"!==t.behavior)throw tQ._TableauException.createInvalidSizeBehaviorOnWorksheet();var i=new tQ._Deferred;if(this.$size.behavior===t.behavior&&"automatic"===t.behavior)return i.resolve(t),i.get_promise();var n=this.$processSheetSize(t),r={};r["api.setSheetSizeName"]=this.$name,r["api.minWidth"]=n["api.minWidth"],r["api.minHeight"]=n["api.minHeight"],r["api.maxWidth"]=n["api.maxWidth"],r["api.maxHeight"]=n["api.maxHeight"];var a=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.SetSheetSizeCommand",0,en.mkdel(this,function(e){this.get_workbookImpl()._update(en.mkdel(this,function(){var e=this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();i.resolve(e)}))}),function(e,t){i.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,r,a),i.get_promise()},sendCommand:function(e){return function t(i,n){this.$messagingOptions.sendCommand(e).call(this.$messagingOptions,i,n)}},$processSheetSize:function e(t){var i=null;if(en.isNullOrUndefined(t)||en.isNullOrUndefined(t.behavior)||"automatic"!==t.behavior&&en.isNullOrUndefined(t.minSize)&&en.isNullOrUndefined(t.maxSize))throw tQ._TableauException.createInvalidSheetSizeParam();var n=0,r=0,a=0,s=0,o={};if(o["api.minWidth"]=0,o["api.minHeight"]=0,o["api.maxWidth"]=0,o["api.maxHeight"]=0,"automatic"===t.behavior)i=tQ.SheetSize.$ctor("automatic",void 0,void 0);else if("atmost"===t.behavior){if(en.isNullOrUndefined(t.maxSize)||en.isNullOrUndefined(t.maxSize.width)||en.isNullOrUndefined(t.maxSize.height))throw tQ._TableauException.createMissingMaxSize();if(t.maxSize.width<0||t.maxSize.height<0)throw tQ._TableauException.createInvalidSizeValue();o["api.maxWidth"]=t.maxSize.width,o["api.maxHeight"]=t.maxSize.height,i=tQ.SheetSize.$ctor("atmost",void 0,t.maxSize)}else if("atleast"===t.behavior){if(en.isNullOrUndefined(t.minSize)||en.isNullOrUndefined(t.minSize.width)||en.isNullOrUndefined(t.minSize.height))throw tQ._TableauException.createMissingMinSize();if(t.minSize.width<0||t.minSize.height<0)throw tQ._TableauException.createInvalidSizeValue();o["api.minWidth"]=t.minSize.width,o["api.minHeight"]=t.minSize.height,i=tQ.SheetSize.$ctor("atleast",t.minSize,void 0)}else if("range"===t.behavior){if(en.isNullOrUndefined(t.minSize)||en.isNullOrUndefined(t.maxSize)||en.isNullOrUndefined(t.minSize.width)||en.isNullOrUndefined(t.maxSize.width)||en.isNullOrUndefined(t.minSize.height)||en.isNullOrUndefined(t.maxSize.height))throw tQ._TableauException.createMissingMinMaxSize();if(t.minSize.width<0||t.minSize.height<0||t.maxSize.width<0||t.maxSize.height<0||t.minSize.width>t.maxSize.width||t.minSize.height>t.maxSize.height)throw tQ._TableauException.createInvalidRangeSize();o["api.minWidth"]=t.minSize.width,o["api.minHeight"]=t.minSize.height,o["api.maxWidth"]=t.maxSize.width,o["api.maxHeight"]=t.maxSize.height,i=tQ.SheetSize.$ctor("range",t.minSize,t.maxSize)}else if("exactly"===t.behavior){if(en.isValue(t.minSize)&&en.isValue(t.maxSize)&&en.isValue(t.minSize.width)&&en.isValue(t.maxSize.width)&&en.isValue(t.minSize.height)&&en.isValue(t.maxSize.height)){if(n=t.minSize.width,r=t.minSize.height,a=t.maxSize.width,s=t.maxSize.height,n!==a||r!==s)throw tQ._TableauException.createSizeConflictForExactly()}else en.isValue(t.minSize)&&en.isValue(t.minSize.width)&&en.isValue(t.minSize.height)?(n=t.minSize.width,r=t.minSize.height,a=n,s=r):en.isValue(t.maxSize)&&en.isValue(t.maxSize.width)&&en.isValue(t.maxSize.height)&&(a=t.maxSize.width,s=t.maxSize.height,n=a,r=s);o["api.minWidth"]=n,o["api.minHeight"]=r,o["api.maxWidth"]=a,o["api.maxHeight"]=s,i=tQ.SheetSize.$ctor("exactly",tQ.Size.$ctor(n,r),tQ.Size.$ctor(a,s))}return this.$size=i,o}},{$convertValueToIntIfValid:function e(t){return en.isValue(t)?tQ._Utility.toInt(t):t},$normalizeSheetSize:function e(t){var i=tQ.PublicEnums.normalizeEnum(tQ.ApiSheetSizeBehavior).call(null,t.behavior,"size.behavior"),n=t.minSize;en.isValue(n)&&(n=tQ.Size.$ctor(e1.$convertValueToIntIfValid(t.minSize.width),e1.$convertValueToIntIfValid(t.minSize.height)));var r=t.maxSize;return en.isValue(r)&&(r=tQ.Size.$ctor(e1.$convertValueToIntIfValid(t.maxSize.width),e1.$convertValueToIntIfValid(t.maxSize.height))),tQ.SheetSize.$ctor(i,n,r)}}),eX=j.tab._SheetInfoImpl=en.mkType(eQ,"tab._SheetInfoImpl",null,null,{$ctor:function(e,t,i,n,r,a,s,o,l){var u={};return u.name=null,u.index=0,u.workbook=null,u.url=null,u.isHidden=!1,u.sheetType=null,u.zoneId=0,u.size=null,u.isActive=!1,u.name=e,u.sheetType=t,u.index=i,u.size=n,u.workbook=r,u.url=a,u.isActive=s,u.isHidden=o,u.zoneId=l,u},isInstanceOfType:function(){return!0}}),e2=j.tab._StoryImpl=en.mkType(eQ,"tab._StoryImpl",function(e,t,i,n,r){this.$activeStoryPointImpl=null,this.$findSheetFunc=null,this.$story=null,this.$storyPointsInfo=null,this.$2$ActiveStoryPointChangeField=null,e1.call(this,e,t,i),tQ._Param.verifyValue(n,"storyPm"),tQ._Param.verifyValue(r,"findSheetFunc"),this.$findSheetFunc=r,this.update(n)},{add_activeStoryPointChange:function e(t){this.$2$ActiveStoryPointChangeField=en.delegateCombine(this.$2$ActiveStoryPointChangeField,t)},remove_activeStoryPointChange:function e(t){this.$2$ActiveStoryPointChangeField=en.delegateRemove(this.$2$ActiveStoryPointChangeField,t)},get_activeStoryPointImpl:function e(){return this.$activeStoryPointImpl},get_sheet:function e(){return this.get_story()},get_story:function e(){return en.isNullOrUndefined(this.$story)&&(this.$story=new tM(this)),this.$story},get_storyPointsInfo:function e(){return this.$storyPointsInfo},update:function e(t){var i=null,n=null;this.$storyPointsInfo=this.$storyPointsInfo||Array(t.storyPoints.length);for(var r=0;r<t.storyPoints.length;r++){var a=t.storyPoints[r],s=a.caption,o=r===t.activeStoryPointIndex,l=eZ.$ctor(s,r,a.storyPointId,o,a.isUpdated,this);if(en.isNullOrUndefined(this.$storyPointsInfo[r]))this.$storyPointsInfo[r]=new tH(l);else if(this.$storyPointsInfo[r]._impl.storyPointId===l.storyPointId){var u=this.$storyPointsInfo[r]._impl;u.caption=l.caption,u.index=l.index,u.isActive=o,u.isUpdated=l.isUpdated}else this.$storyPointsInfo[r]=new tH(l);o&&(i=a.containedSheetInfo,n=l)}var c=this.$storyPointsInfo.length-t.storyPoints.length;this.$storyPointsInfo.splice(t.storyPoints.length,c);var h=en.isNullOrUndefined(this.$activeStoryPointImpl)||this.$activeStoryPointImpl.get_storyPointId()!==n.storyPointId;en.isValue(this.$activeStoryPointImpl)&&h&&this.$activeStoryPointImpl.set_isActive(!1);var m=this.$activeStoryPointImpl;if(h){var d=e4.createContainedSheet(i,this.get_workbookImpl(),this.get_messagingOptions(),this.$findSheetFunc);this.$activeStoryPointImpl=new e4(n,d)}else this.$activeStoryPointImpl.set_isActive(n.isActive),this.$activeStoryPointImpl.set_isUpdated(n.isUpdated);h&&en.isValue(m)&&this.$raiseActiveStoryPointChange(this.$storyPointsInfo[m.get_index()],this.$activeStoryPointImpl.get_storyPoint())},activatePreviousStoryPointAsync:function e(){return this.$activatePreviousNextStoryPointAsync("api.ActivatePreviousStoryPoint")},activateNextStoryPointAsync:function e(){return this.$activatePreviousNextStoryPointAsync("api.ActivateNextStoryPoint")},activateStoryPointAsync:function e(t){var i=new tQ._Deferred;if(t<0||t>=this.$storyPointsInfo.length)throw tQ._TableauException.createIndexOutOfRange(t);var n={};n["api.storyPointIndex"]=t;var r=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.ActivateStoryPoint",0,en.mkdel(this,function(e){this.$updateActiveState(e),i.resolve(this.$activeStoryPointImpl.get_storyPoint())}),function(e,t){i.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,n,r),i.get_promise()},revertStoryPointAsync:function e(t){if((t=t||this.$activeStoryPointImpl.get_index())<0||t>=this.$storyPointsInfo.length)throw tQ._TableauException.createIndexOutOfRange(t);var i=new tQ._Deferred,n={};n["api.storyPointIndex"]=t;var r=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.RevertStoryPoint",0,en.mkdel(this,function(e){this.$updateStoryPointInfo(t,e),i.resolve(this.$storyPointsInfo[t])}),function(e,t){i.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,n,r),i.get_promise()},$activatePreviousNextStoryPointAsync:function e(t){if("api.ActivatePreviousStoryPoint"!==t&&"api.ActivateNextStoryPoint"!==t)throw tQ._TableauException.createInternalError("commandName '"+t+"' is invalid.");var i=new tQ._Deferred,n=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))(t,0,en.mkdel(this,function(e){this.$updateActiveState(e),i.resolve(this.$activeStoryPointImpl.get_storyPoint())}),function(e,t){i.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,{},n),i.get_promise()},$updateStoryPointInfo:function e(t,i){var n=this.$storyPointsInfo[t]._impl;if(n.storyPointId!==i.storyPointId)throw tQ._TableauException.createInternalError("We should not be updating a story point where the IDs don't match. Existing storyPointID="+n.storyPointId+", newStoryPointID="+i.storyPointId);n.caption=i.caption,n.isUpdated=i.isUpdated,i.storyPointId===this.$activeStoryPointImpl.get_storyPointId()&&this.$activeStoryPointImpl.set_isUpdated(i.isUpdated)},$updateActiveState:function e(t){var i=this.$activeStoryPointImpl,n=t.index;if(i.get_index()!==n){var r=this.$storyPointsInfo[i.get_index()],a=this.$storyPointsInfo[n]._impl,s=e4.createContainedSheet(t.containedSheetInfo,this.get_workbookImpl(),this.get_messagingOptions(),this.$findSheetFunc);a.isActive=!0,this.$activeStoryPointImpl=new e4(a,s),i.set_isActive(!1),r._impl.isActive=!1,this.$raiseActiveStoryPointChange(r,this.$activeStoryPointImpl.get_storyPoint())}},$raiseActiveStoryPointChange:function e(t,i){en.staticEquals(this.$2$ActiveStoryPointChangeField,null)||this.$2$ActiveStoryPointChangeField(t,i)}}),e4=j.tab._StoryPointImpl=en.mkType(eQ,"tab._StoryPointImpl",function(e,t){if(this.$caption=null,this.$index=0,this.$isActive=!1,this.$isUpdated=!1,this.$containedSheetImpl=null,this.$parentStoryImpl=null,this.$storyPoint=null,this.$storyPointId=0,this.$isActive=e.isActive,this.$isUpdated=e.isUpdated,this.$caption=e.caption,this.$index=e.index,this.$parentStoryImpl=e.parentStoryImpl,this.$storyPointId=e.storyPointId,this.$containedSheetImpl=t,en.isValue(t)&&(this.$containedSheetImpl.set_parentStoryPointImpl(this),"dashboard"===t.get_sheetType()))for(var i=en.cast(this.$containedSheetImpl,eY),n=0;n<i.get_worksheets().get__length();n++)i.get_worksheets().get_item(n)._impl.set_parentStoryPointImpl(this)},{get_caption:function e(){return this.$caption},get_containedSheetImpl:function e(){return this.$containedSheetImpl},get_index:function e(){return this.$index},get_isActive:function e(){return this.$isActive},set_isActive:function e(t){this.$isActive=t},get_isUpdated:function e(){return this.$isUpdated},set_isUpdated:function e(t){this.$isUpdated=t},get_parentStoryImpl:function e(){return this.$parentStoryImpl},get_storyPoint:function e(){return en.isNullOrUndefined(this.$storyPoint)&&(this.$storyPoint=new t_(this)),this.$storyPoint},get_storyPointId:function e(){return this.$storyPointId},$toInfoImpl:function e(){return eZ.$ctor(this.$caption,this.$index,this.$storyPointId,this.$isActive,this.$isUpdated,this.$parentStoryImpl)}},{createContainedSheet:function e(t,i,n,r){if(en.isNullOrUndefined(t)||en.isNullOrUndefined(t.name))return null;var a=tQ.ApiEnumConverter.convertSheetType(t.sheetType),s=tQ.SheetSizeFactory.createAutomatic(),o=r(t.name),l=en.isNullOrUndefined(o),u=l?"":o.getUrl(),c=eX.$ctor(t.name,a,-1,s,i.get_workbook(),u,!1,l,t.zoneId);if("worksheet"===t.sheetType)return new te(c,i,n,null);if("dashboard"===t.sheetType){var h=new eY(c,i,n),m=e7.$createDashboardZones(t.dashboardZones);return h.$addObjects(m,r),h}if("story"===t.sheetType)throw tQ._TableauException.createInternalError("Cannot have a story embedded within another story.");throw tQ._TableauException.createInternalError("Unknown sheet type '"+t.sheetType+"'")}}),eZ=j.tab._StoryPointInfoImpl=en.mkType(eQ,"tab._StoryPointInfoImpl",null,null,{$ctor:function(e,t,i,n,r,a){var s={};return s.storyPointId=0,s.parentStoryImpl=null,s.caption=null,s.index=0,s.isActive=!1,s.isUpdated=!1,s.caption=e,s.index=t,s.storyPointId=i,s.isActive=n,s.isUpdated=r,s.parentStoryImpl=a,s},isInstanceOfType:function(){return!0}}),e5=j.tab._ToolbarStateImpl=en.mkType(eQ,"tab._ToolbarStateImpl",function(e,t){this.$toolbarState=null,this.$vizImpl=null,this.$toolbarStatePresModel=null,this.$vizImpl=e,this.$toolbarStatePresModel=t},{get_toolbarState:function e(){return en.isNullOrUndefined(this.$toolbarState)&&(this.$toolbarState=new tL(this)),this.$toolbarState},get_viz:function e(){return this.$vizImpl.get_$viz()},isButtonEnabled:function e(t){switch(t){case"redo":return this.$toolbarStatePresModel.canRedo;case"undo":return this.$toolbarStatePresModel.canUndo;default:throw tQ._TableauException.createInvalidToolbarButtonName(t)}}}),e6=en.mkType(eQ,"tab._VizManagerImpl",null,null,{get_$clonedVizs:function e(){return e6.$vizs.concat()},$registerViz:function e(t){e6.$verifyVizNotAlreadyParented(t),e6.$vizs.push(t)},$unregisterViz:function e(t){for(var i=0,n=e6.$vizs.length;i<n;i++)if(en.referenceEquals(e6.$vizs[i],t)){e6.$vizs.splice(i,1);break}},$sendVisibleRects:function e(){for(var t=0,i=e6.$vizs.length;t<i;t++)e6.$vizs[t]._impl.$sendVisibleRect()},$verifyVizNotAlreadyParented:function e(t){for(var i=t.getParentElement(),n=0,r=e6.$vizs.length;n<r;n++)if(en.referenceEquals(e6.$vizs[n].getParentElement(),i)){var a="Another viz is already present in element '"+tQ._Utility.elementToString(i)+"'.";throw tQ._TableauException.create("vizAlreadyInManager",a)}}}),e3=j.tab._VizParameters=en.mkType(eQ,"tab._VizParameters",function(e,t,i){if(this.name="",this.host_url=null,this.tabs=!1,this.toolbar=!1,this.toolBarPosition=null,this.device=null,this.hostId=null,this.width=null,this.height=null,this.parentElement=null,this.userSuppliedParameters=null,this.staticImageUrl=null,this.fixedSize=!1,this.displayStaticImage=!1,this.$urlFromApi=null,this.$createOptions=null,this.$disableUrlActionsPopups=!1,en.isNullOrUndefined(e)||en.isNullOrUndefined(t))throw tQ._TableauException.create("noUrlOrParentElementNotFound","URL is empty or Parent element not found");en.isNullOrUndefined(i)&&((i={}).hideTabs=!1,i.hideToolbar=!1,i.onFirstInteractive=null),en.isValue(i.height)||en.isValue(i.width)?(this.fixedSize=!0,tQ._Utility.isNumber(i.height)&&(i.height=i.height.toString()+"px"),tQ._Utility.isNumber(i.width)&&(i.width=i.width.toString()+"px"),this.height=en.isValue(i.height)?tQ._Utility.roundVizSizeInPixels(i.height.toString()):null,this.width=en.isValue(i.width)?tQ._Utility.roundVizSizeInPixels(i.width.toString()):null):this.fixedSize=!1,this.displayStaticImage=i.displayStaticImage||!1,this.staticImageUrl=i.staticImageUrl||"",this.tabs=!i.hideTabs,this.toolbar=!i.hideToolbar,this.device=i.device,this.parentElement=e,this.$createOptions=i,this.toolBarPosition=i.toolbarPosition,this.$disableUrlActionsPopups=!0===i.disableUrlActionsPopups;var n=t.split("?");this.$urlFromApi=n[0],2===n.length?this.userSuppliedParameters=n[1]:this.userSuppliedParameters="";var r=RegExp(".*?[^/:]/","").exec(this.$urlFromApi);if(en.isNullOrUndefined(r)||-1===r[0].toLowerCase().indexOf("http://")&&-1===r[0].toLowerCase().indexOf("https://"))throw tQ._TableauException.create("invalidUrl","Invalid url");this.host_url=r[0].toLowerCase(),this.name=this.$urlFromApi.replace(r[0],""),this.name=this.name.replace("views/","")},{get_url:function e(){return this.$constructUrl()},get_baseUrl:function e(){return this.$urlFromApi},$constructUrl:function e(){var t=[];t.push(this.get_baseUrl()),t.push("?"),this.userSuppliedParameters.length>0&&(t.push(this.userSuppliedParameters),t.push("&")),this.fixedSize||-1!==this.userSuppliedParameters.indexOf(":size=")||!(this.parentElement.clientWidth*this.parentElement.clientHeight>0)||(t.push(":size="),t.push(this.parentElement.clientWidth+","+this.parentElement.clientHeight),t.push("&")),-1!==this.userSuppliedParameters.indexOf(":embed=y")||t.push(":embed=y"),t.push("&:showVizHome=n"),t.push("&:jsdebug=y"),this.fixedSize||t.push("&:bootstrapWhenNotified=y"),this.tabs||t.push("&:tabs=n"),this.displayStaticImage&&t.push("&:display_static_image=y"),this.$disableUrlActionsPopups&&t.push("&:disableUrlActionsPopups=y"),this.toolbar?en.isNullOrUndefined(this.toolBarPosition)||(t.push("&:toolbar="),t.push(this.toolBarPosition.toString())):t.push("&:toolbar=n"),en.isValue(this.device)&&(t.push("&:device="),t.push(this.device.toString()));var i=this.$createOptions,n=new en.ObjectEnumerator(i);try{for(;n.moveNext();){var r=n.current();"embed"!==r.key&&"height"!==r.key&&"width"!==r.key&&"device"!==r.key&&"autoSize"!==r.key&&"hideTabs"!==r.key&&"hideToolbar"!==r.key&&"onFirstInteractive"!==r.key&&"onFirstVizSizeKnown"!==r.key&&"toolbarPosition"!==r.key&&"instanceIdToClone"!==r.key&&"navType"!==r.key&&"display_static_image"!==r.key&&"disableUrlActionsPopups"!==r.key&&(t.push("&"),t.push(encodeURIComponent(r.key)),t.push("="),t.push(encodeURIComponent(r.value.toString())))}}finally{n.dispose()}return t.push("&:apiID="+this.hostId),t.push("#"),en.isValue(this.$createOptions.instanceIdToClone)&&t.push(this.$createOptions.instanceIdToClone+"&"),en.isValue(this.$createOptions.navType)&&this.$createOptions.navType.length>0?(t.push("navType="+this.$createOptions.navType.toString()+"&"),t.push("navSrc="+"Opt".toString())):(t.push("navType="+window.performance.navigation.type.toString()+"&"),t.push("navSrc="+"Parse".toString())),t.join("")}}),e7=j.tab._WorkbookImpl=en.mkType(eQ,"tab._WorkbookImpl",function(e,t,i){this.$workbook=null,this.$vizImpl=null,this.$name=null,this.$activeSheetImpl=null,this.$activatingHiddenSheetImpl=null,this.$publishedSheetsInfo=new tQ._Collection,this.$isDownloadAllowed=!1,this.$messagingOptions=null,this.$currentCustomView=null,this.$customViews=new tQ._Collection,this.$updatedCustomViews=new tQ._Collection,this.$removedCustomViews=new tQ._Collection,this.$parameters=null,this.$lastChangedParameterImpl=null,this.$vizImpl=e,this.$messagingOptions=t,this.$getClientInfo(i)},{get_workbook:function e(){return en.isNullOrUndefined(this.$workbook)&&(this.$workbook=new tB(this)),this.$workbook},get_viz:function e(){return this.$vizImpl.get_$viz()},get_publishedSheets:function e(){return this.$publishedSheetsInfo},get_name:function e(){return this.$name},get_activeSheetImpl:function e(){return this.$activeSheetImpl},get_activeCustomView:function e(){return this.$currentCustomView},get_isDownloadAllowed:function e(){return this.$isDownloadAllowed},$findActiveSheetOrSheetWithinActiveDashboard:function e(t){if(en.isNullOrUndefined(this.$activeSheetImpl))return null;var i=e7.$extractSheetName(t);if(en.isNullOrUndefined(i))return null;if(en.referenceEquals(i,this.$activeSheetImpl.get_name()))return this.$activeSheetImpl;if(this.$activeSheetImpl.get_isDashboard()){var n=en.cast(this.$activeSheetImpl,eY).get_worksheets()._get(i);if(en.isValue(n))return n._impl}return null},_setActiveSheetAsync:function e(t){if(tQ._Utility.isNumber(t)){var i=t;if(i<this.$publishedSheetsInfo.get__length()&&i>=0)return this.$activateSheetWithInfoAsync(this.$publishedSheetsInfo.get_item(i).$impl);throw tQ._TableauException.createIndexOutOfRange(i)}var n=e7.$extractSheetName(t),r=this.$publishedSheetsInfo._get(n);if(en.isValue(r))return this.$activateSheetWithInfoAsync(r.$impl);if(this.$activeSheetImpl.get_isDashboard()){var a=en.cast(this.$activeSheetImpl,eY).get_worksheets()._get(n);if(en.isValue(a)){this.$activatingHiddenSheetImpl=null;var s="";return a.getIsHidden()?this.$activatingHiddenSheetImpl=a._impl:s=a._impl.get_url(),this.$activateSheetInternalAsync(a._impl.get_name(),s)}}throw tQ._TableauException.create("sheetNotInWorkbook","Sheet is not found in Workbook")},_revertAllAsync:function e(){var t=new tQ._Deferred,i=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.RevertAllCommand",1,function(e){t.resolve()},function(e,i){t.reject(tQ._TableauException.createServerError(i))});return this.$sendCommand(Object).call(this,null,i),t.get_promise()},_update:function e(t){this.$getClientInfo(t)},$activateSheetWithInfoAsync:function e(t){return this.$activateSheetInternalAsync(t.name,t.url)},$activateSheetInternalAsync:function e(t,i){var n=new tQ._Deferred;if(en.isValue(this.$activeSheetImpl)&&en.referenceEquals(t,this.$activeSheetImpl.get_name()))return n.resolve(this.$activeSheetImpl.get_sheet()),n.get_promise();var r={};r["api.switchToSheetName"]=t,r["api.switchToRepositoryUrl"]=i,r["api.oldRepositoryUrl"]=this.$activeSheetImpl.get_url();var a=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.SwitchActiveSheetCommand",0,en.mkdel(this,function(e){this.$vizImpl.$workbookTabSwitchHandler=en.mkdel(this,function(){this.$vizImpl.$workbookTabSwitchHandler=null,n.resolve(this.$activeSheetImpl.get_sheet())})}),function(e,t){n.reject(tQ._TableauException.createServerError(t))});return this.$sendCommand(Object).call(this,r,a),n.get_promise()},_updateActiveSheetAsync:function e(){var t=new tQ._Deferred,i={};i["api.switchToSheetName"]=this.$activeSheetImpl.get_name(),i["api.switchToRepositoryUrl"]=this.$activeSheetImpl.get_url(),i["api.oldRepositoryUrl"]=this.$activeSheetImpl.get_url();var n=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.UpdateActiveSheetCommand",0,en.mkdel(this,function(e){t.resolve(this.$activeSheetImpl.get_sheet())}),function(e,i){t.reject(tQ._TableauException.createServerError(i))});return this.$sendCommand(Object).call(this,i,n),t.get_promise()},$sendCommand:function(e){return function t(i,n){this.$messagingOptions.sendCommand(e).call(this.$messagingOptions,i,n)}},$getClientInfo:function e(t){var i=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.GetClientInfoCommand",0,en.mkdel(this,function(e){this.$processInfo(e),en.isValue(t)&&t()}),null);this.$sendCommand(Object).call(this,null,i)},$processInfo:function e(t){this.$name=t.workbookName,this.$isDownloadAllowed=t.isDownloadAllowed,this.$vizImpl.$setAreAutomaticUpdatesPaused(!t.isAutoUpdate),this.$vizImpl.set_instanceId(t.instanceId),this.$createSheetsInfo(t),this.$initializeActiveSheet(t)},$initializeActiveSheet:function e(t){var i=t.currentSheetName,n=this.$publishedSheetsInfo._get(i);if(en.isNullOrUndefined(n)&&en.isNullOrUndefined(this.$activatingHiddenSheetImpl))throw tQ._TableauException.createInternalError("The active sheet was not specified in baseSheets");if(!(en.isValue(this.$activeSheetImpl)&&en.referenceEquals(this.$activeSheetImpl.get_name(),i))){if(en.isValue(this.$activeSheetImpl)){this.$activeSheetImpl.set_isActive(!1);var r=this.$publishedSheetsInfo._get(this.$activeSheetImpl.get_name());en.isValue(r)&&(r.$impl.isActive=!1),"story"===this.$activeSheetImpl.get_sheetType()&&en.cast(this.$activeSheetImpl,e2).remove_activeStoryPointChange(en.mkdel(this.$vizImpl,this.$vizImpl.raiseStoryPointSwitch))}if(en.isValue(this.$activatingHiddenSheetImpl)){var a=eX.$ctor(this.$activatingHiddenSheetImpl.get_name(),"worksheet",-1,this.$activatingHiddenSheetImpl.get_size(),this.get_workbook(),"",!0,!0,e1.noZoneId);this.$activatingHiddenSheetImpl=null,this.$activeSheetImpl=new te(a,this,this.$messagingOptions,null)}else{for(var s=null,o=0,l=t.publishedSheets.length;o<l;o++)if(en.referenceEquals(t.publishedSheets[o].name,i)){s=t.publishedSheets[o];break}if(en.isNullOrUndefined(s))throw tQ._TableauException.createInternalError("No base sheet was found corresponding to the active sheet.");var u=en.mkdel(this,function(e){return this.$publishedSheetsInfo._get(e)});if("dashboard"===s.sheetType){var c=new eY(n.$impl,this,this.$messagingOptions);this.$activeSheetImpl=c;var h=e7.$createDashboardZones(t.dashboardZones);c.$addObjects(h,u)}else if("story"===s.sheetType){var m=new e2(n.$impl,this,this.$messagingOptions,t.story,u);this.$activeSheetImpl=m,m.add_activeStoryPointChange(en.mkdel(this.$vizImpl,this.$vizImpl.raiseStoryPointSwitch))}else this.$activeSheetImpl=new te(n.$impl,this,this.$messagingOptions,null);n.$impl.isActive=!0}this.$activeSheetImpl.set_isActive(!0)}},$createSheetsInfo:function e(t){var i=t.publishedSheets;if(!en.isNullOrUndefined(i))for(var n=0;n<i.length;n++){var r=i[n],a=r.name,s=this.$publishedSheetsInfo._get(a),o=e7.$createSheetSize(r);if(en.isNullOrUndefined(s)){var l=en.referenceEquals(a,t.currentSheetName),u=tQ.ApiEnumConverter.convertSheetType(r.sheetType),c=eX.$ctor(a,u,n,o,this.get_workbook(),r.repositoryUrl,l,!1,e1.noZoneId);s=new t$(c),this.$publishedSheetsInfo._add(a,s)}else s.$impl.size=o}},get_$customViews:function e(){return this.$customViews},set_$customViews:function e(t){this.$customViews=t},get_$updatedCustomViews:function e(){return this.$updatedCustomViews},set_$updatedCustomViews:function e(t){this.$updatedCustomViews=t},get_$removedCustomViews:function e(){return this.$removedCustomViews},set_$removedCustomViews:function e(t){this.$removedCustomViews=t},get_$currentCustomView:function e(){return this.$currentCustomView},set_$currentCustomView:function e(t){this.$currentCustomView=t},$getCustomViewsAsync:function e(){return e0._getCustomViewsAsync(this,this.$messagingOptions)},$showCustomViewAsync:function e(t){if(en.isNullOrUndefined(t)||tQ._Utility.isNullOrEmpty(t))return e0._showCustomViewAsync(this,this.$messagingOptions,null);var i=this.$customViews._get(t);if(en.isNullOrUndefined(i)){var n=new tQ._Deferred;return n.reject(tQ._TableauException.createInvalidCustomViewName(t)),n.get_promise()}return i._impl._showAsync()},$removeCustomViewAsync:function e(t){if(tQ._Utility.isNullOrEmpty(t))throw tQ._TableauException.createNullOrEmptyParameter("customViewName");var i=this.$customViews._get(t);if(en.isNullOrUndefined(i)){var n=new tQ._Deferred;return n.reject(tQ._TableauException.createInvalidCustomViewName(t)),n.get_promise()}return i._impl.$removeAsync()},$rememberCustomViewAsync:function e(t){if(tQ._Utility.isNullOrEmpty(t))throw tQ._TableauException.createInvalidParameter("customViewName");return e0._saveNewAsync(this,this.$messagingOptions,t)},$setActiveCustomViewAsDefaultAsync:function e(){return e0._makeCurrentCustomViewDefaultAsync(this,this.$messagingOptions)},get_$lastChangedParameterImpl:function e(){return this.$lastChangedParameterImpl},set_$lastChangedParameterImpl:function e(t){this.$lastChangedParameterImpl=t},get_$parameters:function e(){return this.$parameters},$getSingleParameterAsync:function e(t){var i=new tQ._Deferred;if(en.isValue(this.$lastChangedParameterImpl))return i.resolve(this.$lastChangedParameterImpl.get_$parameter()),i.get_promise();var n=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.FetchParametersCommand",0,en.mkdel(this,function(e){var n=e7.$findAndCreateParameterImpl(t,e);this.$lastChangedParameterImpl=n,i.resolve(n.get_$parameter())}),function(e,t){i.reject(tQ._TableauException.createServerError(t))});return this.$sendCommand(Object).call(this,{},n),i.get_promise()},$getParametersAsync:function e(){var t=new tQ._Deferred,i=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.FetchParametersCommand",0,en.mkdel(this,function(e){this.$parameters=e7.$processParameters(e),t.resolve(this.get_$parameters()._toApiCollection())}),function(e,i){t.reject(tQ._TableauException.createServerError(i))});return this.$sendCommand(Object).call(this,{},i),t.get_promise()},$changeParameterValueAsync:function e(t,i){var n=new tQ._Deferred,r=null;if(en.isValue(this.$parameters)&&(en.isNullOrUndefined(this.$parameters._get(t))||(r=this.$parameters._get(t)._impl,en.isNullOrUndefined(r))))return n.reject(tQ._TableauException.createInvalidParameter(t)),n.get_promise();var a={};if(a["api.setParameterName"]=en.isValue(this.$parameters)?r.get_$name():t,en.isValue(i)&&tQ._Utility.isDate(i)){var s=en.cast(i,en.JsDate),o=tQ._Utility.serializeDateForServer(s);a["api.setParameterValue"]=o}else a["api.setParameterValue"]=en.isValue(i)?i.toString():null;this.$lastChangedParameterImpl=null;var l=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.SetParameterValueCommand",0,en.mkdel(this,function(e){if(en.isNullOrUndefined(e)){n.reject(tQ._TableauException.create("serverError","server error"));return}if(!e.isValidPresModel){n.reject(tQ._TableauException.createInvalidParameter(t));return}var i=new to(e);this.$lastChangedParameterImpl=i,n.resolve(i.get_$parameter())}),function(e,i){n.reject(tQ._TableauException.createInvalidParameter(t))});return this.$sendCommand(Object).call(this,a,l),n.get_promise()}},{$createDashboardZones:function e(t){t=en.coalesce(t,[]);for(var i=[],n=0;n<t.length;n++){var r=t[n],a=tQ.ApiEnumConverter.convertDashboardObjectType(r.zoneType),s=tQ.Size.$ctor(r.width,r.height),o=tQ.Point.$ctor(r.x,r.y),l={name:r.name,objectType:a,position:o,size:s,zoneId:r.zoneId};i.push(l)}return i},$extractSheetName:function e(t){if(en.isNullOrUndefined(t))return null;if(tQ._Utility.isString(t))return t;var i=en.safeCast(t,tU);if(en.isValue(i))return i.getName();var n=en.safeCast(t,t$);return en.isValue(n)?n.getName():null},$createSheetSize:function e(t){return en.isNullOrUndefined(t)?tQ.SheetSizeFactory.createAutomatic():tQ.SheetSizeFactory.fromSizeConstraints(t.sizeConstraints)},$processParameters:function e(t){for(var i=new tQ._Collection,n=0;n<t.parameters.length;n++){var r=t.parameters[n],a=new to(r);i._add(a.get_$name(),a.get_$parameter())}return i},$findAndCreateParameterImpl:function e(t,i){for(var n=0;n<i.parameters.length;n++){var r=i.parameters[n];if(en.referenceEquals(r.name,t))return new to(r)}return null}}),te=j.tab._WorksheetImpl=en.mkType(eQ,"tab._WorksheetImpl",function(e,t,i,n){this.$worksheet=null,this.$parentDashboardImpl=null,this.$getDataCommandsBuilder=new tQ.GetDataCommandsBuilder,this.$filterCommandsBuilder=new tQ.FilterCommandsBuilder,this.$sharedUtils=new tQ.SharedUtils,this.$filters=new tQ._Collection,this.$selectedMarks=new tQ._Collection,this.highlightedMarks=null,e1.call(this,e,t,i),this.$parentDashboardImpl=n},{get_sheet:function e(){return this.get_worksheet()},get_worksheet:function e(){return en.isNullOrUndefined(this.$worksheet)&&(this.$worksheet=new tq(this)),this.$worksheet},get_parentDashboardImpl:function e(){return this.$parentDashboardImpl},get_parentDashboard:function e(){return en.isValue(this.$parentDashboardImpl)?this.$parentDashboardImpl.get_dashboard():null},$getDataSourcesAsync:function e(){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var t=new tQ._Deferred,i={};i["api.worksheetName"]=this.get_name();var n=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.GetDataSourcesCommand",0,function(e){var i=eJ.processDataSourcesForWorksheet(e);t.resolve(i._toApiCollection())},function(e,i){t.reject(tQ._TableauException.createServerError(i))});return this.sendCommand(Object).call(this,i,n),t.get_promise()},$getDataSourceAsync:function e(t){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var i=new tQ._Deferred,n={};n["api.dataSourceName"]=t,n["api.worksheetName"]=this.get_name();var r=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.GetDataSourceCommand",0,function(e){var n=eJ.processDataSource(e);en.isValue(n)?i.resolve(n.get_dataSource()):i.reject(tQ._TableauException.createServerError("Data source '"+t+"' not found"))},function(e,t){i.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,n,r),i.get_promise()},$verifyActiveSheetOrEmbeddedInActiveDashboard:function e(){var t=this.get_isActive(),i=en.isValue(this.$parentDashboardImpl)&&this.$parentDashboardImpl.get_isActive(),n=en.isValue(this.get_parentStoryPointImpl())&&this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();if(!t&&!i&&!n)throw tQ._TableauException.createNotActiveSheet()},$addVisualIdToCommand:function e(t){if(en.isValue(this.get_parentStoryPointImpl())){var i={};i.worksheet=this.get_name(),i.dashboard=en.isValue(this.get_parentDashboardImpl())?this.$parentDashboardImpl.get_name():this.get_name(),i.flipboardZoneId=this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId(),i.storyboard=this.get_parentStoryPointImpl().get_parentStoryImpl().get_name(),i.storyPointId=this.get_parentStoryPointImpl().get_storyPointId(),t["api.visualId"]=i}else{var n=en.isValue(this.get_parentDashboardImpl())?this.get_parentDashboardImpl().get_name():null;this.$sharedUtils.addVisualIdForWorksheet(t,this.get_name(),n)}},get__filters:function e(){return this.$filters},set__filters:function e(t){this.$filters=t},$getFilterAsync:function e(t,i,n){if(!tQ._Utility.isNullOrEmpty(t)&&!tQ._Utility.isNullOrEmpty(i))throw tQ._TableauException.createInternalError("Only fieldName OR fieldCaption is allowed, not both.");n=n||{};var r=new tQ._Deferred,a={};this.$addVisualIdToCommand(a),!tQ._Utility.isNullOrEmpty(i)&&tQ._Utility.isNullOrEmpty(t)&&(a["api.fieldCaption"]=i),tQ._Utility.isNullOrEmpty(t)||(a["api.fieldName"]=t),a["api.filterHierarchicalLevels"]=0,a["api.ignoreDomain"]=n.ignoreDomain||!1,a["api.filterRelevantValuesOnly"]=!!en.isNullOrUndefined(n.relevantValuesOnly)||n.relevantValuesOnly;var s=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.GetOneFilterInfoCommand",0,en.mkdel(this,function(e){var t=te.$filterCommandError(e);if(en.isNullOrUndefined(t)){var i=tD.$createFilter(this,e);r.resolve(i)}else r.reject(t)}),function(e,t){r.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,a,s),r.get_promise()},$getFiltersAsync:function e(t){this.$verifyActiveSheetOrEmbeddedInActiveDashboard(),t=t||{};var i=new tQ._Deferred,n={};this.$addVisualIdToCommand(n),n["api.ignoreDomain"]=t.ignoreDomain||!1,n["api.filterRelevantValuesOnly"]=!!en.isNullOrUndefined(t.relevantValuesOnly)||t.relevantValuesOnly;var r=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.GetFiltersListCommand",0,en.mkdel(this,function(e){this.set__filters(tD.processFiltersList(this,e)),i.resolve(this.get__filters()._toApiCollection())}),function(e,t){i.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,n,r),i.get_promise()},$applyFilterAsync:function e(t,i,n,r){return this.$applyFilterWithValuesInternalAsync(t,i,n,r)},$clearFilterAsync:function e(t){return this.$clearFilterInternalAsync(t)},$getAppliedWorksheetsAsync:function e(t,i){var n=new tQ._Deferred,r=function(e){var t=e,i=[];if(en.isValue(t.sharedFilterWorksheetInfoList))for(var r=0;r<t.sharedFilterWorksheetInfoList.length;r++){var a=t.sharedFilterWorksheetInfoList[r];a.isSelected&&i.push(a.worksheetName)}n.resolve(i)},a=function(e,t){n.reject(tQ._TableauException.createServerError(t))};return this.$getSharedFilterWorksheets(Array).call(this,t,i,r,a),n.get_promise()},$setAppliedWorksheetsAsync:function e(t,i,n,r){if(en.isNullOrUndefined(t))throw tQ._TableauException.createInvalidParameter("Worksheet");var a=new tQ._Deferred;t=this.$getDistinctWorksheets(t);var s=en.mkdel(this,function(e){var i=e,s=new String,o=[],l=[];if(!en.isValue(i.sharedFilterWorksheetInfoList)){a.reject(tQ._TableauException.createServerError("The server returned empty pres model for getAppliedWorksheetsAsync()"));return}for(var u=0;u<i.sharedFilterWorksheetInfoList.length;u++){var c=i.sharedFilterWorksheetInfoList[u];c.isActive&&(s=c.worksheetName),c.isSelected?o.push(c.worksheetName):c.isEnabled&&l.push(c.worksheetName)}if(!en.contains(t,s)){var h=s+" must be included in the applied worksheets";a.reject(tQ._TableauException.createInternalError(h));return}for(var m=0;m<t.length;m++){var d=t[m];if(!en.contains(o,d)&&!en.contains(l,d)){var p="The field "+r+" isn't applicable to the worksheet "+d;a.reject(tQ._TableauException.createInternalError(p));return}}var f={};f["api.fieldName"]=n,f["api.sharedFilterSheets"]=t,this.$addVisualIdToCommand(f);var g=function(e){a.resolve(t)},v=function(e,t){a.reject(tQ._TableauException.createServerError(t))},y=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.SetAppliedWorksheetsCommand",0,g,v);this.sendCommand(Object).call(this,f,y)}),o=function(e,t){a.reject(tQ._TableauException.createServerError(t))};return this.$getSharedFilterWorksheets(Array).call(this,i,n,s,o),a.get_promise()},$getDistinctWorksheets:function e(t){for(var i=new Set,n=[],r=0;r<t.length;r++){var a=t[r];!i.has(a)&&(i.add(a),n.push(a))}return n},$getSharedFilterWorksheets:function(e){return function e(t,i,n,r){var a={};a["api.fieldName"]=i,this.$addVisualIdToCommand(a);var s=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.GetAppliedWorksheetsCommand",0,n,r);this.sendCommand(Object).call(this,a,s)}},$applyRangeFilterAsync:function e(t,i){var n=this.$filterCommandsBuilder.normalizeRangeFilterOption(i);return this.$applyRangeFilterInternalAsync(t,n)},$applyRelativeDateFilterAsync:function e(t,i){var n=this.$filterCommandsBuilder.normalizeRelativeDateFilterOptions(i);return this.$applyRelativeDateFilterInternalAsync(t,n)},$applyHierarchicalFilterAsync:function e(t,i,n,r){if(en.isNullOrUndefined(i)&&"all"!==n)throw tQ._TableauException.createInvalidParameter("values");return this.$applyHierarchicalFilterInternalAsync(t,i,n,r)},$clearFilterInternalAsync:function e(t){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var i=new tQ._Deferred,n=this.$filterCommandsBuilder.buildClearFilterCommandsParam(t);this.$addVisualIdToCommand(n);var r=this.$filterCommandsBuilder.createFilterCommandReturnHandler("api.ClearFilterCommand",t,i);return this.sendCommand(Object).call(this,n,r),i.get_promise()},$applyFilterWithValuesInternalAsync:function e(t,i,n,r){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var a=new tQ._Deferred,s=this.$filterCommandsBuilder.buildApplyFiltersCommandParams(t,i,n,r);this.$addVisualIdToCommand(s);var o=this.$filterCommandsBuilder.createFilterCommandReturnHandler("api.ApplyCategoricalFilterCommand",t,a);return this.sendCommand(Object).call(this,s,o),a.get_promise()},$applyRangeFilterInternalAsync:function e(t,i){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var n=this.$filterCommandsBuilder.buildRangeFilterCommandParams(t,i);this.$addVisualIdToCommand(n);var r=new tQ._Deferred,a=this.$filterCommandsBuilder.createFilterCommandReturnHandler("api.ApplyRangeFilterCommand",t,r);return this.sendCommand(Object).call(this,n,a),r.get_promise()},$applyRelativeDateFilterInternalAsync:function e(t,i){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var n=this.$filterCommandsBuilder.buildRelativeDateFilterCommandParams(t,i);this.$addVisualIdToCommand(n);var r=new tQ._Deferred,a=this.$filterCommandsBuilder.createFilterCommandReturnHandler("api.ApplyRelativeDateFilterCommand",t,r);return this.sendCommand(Object).call(this,n,a),r.get_promise()},$applyHierarchicalFilterInternalAsync:function e(t,i,n,r){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var a=this.$filterCommandsBuilder.buildHierarchicalFilterCommandParams(t,i,n,r);this.$addVisualIdToCommand(a);var s=new tQ._Deferred,o=this.$filterCommandsBuilder.createFilterCommandReturnHandler("api.ApplyHierarchicalFilterCommand",t,s);return this.sendCommand(Object).call(this,a,o),s.get_promise()},get_selectedMarks:function e(){return this.$selectedMarks},set_selectedMarks:function e(t){this.$selectedMarks=t},$clearSelectedMarksAsync:function e(){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var t=new tQ._Deferred,i={};this.$addVisualIdToCommand(i);var n=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.ClearSelectedMarksCommand",0,function(e){t.resolve()},function(e,i){t.reject(tQ._TableauException.createServerError(i))});return this.sendCommand(Object).call(this,i,n),t.get_promise()},$selectMarksAsync:function e(t,i,n){return(this.$verifyActiveSheetOrEmbeddedInActiveDashboard(),en.isNullOrUndefined(t)&&en.isNullOrUndefined(i))?this.$clearSelectedMarksAsync():tQ._Utility.isString(t)&&(tQ._jQueryShim.isArray(i)||tQ._Utility.isString(i)||!tQ.PublicEnums.isValidEnum(tQ.ApiSelectionUpdateType).call(null,i))?this.$selectMarksWithFieldNameAndValueAsync(en.cast(t,String),i,n):tQ._jQueryShim.isArray(t)?this.$selectMarksWithMarksArrayAsync(t,en.cast(i,String)):this.$selectMarksWithMultiDimOptionAsync(t,en.cast(i,String))},$getSelectedMarksAsync:function e(){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var t=new tQ._Deferred,i={};this.$addVisualIdToCommand(i);var n=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.FetchSelectedMarksCommand",0,en.mkdel(this,function(e){this.$selectedMarks=tQ.MarkImpl.processActiveMarks(e),t.resolve(this.$selectedMarks._toApiCollection())}),function(e,i){t.reject(tQ._TableauException.createServerError(i))});return this.sendCommand(Object).call(this,i,n),t.get_promise()},$selectMarksWithFieldNameAndValueAsync:function e(t,i,n){var r=[],a=[],s=[],o=[],l=[],u=[];return this.$parseMarksParam(r,a,s,o,l,u,t,i),this.$selectMarksWithValuesAsync(null,r,a,s,o,l,u,n)},$selectMarksWithMultiDimOptionAsync:function e(t,i){var n=t,r=[],a=[],s=[],o=[],l=[],u=[],c=new en.ObjectEnumerator(n);try{for(;c.moveNext();){var h=c.current();t.hasOwnProperty(h.key)&&!tQ._jQueryShim.isFunction(n[h.key])&&this.$parseMarksParam(r,a,s,o,l,u,h.key,h.value)}}finally{c.dispose()}return this.$selectMarksWithValuesAsync(null,r,a,s,o,l,u,i)},$selectMarksWithMarksArrayAsync:function e(t,i){for(var n=[],r=[],a=[],s=[],o=[],l=[],u=[],c=0;c<t.length;c++){var h=t[c];if(en.isValue(h.impl.get_tupleId())&&h.impl.get_tupleId()>0)u.push(h.impl.get_tupleId());else for(var m=h.impl.get_pairs(),d=0;d<m.get__length();d++){var p=m.get_item(d);p.hasOwnProperty("fieldName")&&p.hasOwnProperty("value")&&!tQ._jQueryShim.isFunction(p.fieldName)&&!tQ._jQueryShim.isFunction(p.value)&&this.$parseMarksParam(n,r,a,s,o,l,p.fieldName,p.value)}}return this.$selectMarksWithValuesAsync(u,n,r,a,s,o,l,i)},$parseMarksParam:function e(t,i,n,r,a,s,o,l){var u=l;if(te.$regexHierarchicalFieldName.test(o))this.$addToParamLists(n,r,o,l);else if(en.isValue(u.min)||en.isValue(u.max)){var c={};if(en.isValue(u.min)){if(tQ._Utility.isDate(u.min)){var h=en.cast(u.min,en.JsDate);if(tQ._Utility.isDateValid(h))c.min=tQ._Utility.serializeDateForServer(h);else throw tQ._TableauException.createInvalidDateParameter("options.min")}else c.min=u.min}if(en.isValue(u.max)){if(tQ._Utility.isDate(u.max)){var m=en.cast(u.max,en.JsDate);if(tQ._Utility.isDateValid(m))c.max=tQ._Utility.serializeDateForServer(m);else throw tQ._TableauException.createInvalidDateParameter("options.max")}else c.max=u.max}if(en.isValue(u.nullOption)){var d=tQ.PublicEnums.normalizeEnum(tQ.ApiNullOption).call(null,u.nullOption,"options.nullOption");c.nullOption=d}else c.nullOption="allValues";var p=JSON.stringify(c);this.$addToParamLists(a,s,o,p)}else this.$addToParamLists(t,i,o,l)},$addToParamLists:function e(t,i,n,r){var a=[];if(tQ._jQueryShim.isArray(r))for(var s=en.cast(r,Array),o=0;o<s.length;o++)a.push(s[o].toString());else a.push(r.toString());i.push(a),t.push(n)},$selectMarksWithValuesAsync:function e(t,i,n,r,a,s,o,l){var u={};if(this.$addVisualIdToCommand(u),l=tQ.PublicEnums.normalizeEnum(tQ.ApiSelectionUpdateType).call(null,l,"updateType"),u["api.filterUpdateType"]=l,tQ._Utility.isNullOrEmpty(t)||(u["api.tupleIds"]=JSON.stringify(t)),!tQ._Utility.isNullOrEmpty(i)&&!tQ._Utility.isNullOrEmpty(n)){u["api.categoricalFieldCaption"]=JSON.stringify(i);for(var c=[],h=0;h<n.length;h++){var m=JSON.stringify(n[h]);c.push(m)}u["api.categoricalMarkValues"]=JSON.stringify(c)}if(!tQ._Utility.isNullOrEmpty(r)&&!tQ._Utility.isNullOrEmpty(a)){u["api.hierarchicalFieldCaption"]=JSON.stringify(r);for(var d=[],p=0;p<a.length;p++){var f=JSON.stringify(a[p]);d.push(f)}u["api.hierarchicalMarkValues"]=JSON.stringify(d)}if(!tQ._Utility.isNullOrEmpty(s)&&!tQ._Utility.isNullOrEmpty(o)){u["api.rangeFieldCaption"]=JSON.stringify(s);for(var g=[],v=0;v<o.length;v++){var y=JSON.stringify(o[v]);g.push(y)}u["api.rangeMarkValues"]=JSON.stringify(g)}if(tQ._Utility.isNullOrEmpty(u["api.tupleIds"])&&tQ._Utility.isNullOrEmpty(u["api.categoricalFieldCaption"])&&tQ._Utility.isNullOrEmpty(u["api.hierarchicalFieldCaption"])&&tQ._Utility.isNullOrEmpty(u["api.rangeFieldCaption"]))throw tQ._TableauException.createInvalidParameter("fieldNameOrFieldValuesMap");var w=new tQ._Deferred,b=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.SelectMarksCommand",0,function(e){var t=te.$createSelectionCommandError(e);en.isNullOrUndefined(t)?w.resolve():w.reject(t)},function(e,t){w.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,u,b),w.get_promise()},$getSummaryDataAsync:function e(t){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var i=new tQ._Deferred,n=this.$getDataCommandsBuilder.getSummaryDataCommandParams(t);this.$addVisualIdToCommand(n);var r=this.$getDataCommandsBuilder.getSummaryDataResponseHandler(i);return this.sendCommand(Object).call(this,n,r),i.get_promise()},$getUnderlyingDataAsync:function e(t){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var i=new tQ._Deferred,n=this.$getDataCommandsBuilder.getUnderlyingDataCommandParams(t);this.$addVisualIdToCommand(n);var r=this.$getDataCommandsBuilder.getUnderlyingDataResponseHandler(i);return this.sendCommand(Object).call(this,n,r),i.get_promise()},$getUnderlyingTablesAsync:function e(){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var t=new tQ._Deferred,i=this.$getDataCommandsBuilder.getUnderlyingTablesCommandParams();this.$addVisualIdToCommand(i);var n=this.$getDataCommandsBuilder.getUnderlyingTablesResponseHandler(t);return this.sendCommand(Object).call(this,i,n),t.get_promise()},$getUnderlyingTableDataAsync:function e(t,i){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var n=new tQ._Deferred,r=this.$getDataCommandsBuilder.getUnderlyingTableDataCommandParams(t,i);this.$addVisualIdToCommand(r);var a=this.$getDataCommandsBuilder.getUnderlyingTableDataResponseHandler(n);return this.sendCommand(Object).call(this,r,a),n.get_promise()},$clearHighlightedMarksAsync:function e(){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var t=new tQ._Deferred,i={};this.$addVisualIdToCommand(i);var n=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.ClearHighlightedMarksCommand",0,function(e){t.resolve()},function(e,i){t.reject(tQ._TableauException.createServerError(i))});return this.sendCommand(Object).call(this,i,n),t.get_promise()},$highlightMarksAsync:function e(t,i){tQ._Param.verifyString(t,"fieldName"),this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var n=new tQ._Deferred,r={};r["api.fieldCaption"]=t,r["api.ObjectTextIDs"]=i,this.$addVisualIdToCommand(r);var a=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.HighlightMarksCommand",0,function(e){n.resolve()},function(e,t){n.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,r,a),n.get_promise()},$highlightMarksByPatternMatchAsync:function e(t,i){tQ._Param.verifyString(t,"fieldName"),tQ._Param.verifyString(i,"patternMatch"),this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var n=new tQ._Deferred,r={};r["api.filterUpdateType"]="replace",r["api.fieldCaption"]=t,r["api.Pattern"]=i,this.$addVisualIdToCommand(r);var a=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.HighlightMarksByPatternMatch",0,function(e){n.resolve()},function(e,t){n.reject(tQ._TableauException.createServerError(t))});return this.sendCommand(Object).call(this,r,a),n.get_promise()},$getHighlightedMarksAsync:function e(){this.$verifyActiveSheetOrEmbeddedInActiveDashboard();var t=new tQ._Deferred,i={};this.$addVisualIdToCommand(i);var n=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.FetchHighlightedMarksCommand",0,en.mkdel(this,function(e){this.highlightedMarks=tQ.MarkImpl.processActiveMarks(e),t.resolve(this.highlightedMarks._toApiCollection())}),function(e,i){t.reject(tQ._TableauException.createServerError(i))});return this.sendCommand(Object).call(this,i,n),t.get_promise()}},{$filterCommandError:function e(t){var i=t;if(en.isValue(i)&&en.isValue(i.errorCode)){var n=en.isValue(i.additionalInformation)?i.additionalInformation.toString():"";switch(i.errorCode){case"invalidFilterFieldName":return tQ._TableauException.create("invalidFilterFieldName",n);case"invalidFilterFieldValue":return tQ._TableauException.create("invalidFilterFieldValue",n);case"invalidAggregationFieldName":return tQ._TableauException.createInvalidAggregationFieldName(n);default:return tQ._TableauException.createServerError(n)}}return null},$createSelectionCommandError:function e(t){var i=t;if(en.isValue(i)&&en.isValue(i.errorCode)){var n=en.isValue(i.additionalInformation)?i.additionalInformation.toString():"";switch(i.errorCode){case"invalidSelectionFieldName":return tQ._TableauException.create("invalidSelectionFieldName",n);case"invalidSelectionValue":return tQ._TableauException.create("invalidSelectionValue",n);case"invalidSelectionDate":return tQ._TableauException.create("invalidSelectionDate",n)}}return null}}),tt=en.mkType(eQ,"tab.$CustomViewEventContext",function(e,t){this.$customViewImpl=null,tu.call(this,e,null),this.$customViewImpl=t},{get__customViewImpl:function e(){return this.$customViewImpl}}),ti=en.mkType(eQ,"tab.$DashboardZoneInfo",null,null,{isInstanceOfType:function(){return!0}}),tn=en.mkType(eQ,"tab.$FilterEventContext",function(e,t,i,n){this.$fieldFieldName=null,this.$filterCaption=null,tu.call(this,e,t),this.$fieldFieldName=i,this.$filterCaption=n},{get__filterFieldName:function e(){return this.$fieldFieldName},get_$filterCaption:function e(){return this.$filterCaption}}),tr=en.mkType(eQ,"tab.$HighlightEventContext",function(e,t){tu.call(this,e,t)}),ta=en.mkType(eQ,"tab.$MarksEventContext",function(e,t){tu.call(this,e,t)}),ts=en.mkType(eQ,"tab.$ParameterEventContext",function(e,t){this.$parameterName=null,tu.call(this,e,null),this.$parameterName=t},{get__parameterName:function e(){return this.$parameterName}}),to=en.mkType(eQ,"tab.$ParameterImpl",function(e){if(this.$parameter=null,this.$name=null,this.$currentValue=null,this.$dataType=null,this.$allowableValuesType=null,this.$allowableValues=null,this.$minValue=null,this.$maxValue=null,this.$stepSize=null,this.$dateStepPeriod=null,this.$name=e.name,this.$currentValue=tQ._Utility.getDataValue(e.currentValue),this.$dataType=tQ.ApiEnumConverter.convertParameterDataType(e.dataType),this.$allowableValuesType=tQ.ApiEnumConverter.convertParameterAllowableValuesType(e.allowableValuesType),en.isValue(e.allowableValues)&&"list"===this.$allowableValuesType){this.$allowableValues=[];for(var t=0;t<e.allowableValues.length;t++){var i=e.allowableValues[t];this.$allowableValues.push(tQ._Utility.getDataValue(i))}}"range"===this.$allowableValuesType&&(this.$minValue=tQ._Utility.getDataValue(e.minValue),this.$maxValue=tQ._Utility.getDataValue(e.maxValue),this.$stepSize=e.stepSize,("date"===this.$dataType||"datetime"===this.$dataType)&&en.isValue(this.$stepSize)&&en.isValue(e.dateStepPeriod)&&(this.$dateStepPeriod=tQ.ApiEnumConverter.convertPeriodType(e.dateStepPeriod)))},{get_$parameter:function e(){return en.isNullOrUndefined(this.$parameter)&&(this.$parameter=new tP(this)),this.$parameter},get_$name:function e(){return this.$name},get_$currentValue:function e(){return this.$currentValue},get_$dataType:function e(){return this.$dataType},get_$allowableValuesType:function e(){return this.$allowableValuesType},get_$allowableValues:function e(){return this.$allowableValues},get_$minValue:function e(){return this.$minValue},get_$maxValue:function e(){return this.$maxValue},get_$stepSize:function e(){return this.$stepSize},get_$dateStepPeriod:function e(){return this.$dateStepPeriod}}),tl=j.tab.CustomViewEvent=en.mkType(eQ,"tab.CustomViewEvent",function(e,t,i){this.$context=null,t8.call(this,e,t),this.$context=new tt(t._impl.get__workbookImpl(),i)},{getCustomViewAsync:function e(){var t=new tQ._Deferred,i=null;return en.isValue(this.$context.get__customViewImpl())&&(i=this.$context.get__customViewImpl().get_$customView()),t.resolve(i),t.get_promise()}}),tu=j.tab.EventContext=en.mkType(eQ,"tab.EventContext",function(e,t){this.$workbookImpl=null,this.$worksheetImpl=null,this.$workbookImpl=e,this.$worksheetImpl=t},{get__workbookImpl:function e(){return this.$workbookImpl},get__worksheetImpl:function e(){return this.$worksheetImpl}}),tc=j.tab.FilterEvent=en.mkType(eQ,"tab.FilterEvent",function(e,t,i,n,r){this.$filterCaption=null,this.$context=null,tk.call(this,e,t,i),this.$filterCaption=r,this.$context=new tn(t._impl.get__workbookImpl(),i,n,r)},{getFieldName:function e(){return this.$filterCaption},getFilterAsync:function e(){return this.$context.get__worksheetImpl().$getFilterAsync(this.$context.get__filterFieldName(),null,null)}}),th=j.tab.FirstVizSizeKnownEvent=en.mkType(eQ,"tab.FirstVizSizeKnownEvent",function(e,t,i){this.$vizSize=null,t8.call(this,e,t),this.$vizSize=i},{getVizSize:function e(){return this.$vizSize}}),tm=j.tab.HighlightEvent=en.mkType(eQ,"tab.HighlightEvent",function(e,t,i){this.$context=null,tk.call(this,e,t,i),this.$context=new tr(t._impl.get__workbookImpl(),i)},{getHighlightedMarksAsync:function e(){return this.$context.get__worksheetImpl().$getHighlightedMarksAsync()}}),td=j.tab.IJsApiMessageHandler=en.mkType(eQ,"tab.IJsApiMessageHandler"),tp=j.tab.JsApiMessageRouter=en.mkType(eQ,"tab.JsApiMessageRouter",function(){this.$customViewLoadCallbacks={},this.$crossDomainMessager=null;var e=en.mkdel(this,function(e,t){this.$handleLegacyNotifications(e,en.cast(t,td))});this.$crossDomainMessager=new tQ.CrossDomainMessager(e)},{registerHandler:function e(t){this.$crossDomainMessager.registerHandler(t),t.add_customViewsListLoad(en.mkdel(this,this.$handleCustomViewsListLoad))},unregisterHandler:function e(t){this.$crossDomainMessager.unregisterHandler(t),t.remove_customViewsListLoad(en.mkdel(this,this.$handleCustomViewsListLoad))},sendCommand:function(e){return function t(i,n,r){if(this.$crossDomainMessager.sendCommand(e).call(this.$crossDomainMessager,i,n,r),"api.ShowCustomViewCommand"===r.get_commandName()){var a=this.$customViewLoadCallbacks[i.get_hostId()];en.isNullOrUndefined(a)&&(a=[],this.$customViewLoadCallbacks[i.get_hostId()]=a),a.push(r)}}},$handleCustomViewsListLoad:function e(t){var i=t.get_hostId(),n=this.$customViewLoadCallbacks[i];if(!en.isNullOrUndefined(n)){for(var r=0;r<n.length;r++){var a=n[r];en.staticEquals(a.get_successCallback(),null)||a.get_successCallback()(null)}delete this.$customViewLoadCallbacks[i]}},$handleLegacyNotifications:function e(t,i){if("layoutInfoReq"===t.get_name())e6.$sendVisibleRects();else if(en.isValue(i)){if("tableau.completed"===t.get_name()||"completed"===t.get_name())i.handleVizLoad();else if("tableau.listening"===t.get_name())i.handleVizListening();else if("sf?"===t.get_name()&&en.count(t.get_parameters())>0){var n=en.getItem(t.get_parameters(),0);i.sendScaleFactor(n)}}}}),tf=j.tab.JsApiMessagingOptions=en.mkType(eQ,"tab.JsApiMessagingOptions",function(e,t){this.$router=null,this.$handler=null,tQ._Param.verifyValue(e,"router"),tQ._Param.verifyValue(t,"handler"),this.$router=e,this.$handler=t},{get_handler:function e(){return this.$handler},get_router:function e(){return this.$router},sendCommand:function(e){return function t(i,n){this.$router.sendCommand(e).call(this.$router,this.$handler,i,n)}},dispose:function e(){this.$router.unregisterHandler(this.$handler)}}),tg=j.tab.MarksEvent=en.mkType(eQ,"tab.MarksEvent",function(e,t,i){this.$context=null,tk.call(this,e,t,i),this.$context=new ta(t._impl.get__workbookImpl(),i)},{getMarksAsync:function e(){var t=this.$context.get__worksheetImpl();return en.isValue(t.get_selectedMarks())?new tQ._Deferred().resolve(t.get_selectedMarks()._toApiCollection()):t.$getSelectedMarksAsync()}}),t9=j.tab.ParameterEvent=en.mkType(eQ,"tab.ParameterEvent",function(e,t,i){this.$context=null,t8.call(this,e,t),this.$context=new ts(t._impl.get__workbookImpl(),i)},{getParameterName:function e(){return this.$context.get__parameterName()},getParameterAsync:function e(){return this.$context.get__workbookImpl().$getSingleParameterAsync(this.$context.get__parameterName())}}),tv=j.tab.StoryPointInfoImplUtil=en.mkType(eQ,"tab.StoryPointInfoImplUtil",null,null,{clone:function e(t){return eZ.$ctor(t.caption,t.index,t.storyPointId,t.isActive,t.isUpdated,t.parentStoryImpl)}}),ty=j.tab.StoryPointSwitchEvent=en.mkType(eQ,"tab.StoryPointSwitchEvent",function(e,t,i,n){this.$oldStoryPointInfo=null,this.$newStoryPoint=null,t8.call(this,e,t),this.$oldStoryPointInfo=i,this.$newStoryPoint=n},{getOldStoryPointInfo:function e(){return this.$oldStoryPointInfo},getNewStoryPoint:function e(){return this.$newStoryPoint}}),t8=j.tab.TableauEvent=en.mkType(eQ,"tab.TableauEvent",function(e,t){this.$viz=null,this.$eventName=null,this.$viz=t,this.$eventName=e},{getViz:function e(){return this.$viz},getEventName:function e(){return this.$eventName}}),tw=j.tab.TabSwitchEvent=en.mkType(eQ,"tab.TabSwitchEvent",function(e,t,i,n){this.$oldName=null,this.$newName=null,t8.call(this,e,t),this.$oldName=i,this.$newName=n},{getOldSheetName:function e(){return this.$oldName},getNewSheetName:function e(){return this.$newName}}),tb=j.tab.ToolbarStateEvent=en.mkType(eQ,"tab.ToolbarStateEvent",function(e,t,i){this.$toolbarStateImpl=null,t8.call(this,e,t),this.$toolbarStateImpl=i},{getToolbarState:function e(){return this.$toolbarStateImpl.get_toolbarState()}}),tS=j.tab.UrlActionEvent=en.mkType(eQ,"tab.UrlActionEvent",function(e,t,i,n){this.$url=null,this.$target=null,t8.call(this,e,t),this.$url=i,this.$target=n},{getUrl:function e(){return this.$url},getTarget:function e(){return this.$target}}),tC=j.tab.VizImpl=en.mkType(eQ,"tab.VizImpl",function(e,t,i,n,r){if(this.$workbookTabSwitchHandler=null,this.$viz=null,this.$iframe=null,this.$staticImage=null,this.$parameters=null,this.$initialAvailableSize=null,this.$instanceId=null,this.$workbookImpl=null,this.$onFirstInteractiveCallback=null,this.$onFirstVizSizeKnownCallback=null,this.$onFirstInteractiveAlreadyCalled=!1,this.$areTabsHidden=!1,this.$isToolbarHidden=!1,this.$areAutomaticUpdatesPaused=!1,this.$messagingOptions=null,this.$vizSize=null,this.$windowResizeHandler=null,this.$initializingWorkbookImpl=!1,this.$1$CustomViewsListLoadField=null,this.$1$StateReadyForQueryField=null,this.$1$MarksSelectionField=null,this.$1$MarksHighlightField=null,this.$1$FilterChangeField=null,this.$1$ParameterValueChangeField=null,this.$1$CustomViewLoadField=null,this.$1$CustomViewSaveField=null,this.$1$CustomViewRemoveField=null,this.$1$CustomViewSetDefaultField=null,this.$1$TabSwitchField=null,this.$1$ToolbarStateChangeField=null,this.$1$StoryPointSwitchField=null,this.$1$VizResizeField=null,this.$1$UrlActionField=null,!tQ._Utility.hasWindowPostMessage()||!tQ._Utility.hasJsonParse())throw tQ._TableauException.createBrowserNotCapable();this.$messagingOptions=new tf(e,this),this.$viz=t,(en.isNullOrUndefined(i)||1!==i.nodeType)&&(i=document.body),this.$parameters=new e3(i,n,r),en.isValue(r)&&(this.$onFirstInteractiveCallback=r.onFirstInteractive,this.$onFirstVizSizeKnownCallback=r.onFirstVizSizeKnown)},{add_customViewsListLoad:function e(t){this.$1$CustomViewsListLoadField=en.delegateCombine(this.$1$CustomViewsListLoadField,t)},remove_customViewsListLoad:function e(t){this.$1$CustomViewsListLoadField=en.delegateRemove(this.$1$CustomViewsListLoadField,t)},add_stateReadyForQuery:function e(t){this.$1$StateReadyForQueryField=en.delegateCombine(this.$1$StateReadyForQueryField,t)},remove_stateReadyForQuery:function e(t){this.$1$StateReadyForQueryField=en.delegateRemove(this.$1$StateReadyForQueryField,t)},add_$marksSelection:function e(t){this.$1$MarksSelectionField=en.delegateCombine(this.$1$MarksSelectionField,t)},remove_$marksSelection:function e(t){this.$1$MarksSelectionField=en.delegateRemove(this.$1$MarksSelectionField,t)},add_$marksHighlight:function e(t){this.$1$MarksHighlightField=en.delegateCombine(this.$1$MarksHighlightField,t)},remove_$marksHighlight:function e(t){this.$1$MarksHighlightField=en.delegateRemove(this.$1$MarksHighlightField,t)},add_$filterChange:function e(t){this.$1$FilterChangeField=en.delegateCombine(this.$1$FilterChangeField,t)},remove_$filterChange:function e(t){this.$1$FilterChangeField=en.delegateRemove(this.$1$FilterChangeField,t)},add_$parameterValueChange:function e(t){this.$1$ParameterValueChangeField=en.delegateCombine(this.$1$ParameterValueChangeField,t)},remove_$parameterValueChange:function e(t){this.$1$ParameterValueChangeField=en.delegateRemove(this.$1$ParameterValueChangeField,t)},add_$customViewLoad:function e(t){this.$1$CustomViewLoadField=en.delegateCombine(this.$1$CustomViewLoadField,t)},remove_$customViewLoad:function e(t){this.$1$CustomViewLoadField=en.delegateRemove(this.$1$CustomViewLoadField,t)},add_$customViewSave:function e(t){this.$1$CustomViewSaveField=en.delegateCombine(this.$1$CustomViewSaveField,t)},remove_$customViewSave:function e(t){this.$1$CustomViewSaveField=en.delegateRemove(this.$1$CustomViewSaveField,t)},add_$customViewRemove:function e(t){this.$1$CustomViewRemoveField=en.delegateCombine(this.$1$CustomViewRemoveField,t)},remove_$customViewRemove:function e(t){this.$1$CustomViewRemoveField=en.delegateRemove(this.$1$CustomViewRemoveField,t)},add_$customViewSetDefault:function e(t){this.$1$CustomViewSetDefaultField=en.delegateCombine(this.$1$CustomViewSetDefaultField,t)},remove_$customViewSetDefault:function e(t){this.$1$CustomViewSetDefaultField=en.delegateRemove(this.$1$CustomViewSetDefaultField,t)},add_$tabSwitch:function e(t){this.$1$TabSwitchField=en.delegateCombine(this.$1$TabSwitchField,t)},remove_$tabSwitch:function e(t){this.$1$TabSwitchField=en.delegateRemove(this.$1$TabSwitchField,t)},add_$toolbarStateChange:function e(t){this.$1$ToolbarStateChangeField=en.delegateCombine(this.$1$ToolbarStateChangeField,t)},remove_$toolbarStateChange:function e(t){this.$1$ToolbarStateChangeField=en.delegateRemove(this.$1$ToolbarStateChangeField,t)},add_$storyPointSwitch:function e(t){this.$1$StoryPointSwitchField=en.delegateCombine(this.$1$StoryPointSwitchField,t)},remove_$storyPointSwitch:function e(t){this.$1$StoryPointSwitchField=en.delegateRemove(this.$1$StoryPointSwitchField,t)},add_$vizResize:function e(t){this.$1$VizResizeField=en.delegateCombine(this.$1$VizResizeField,t)},remove_$vizResize:function e(t){this.$1$VizResizeField=en.delegateRemove(this.$1$VizResizeField,t)},add_$urlAction:function e(t){this.$1$UrlActionField=en.delegateCombine(this.$1$UrlActionField,t)},remove_$urlAction:function e(t){this.$1$UrlActionField=en.delegateRemove(this.$1$UrlActionField,t)},get_hostId:function e(){return this.$parameters.hostId},set_hostId:function e(t){this.$parameters.hostId=t},get_iframe:function e(){return this.$iframe},get_instanceId:function e(){return this.$instanceId},set_instanceId:function e(t){this.$instanceId=t},get_$viz:function e(){return this.$viz},get_$areTabsHidden:function e(){return this.$areTabsHidden},get_$isToolbarHidden:function e(){return this.$isToolbarHidden},get_$isHidden:function e(){return"none"===this.$iframe.style.display},get_$parentElement:function e(){return this.$parameters.parentElement},get_$url:function e(){return this.$parameters.get_baseUrl()},get_$workbook:function e(){return this.$workbookImpl.get_workbook()},get__workbookImpl:function e(){return this.$workbookImpl},get_$areAutomaticUpdatesPaused:function e(){return this.$areAutomaticUpdatesPaused},get_$vizSize:function e(){return this.$vizSize},getCurrentUrlAsync:function e(){var t=new tQ._Deferred,i=new(en.makeGenericType(tQ.CommandReturnHandler$1,[String]))("api.GetCurrentUrlCommand",0,function(e){t.resolve(e)},function(e,i){t.reject(tQ._TableauException.createInternalError(i))});return this._sendCommand(String).call(this,null,i),t.get_promise()},handleVizListening:function e(){this.$enableVisibleRectCommunication()},handleVizLoad:function e(){en.isNullOrUndefined(this.$vizSize)&&(this.$setFrameSize(this.$initialAvailableSize.width+"px",this.$initialAvailableSize.height+"px"),this.$show()),en.isValue(this.$staticImage)&&(this.$staticImage.style.display="none"),en.isNullOrUndefined(this.$workbookImpl)?this.$workbookImpl=new e7(this,this.$messagingOptions,en.mkdel(this,function(){this.$onWorkbookInteractive(null)})):this.$initializingWorkbookImpl||this.$workbookImpl._update(en.mkdel(this,function(){this.$onWorkbookInteractive(null)})),this.sendScaleFactor("-1")},$calculateFrameSize:function e(t){var i,n,r,a,s=this.$vizSize.chromeHeight,o=this.$vizSize.sheetSize,l=0,u=0;if("exactly"===o.behavior)l=o.maxSize.width,u=o.maxSize.height+s;else switch(o.behavior){case"range":i=o.minSize.width,n=o.maxSize.width,r=o.minSize.height+s,a=o.maxSize.height+s,l=Math.max(i,Math.min(n,t.width)),u=Math.max(r,Math.min(a,t.height));break;case"atleast":i=o.minSize.width,r=o.minSize.height+s,l=Math.max(i,t.width),u=Math.max(r,t.height);break;case"atmost":n=o.maxSize.width,a=o.maxSize.height+s,l=Math.min(n,t.width),u=Math.min(a,t.height);break;case"automatic":l=t.width,u=Math.max(t.height,s);break;default:throw tQ._TableauException.createInternalError("Unknown SheetSizeBehavior for viz: "+o.behavior.toString())}return tQ.Size.$ctor(l,u)},$getNewFrameSize:function e(){var t;return en.isValue(this.$initialAvailableSize)?(t=this.$initialAvailableSize,this.$initialAvailableSize=null):t=tQ._Utility.computeContentSize(this.get_$parentElement()),this.$raiseVizResizeEvent(t),this.$calculateFrameSize(t)},$refreshSize:function e(){if(en.isValue(this.$vizSize)){var t=this.$getNewFrameSize();if(t.height!==this.$vizSize.chromeHeight){this.$setFrameSize(t.width+"px",t.height+"px");for(var i=0;i<10;i++){var n=this.$getNewFrameSize();if(en.referenceEquals(JSON.stringify(t),JSON.stringify(n)))return;t=n,this.$setFrameSize(t.width+"px",t.height+"px")}throw tQ._TableauException.create("maxVizResizeAttempts","Viz resize limit hit. The calculated iframe size did not stabilize after 10 resizes.")}}},handleEventNotification:function e(t,i){var n=tQ._ApiServerNotification.deserialize(i);switch(t){case"api.FirstVizSizeKnownEvent":this.$handleFirstVizSizeKnownEvent(n);break;case"api.VizInteractiveEvent":this.$handleVizInteractiveEvent(n);break;case"api.MarksSelectionChangedEvent":this.$handleMarksSelectionChangedEvent(n);break;case"api.MarksHighlightChangedEvent":this.$handleMarksHighlightChangedEvent(n);break;case"api.FilterChangedEvent":this.$handleFilterChangedEvent(n);break;case"api.ParameterChangedEvent":this.$handleParameterChangedEvent(n);break;case"api.CustomViewsListLoadedEvent":this.$handleCustomViewsListLoadedEvent(n);break;case"api.CustomViewUpdatedEvent":this.$handleCustomViewUpdatedEvent(n);break;case"api.CustomViewRemovedEvent":this.$handleCustomViewRemovedEvent();break;case"api.CustomViewSetDefaultEvent":this.$handleCustomViewSetDefaultEvent(n);break;case"api.TabSwitchEvent":this.$handleTabSwitchEvent(n);break;case"api.ToolbarStateChangedEvent":this.$handleToolbarStateChangeEvent(n);break;case"api.StorytellingStateChangedEvent":this.$handleStorytellingStateChangedEvent(n);break;case"api.UrlActionEvent":this.$handleUrlActionEvent(n)}},addEventListener:function e(t,i){var n={};if(!tQ.PublicEnums.tryNormalizeEnum(tQ.ApiTableauEventName).call(null,t,n))throw tQ._TableauException.createUnsupportedEventName(t.toString());switch(n.$){case"marksselection":this.add_$marksSelection(en.cast(i,Function));break;case"markshighlight":this.add_$marksHighlight(en.cast(i,Function));break;case"parametervaluechange":this.add_$parameterValueChange(en.cast(i,Function));break;case"filterchange":this.add_$filterChange(en.cast(i,Function));break;case"customviewload":this.add_$customViewLoad(en.cast(i,Function));break;case"customviewsave":this.add_$customViewSave(en.cast(i,Function));break;case"customviewremove":this.add_$customViewRemove(en.cast(i,Function));break;case"customviewsetdefault":this.add_$customViewSetDefault(en.cast(i,Function));break;case"tabswitch":this.add_$tabSwitch(en.cast(i,Function));break;case"storypointswitch":this.add_$storyPointSwitch(en.cast(i,Function));break;case"toolbarstatechange":this.add_$toolbarStateChange(en.cast(i,Function));break;case"vizresize":this.add_$vizResize(en.cast(i,Function));break;case"urlaction":this.add_$urlAction(en.cast(i,Function))}},removeEventListener:function e(t,i){var n={};if(!tQ.PublicEnums.tryNormalizeEnum(tQ.ApiTableauEventName).call(null,t,n))throw tQ._TableauException.createUnsupportedEventName(t.toString());switch(n.$){case"marksselection":this.remove_$marksSelection(en.cast(i,Function));break;case"markshighlight":this.remove_$marksHighlight(en.cast(i,Function));break;case"parametervaluechange":this.remove_$parameterValueChange(en.cast(i,Function));break;case"filterchange":this.remove_$filterChange(en.cast(i,Function));break;case"customviewload":this.remove_$customViewLoad(en.cast(i,Function));break;case"customviewsave":this.remove_$customViewSave(en.cast(i,Function));break;case"customviewremove":this.remove_$customViewRemove(en.cast(i,Function));break;case"customviewsetdefault":this.remove_$customViewSetDefault(en.cast(i,Function));break;case"tabswitch":this.remove_$tabSwitch(en.cast(i,Function));break;case"toolbarstatechange":this.remove_$toolbarStateChange(en.cast(i,Function));break;case"storypointswitch":this.remove_$storyPointSwitch(en.cast(i,Function));break;case"vizresize":this.remove_$vizResize(en.cast(i,Function));break;case"urlaction":this.remove_$urlAction(en.cast(i,Function))}},$dispose:function e(){en.isValue(this.$iframe)&&(this.$iframe.parentNode.removeChild(this.$iframe),this.$iframe=null),e6.$unregisterViz(this.$viz),this.$messagingOptions.get_router().unregisterHandler(this),this.$removeWindowResizeHandler()},$show:function e(){this.$iframe.style.display="block",this.$iframe.style.visibility="visible"},$hide:function e(){this.$iframe.style.display="none"},$makeInvisible:function e(){this.$iframe.style.visibility="hidden"},$showDownloadDialog:function e(){this.$invokeCommand("showDownloadDialog")},$showExportImageDialog:function e(){this.$invokeCommand("showExportImageDialog")},$showExportDataDialog:function e(t){var i=this.$verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(t);this.$invokeCommand("showExportDataDialog",i)},$showExportCrossTabDialog:function e(t){var i=this.$verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(t);this.$invokeCommand("showExportCrosstabDialog",i)},$showExportPDFDialog:function e(){this.$invokeCommand("showExportPDFDialog")},$showExportPowerPointDialog:function e(){this.$invokeCommand("showExportPowerPointDialog")},$exportCrossTabToExcel:function e(t){var i=this.$verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(t);this.$invokeCommand("exportCrosstabToExcel",i)},$revertAllAsync:function e(){return tQ._Utility.noResultPromiseHelper("api.RevertAllCommand",null,this.$messagingOptions)},$refreshDataAsync:function e(){return tQ._Utility.noResultPromiseHelper("api.RefreshDataCommand",null,this.$messagingOptions)},$showShareDialog:function e(){this.$invokeCommand("showShareDialog")},$showDownloadWorkbookDialog:function e(){if(this.get__workbookImpl().get_isDownloadAllowed())this.$invokeCommand("showDownloadWorkbookDialog");else throw tQ._TableauException.create("downloadWorkbookNotAllowed","Download workbook is not allowed")},$pauseAutomaticUpdatesAsync:function e(){return this.$invokeAutomaticUpdatesCommandAsync("pauseAutomaticUpdates")},$resumeAutomaticUpdatesAsync:function e(){return this.$invokeAutomaticUpdatesCommandAsync("resumeAutomaticUpdates")},$toggleAutomaticUpdatesAsync:function e(){return this.$invokeAutomaticUpdatesCommandAsync("toggleAutomaticUpdates")},$setFrameSizeAndUpdate:function e(t,i){this.$raiseVizResizeEvent(tQ.Size.$ctor(-1,-1)),this.$setFrameSize(t,i),en.isValue(this.$workbookImpl)&&this.$workbookImpl._updateActiveSheetAsync()},$setAreAutomaticUpdatesPaused:function e(t){this.$areAutomaticUpdatesPaused=t},$contentRootElement:function e(){return this.$parameters.parentElement},$create:function e(){try{e6.$registerViz(this.$viz)}catch(t){var i=en.Exception.wrap(t);throw this.$dispose(),i}this.$parameters.fixedSize?(this.$parameters.displayStaticImage&&(this.$staticImage=this.$createStaticImageElement(this.$parameters.width,this.$parameters.height),this.$staticImage.style.display="block"),this.$iframe=this.$createIframe(),this.$show()):(this.$initialAvailableSize=tQ._Utility.computeContentSize(this.get_$parentElement()),(0===this.$initialAvailableSize.width||0===this.$initialAvailableSize.height)&&(this.$initialAvailableSize=tQ.Size.$ctor(800,600)),this.$iframe=this.$createIframe(),this.$makeInvisible(),this.$parameters.displayStaticImage&&(this.$staticImage=this.$createStaticImageElement(this.$initialAvailableSize.width+"px",this.$initialAvailableSize.height+"px"),this.$staticImage.style.display="block")),tQ._Utility.hasWindowPostMessage()||(tQ._Utility.isIE()?this.$iframe.onreadystatechange=this.$getOnCheckForDoneDelegate():this.$iframe.onload=this.$getOnCheckForDoneDelegate()),this.$isToolbarHidden=!this.$parameters.toolbar,this.$areTabsHidden=!this.$parameters.tabs,this.$messagingOptions.get_router().registerHandler(this),this.$iframe.src=this.$parameters.get_url()},$sendVisibleRect:function e(){try{if(!tQ._Utility.hasWindowPostMessage()||en.isNullOrUndefined(this.$iframe)||!en.isValue(this.$iframe.contentWindow))return}catch(t){return}var i=tQ._Utility.visibleContentRectInDocumentCoordinates(this.get_iframe()),n=tQ._Utility.contentRectInDocumentCoordinates(this.get_iframe()),r=new tQ.NonApiCommand("layoutInfoResp",[(i.left-n.left).toString(),(i.top-n.top).toString(),i.width.toString(),i.height.toString()]);this.$iframe.contentWindow.postMessage(r.serialize(),"*")},$enableVisibleRectCommunication:function e(){if(!(!tQ._Utility.hasWindowPostMessage()||en.isNullOrUndefined(this.$iframe))&&en.isValue(this.$iframe.contentWindow)){var t=new tQ.NonApiCommand("tableau.enableVisibleRectCommunication",[]);this.$iframe.contentWindow.postMessage(t.serialize(),"*")}},$redoAsync:function e(){return tQ._Utility.noResultPromiseHelper("api.Redo",null,this.$messagingOptions)},$undoAsync:function e(){return tQ._Utility.noResultPromiseHelper("api.Undo",null,this.$messagingOptions)},sendScaleFactor:function e(t){var i=document.documentElement.clientWidth/window.innerWidth,n=new tQ.NonApiCommand("sf",[t,i.toString(),0..toString(),0..toString()]);en.isValue(this.$iframe)&&en.isValue(this.$iframe.contentWindow)&&this.$iframe.contentWindow.postMessage(n.serialize(),"*")},_sendCommand:function(e){return function t(i,n){this.$messagingOptions.sendCommand(e).call(this.$messagingOptions,i,n)}},$raiseParameterValueChange:function e(t){en.staticEquals(this.$1$ParameterValueChangeField,null)||this.$1$ParameterValueChangeField(new t9("parametervaluechange",this.$viz,t))},$raiseCustomViewLoad:function e(t){this.get__workbookImpl()._update(en.mkdel(this,function(){en.staticEquals(this.$1$CustomViewLoadField,null)||this.$1$CustomViewLoadField(new tl("customviewload",this.$viz,en.isValue(t)?t._impl:null))}))},$raiseCustomViewSave:function e(t){this.get__workbookImpl()._update(en.mkdel(this,function(){en.staticEquals(this.$1$CustomViewSaveField,null)||this.$1$CustomViewSaveField(new tl("customviewsave",this.$viz,t._impl))}))},$raiseCustomViewRemove:function e(t){en.staticEquals(this.$1$CustomViewRemoveField,null)||this.$1$CustomViewRemoveField(new tl("customviewremove",this.$viz,t._impl))},$raiseCustomViewSetDefault:function e(t){en.staticEquals(this.$1$CustomViewSetDefaultField,null)||this.$1$CustomViewSetDefaultField(new tl("customviewsetdefault",this.$viz,t._impl))},$raiseTabSwitch:function e(t,i){en.staticEquals(this.$1$TabSwitchField,null)||this.$1$TabSwitchField(new tw("tabswitch",this.$viz,t,i))},raiseStoryPointSwitch:function e(t,i){en.staticEquals(this.$1$StoryPointSwitchField,null)||this.$1$StoryPointSwitchField(new ty("storypointswitch",this.$viz,t,i))},$raiseStateReadyForQuery:function e(){en.staticEquals(this.$1$StateReadyForQueryField,null)||this.$1$StateReadyForQueryField(this)},$raiseCustomViewsListLoad:function e(){en.staticEquals(this.$1$CustomViewsListLoadField,null)||this.$1$CustomViewsListLoadField(this)},$raiseVizResizeEvent:function e(t){en.staticEquals(this.$1$VizResizeField,null)||this.$1$VizResizeField(new tI("vizresize",this.$viz,t))},$raiseUrlAction:function e(t,i){en.staticEquals(this.$1$UrlActionField,null)||this.$1$UrlActionField(new tS("urlaction",this.$viz,t,i))},$setFrameSize:function e(t,i){this.$parameters.width=t,this.$parameters.height=i,this.$iframe.style.width=this.$parameters.width,this.$iframe.style.height=this.$parameters.height},$verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard:function e(t){if(en.isNullOrUndefined(t))return null;var i=this.$workbookImpl.$findActiveSheetOrSheetWithinActiveDashboard(t);if(en.isNullOrUndefined(i))throw tQ._TableauException.createNotActiveSheet();return i.get_name()},$invokeAutomaticUpdatesCommandAsync:function e(t){if("pauseAutomaticUpdates"!==t&&"resumeAutomaticUpdates"!==t&&"toggleAutomaticUpdates"!==t)throw tQ._TableauException.createInternalError(null);var i={};i["api.invokeCommandName"]=t;var n=new tQ._Deferred,r=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.InvokeCommandCommand",0,en.mkdel(this,function(e){en.isValue(e)&&en.isValue(e.isAutoUpdate)&&(this.$areAutomaticUpdatesPaused=!e.isAutoUpdate),n.resolve(this.$areAutomaticUpdatesPaused)}),function(e,t){n.reject(tQ._TableauException.createServerError(t))});return this._sendCommand(Object).call(this,i,r),n.get_promise()},$invokeCommand:function e(t,i){if("showDownloadDialog"!==t&&"showExportImageDialog"!==t&&"showExportDataDialog"!==t&&"showExportCrosstabDialog"!==t&&"showExportPDFDialog"!==t&&"showShareDialog"!==t&&"showExportPowerPointDialog"!==t&&"exportCrosstabToExcel"!==t&&"showDownloadWorkbookDialog"!==t)throw tQ._TableauException.createInternalError(null);var n={};n["api.invokeCommandName"]=t,en.isValue(i)&&(n["api.invokeCommandParam"]=i);var r=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.InvokeCommandCommand",0,null,null);this._sendCommand(Object).call(this,n,r)},$handleFirstVizSizeKnownEvent:function e(t){var i=JSON.parse(en.cast(t.get_data(),String));this.$handleInitialVizSize(i)},$handleVizInteractiveEvent:function e(t){en.isValue(this.$workbookImpl)&&en.referenceEquals(this.$workbookImpl.get_name(),t.get_workbookName())?this.$onWorkbookInteractive(null):this.$raiseStateReadyForQuery()},$handleMarksSelectionChangedEvent:function e(t){if(!en.staticEquals(this.$1$MarksSelectionField,null)&&en.referenceEquals(this.$workbookImpl.get_name(),t.get_workbookName())){var i=null,n=this.$workbookImpl.get_activeSheetImpl();(n.get_isStory()&&(n=en.cast(n,e2).get_activeStoryPointImpl().get_containedSheetImpl()),en.referenceEquals(n.get_name(),t.get_worksheetName()))?i=en.cast(n,te):n.get_isDashboard()&&(i=en.cast(n,eY).get_worksheets()._get(t.get_worksheetName())._impl),en.isValue(i)&&(i.set_selectedMarks(null),this.$1$MarksSelectionField(new tg("marksselection",this.$viz,i)))}},$handleMarksHighlightChangedEvent:function e(t){if(!en.staticEquals(this.$1$MarksHighlightField,null)&&en.referenceEquals(this.$workbookImpl.get_name(),t.get_workbookName())){var i=null,n=this.$workbookImpl.get_activeSheetImpl();(n.get_isStory()&&(n=en.cast(n,e2).get_activeStoryPointImpl().get_containedSheetImpl()),en.referenceEquals(n.get_name(),t.get_worksheetName()))?i=en.cast(n,te):n.get_isDashboard()&&(i=en.cast(n,eY).get_worksheets()._get(t.get_worksheetName())._impl),en.isValue(i)&&(i.highlightedMarks=null,this.$1$MarksHighlightField(new tm("markshighlight",this.$viz,i)))}},$handleFilterChangedEvent:function e(t){if(!en.staticEquals(this.$1$FilterChangeField,null)&&en.referenceEquals(this.$workbookImpl.get_name(),t.get_workbookName())){var i=null,n=this.$workbookImpl.get_activeSheetImpl();if(en.referenceEquals(n.get_name(),t.get_worksheetName()))i=en.cast(n,te);else if(n.get_isDashboard())i=en.cast(n,eY).get_worksheets()._get(t.get_worksheetName())._impl;else if(n.get_isStory()){var r=en.cast(n,e2).get_activeStoryPointImpl().get_containedSheetImpl();r.get_isDashboard()?i=en.cast(r,eY).get_worksheets()._get(t.get_worksheetName())._impl:en.referenceEquals(r.get_name(),t.get_worksheetName())&&(i=en.cast(r,te))}if(en.isValue(i)){var a=en.cast(JSON.parse(en.cast(t.get_data(),String)),Array),s=a[0],o=a[1];this.$1$FilterChangeField(new tc("filterchange",this.$viz,i,s,o))}}},$handleParameterChangedEvent:function e(t){if(!en.staticEquals(this.$1$ParameterValueChangeField,null)&&en.referenceEquals(this.$workbookImpl.get_name(),t.get_workbookName())){this.$workbookImpl.set_$lastChangedParameterImpl(null);var i=en.cast(t.get_data(),String);this.$raiseParameterValueChange(i)}},$handleCustomViewsListLoadedEvent:function e(t){var i=JSON.parse(en.cast(t.get_data(),String)),n=en.mkdel(this,function(){e0._processCustomViews(this.$workbookImpl,this.$messagingOptions,i)}),r=en.mkdel(this,function(){this.$raiseCustomViewsListLoad(),en.staticEquals(this.$1$CustomViewLoadField,null)||i.customViewLoaded||this.$raiseCustomViewLoad(this.$workbookImpl.get_activeCustomView())});en.isNullOrUndefined(this.$workbookImpl)?(this.$initializingWorkbookImpl=!0,this.$workbookImpl=new e7(this,this.$messagingOptions,en.mkdel(this,function(){n(),this.$onWorkbookInteractive(r),this.$initializingWorkbookImpl=!1}))):(n(),this.$ensureCalledAfterFirstInteractive(r))},$handleCustomViewUpdatedEvent:function e(t){var i=JSON.parse(en.cast(t.get_data(),String));if(en.isNullOrUndefined(this.$workbookImpl)&&(this.$workbookImpl=new e7(this,this.$messagingOptions,null)),en.isValue(this.$workbookImpl)&&e0._processCustomViewUpdate(this.$workbookImpl,this.$messagingOptions,i,!0),!en.staticEquals(this.$1$CustomViewSaveField,null))for(var n=this.$workbookImpl.get_$updatedCustomViews()._toApiCollection(),r=0,a=n.length;r<a;r++)this.$raiseCustomViewSave(n[r])},$handleCustomViewRemovedEvent:function e(){if(!en.staticEquals(this.$1$CustomViewRemoveField,null))for(var t=this.$workbookImpl.get_$removedCustomViews()._toApiCollection(),i=0,n=t.length;i<n;i++)this.$raiseCustomViewRemove(t[i])},$handleCustomViewSetDefaultEvent:function e(t){var i=JSON.parse(en.cast(t.get_data(),String));if(en.isValue(this.$workbookImpl)&&e0._processCustomViews(this.$workbookImpl,this.$messagingOptions,i),!en.staticEquals(this.$1$CustomViewSetDefaultField,null)&&en.isValue(i.defaultCustomViewId))for(var n=this.$workbookImpl.get_$customViews(),r=0;r<n.get__length();r++){var a=n.get_item(r);if(a.getDefault()){this.$raiseCustomViewSetDefault(a);break}}},$handleTabSwitchEvent:function e(t){this.$workbookImpl._update(en.mkdel(this,function(){if(en.isValue(this.$workbookTabSwitchHandler)&&this.$workbookTabSwitchHandler(),en.referenceEquals(this.$workbookImpl.get_name(),t.get_workbookName())){var e=t.get_worksheetName(),i=en.cast(t.get_data(),String);this.$raiseTabSwitch(e,i)}this.$onWorkbookInteractive(null)}))},$handleToolbarStateChangeEvent:function e(t){var i=JSON.parse(en.cast(t.get_data(),String)),n=new e5(this,i);en.staticEquals(this.$1$ToolbarStateChangeField,null)||this.$1$ToolbarStateChangeField(new tb("toolbarstatechange",this.$viz,n))},$handleStorytellingStateChangedEvent:function e(t){var i=en.cast(this.$workbookImpl.get_activeSheetImpl(),e2);"story"===i.get_sheetType()&&i.update(JSON.parse(en.cast(t.get_data(),String)))},$handleUrlActionEvent:function e(t){if(!en.staticEquals(this.$1$UrlActionField,null)){var i=JSON.parse(en.cast(t.get_data(),String));this.$raiseUrlAction(i.url,i.target)}},$onWorkbookInteractive:function e(t){if(!this.$onFirstInteractiveAlreadyCalled){var i=this.$onFirstInteractiveCallback;window.setTimeout(en.mkdel(this,function(){!this.$onFirstInteractiveAlreadyCalled&&(en.staticEquals(i,null)||i(new t8("firstinteractive",this.$viz)),en.staticEquals(t,null)||t(),this.$onFirstInteractiveAlreadyCalled=!0)}),0)}this.$raiseStateReadyForQuery()},$ensureCalledAfterFirstInteractive:function e(t){var i=new Date,n=null;(n=en.mkdel(this,function(){var e=new Date;if(this.$onFirstInteractiveAlreadyCalled)t();else if(e-i>3e5)throw tQ._TableauException.createInternalError("Timed out while waiting for the viz to become interactive");else window.setTimeout(n,10)}))()},$checkForDone:function e(){tQ._Utility.isIE()?"complete"===this.$iframe.readyState&&this.handleVizLoad():this.handleVizLoad()},$onCheckForDone:function e(){window.setTimeout(en.mkdel(this,this.$checkForDone),3e3)},$createStaticImageElement:function e(t,i){var n=document.createElement("div"),r=en.cast(n,en.isValue(n)&&en.isInstanceOfType(n,Element)&&"DIV"===n.tagName);return r.style.background="transparent url('"+this.$parameters.staticImageUrl+"') no-repeat scroll 0 0",r.style.left="8px",r.style.top=this.$parameters.tabs?"31px":"9px",r.style.position="absolute",r.style.width=t,r.style.height=i,this.$contentRootElement().appendChild(r),r},$createIframe:function e(){if(en.isNullOrUndefined(this.$contentRootElement()))return null;var t=document.createElement("IFrame"),i=en.cast(t,en.isValue(t)&&en.isInstanceOfType(t,Element)&&"IFRAME"===t.tagName);return i.frameBorder="0",i.setAttribute("allowTransparency","true"),i.setAttribute("allowFullScreen","true"),i.setAttribute("title",this.$getLocalizedTitle()),i.marginHeight="0",i.marginWidth="0",i.style.display="block",this.$parameters.fixedSize?(i.style.width=this.$parameters.width,i.style.height=this.$parameters.height,i.setAttribute("scrolling","no")):(i.style.width="1px",i.style.height="1px",i.setAttribute("scrolling","no")),tQ._Utility.isSafari()&&i.addEventListener("mousewheel",en.mkdel(this,this.$onIframeMouseWheel),!1),this.$contentRootElement().appendChild(i),i},$getLocalizedTitle:function e(){var t;if("zh-CN"===(t=en.isValue(window.navigator.language)?window.navigator.language:en.isValue(window.navigator.userLanguage)?window.navigator.userLanguage:en.isValue(window.navigator.browserLanguage)?window.navigator.browserLanguage:"en-US"))return"";if("zh-TW"===t)return"";if("en-GB"===t)return"Data Visualisation";switch(t.substr(0,2)){case"fr":return"Visualisation de donn\xe9es";case"es":return"Visualizaci\xf3n de datos";case"it":return"Visualizzazione dati";case"pt":return"Visualiza\xe7\xe3o de dados";case"ja":return" ";case"de":return"Datenvisualisierung";case"ko":return" ";default:return"Data Visualization"}},$onIframeMouseWheel:function e(t){},$getOnCheckForDoneDelegate:function e(){return en.mkdel(this,function(e){this.$onCheckForDone()})},$handleInitialVizSize:function e(t){var i=tQ.SheetSizeFactory.fromSizeConstraints(t.sizeConstraints);this.$vizSize=tT.$ctor(i,t.chromeHeight),en.isValue(this.$onFirstVizSizeKnownCallback)&&this.$onFirstVizSizeKnownCallback(new th("firstvizsizeknown",this.$viz,this.$vizSize)),!this.$parameters.fixedSize&&(this.$refreshSize(),this.$addWindowResizeHandler(),this.$show())},$removeWindowResizeHandler:function e(){!en.isNullOrUndefined(this.$windowResizeHandler)&&(tQ._Utility.hasWindowAddEventListener()?window.removeEventListener("resize",this.$windowResizeHandler,!1):window.self.detachEvent("onresize",this.$windowResizeHandler),this.$windowResizeHandler=null)},$addWindowResizeHandler:function e(){!en.isValue(this.$windowResizeHandler)&&(this.$windowResizeHandler=en.mkdel(this,function(){this.$refreshSize()}),tQ._Utility.hasWindowAddEventListener()?window.addEventListener("resize",this.$windowResizeHandler,!1):window.self.attachEvent("onresize",this.$windowResizeHandler))},switchToViz:function e(t){var i=new tQ._Deferred,n={};n["api.invokeCommandParam"]=t;var r=new(en.makeGenericType(tQ.CommandReturnHandler$1,[Object]))("api.SwitchViz",1,function(e){i.resolve()},function(e,t){i.reject(tQ._TableauException.createServerError(t))});return this.$messagingOptions.sendCommand(Object).call(this.$messagingOptions,n,r),i.get_promise()}}),tI=j.tab.VizResizeEvent=en.mkType(eQ,"tab.VizResizeEvent",function(e,t,i){this.$availableSize=null,t8.call(this,e,t),this.$availableSize=i},{getAvailableSize:function e(){return this.$availableSize}}),tT=j.tab.VizSize=en.mkType(eQ,"tab.VizSize",null,null,{$ctor:function(e,t){var i={};return i.sheetSize=null,i.chromeHeight=0,i.sheetSize=e,i.chromeHeight=t,i},isInstanceOfType:function(){return!0}}),tk=j.tab.WorksheetEvent=en.mkType(eQ,"tab.WorksheetEvent",function(e,t,i){this.$worksheetImpl=null,t8.call(this,e,t),this.$worksheetImpl=i},{getWorksheet:function e(){return this.$worksheetImpl.get_worksheet()}}),tA=j.tableauSoftware.CategoricalFilter=en.mkType(eQ,"tableauSoftware.CategoricalFilter",function(e,t){this.$isExclude=!1,this.$isAllSelected=!1,this.$appliedValues=null,tD.call(this,e,t),this.$initializeFromJson$1(t)},{getIsExcludeMode:function e(){return this.$isExclude},getIsAllSelected:function e(){return this.$isAllSelected},getAppliedValues:function e(){return this.$appliedValues},_updateFromJson:function e(t){this.$initializeFromJson$1(t)},$initializeFromJson$1:function e(t){if(this.$isExclude=t.isExclude,this.$isAllSelected=t.isAllSelected,en.isValue(t.appliedValues)){this.$appliedValues=[];for(var i=0;i<t.appliedValues.length;i++){var n=t.appliedValues[i];this.$appliedValues.push(tQ._Utility.getDataValue(n))}}}}),tE=j.tableauSoftware.CustomView=en.mkType(eQ,"tableauSoftware.CustomView",function(e){this._impl=null,this._impl=e},{getWorkbook:function e(){return this._impl.get_$workbook()},getUrl:function e(){return this._impl.get_$url()},getName:function e(){return this._impl.get_$name()},setName:function e(t){this._impl.set_$name(t)},getOwnerName:function e(){return this._impl.get_$ownerName()},getAdvertised:function e(){return this._impl.get_$advertised()},setAdvertised:function e(t){this._impl.set_$advertised(t)},getDefault:function e(){return this._impl.get_$isDefault()},saveAsync:function e(){return this._impl.saveAsync()}}),tV=j.tableauSoftware.Dashboard=en.mkType(eQ,"tableauSoftware.Dashboard",function(e){this._impl=null,tU.call(this,e)},{getParentStoryPoint:function e(){return this._impl.get_parentStoryPoint()},getObjects:function e(){return this._impl.get_objects()._toApiCollection()},getWorksheets:function e(){return this._impl.get_worksheets()._toApiCollection()},getFiltersAsync:function e(){return this._impl.$getFiltersAsync()},applyFilterAsync:function e(t,i,n,r){return this._impl.$applyFilterAsync(t,i,n,r)}}),tN=j.tableauSoftware.DashboardObject=en.mkType(eQ,"tableauSoftware.DashboardObject",function(e,t,i){if(this.$zoneInfo=null,this.$dashboard=null,this.$worksheet=null,"worksheet"===e.objectType&&en.isNullOrUndefined(i))throw tQ._TableauException.createInternalError("worksheet parameter is required for WORKSHEET objects");if("worksheet"!==e.objectType&&en.isValue(i))throw tQ._TableauException.createInternalError("worksheet parameter should be undefined for non-WORKSHEET objects");this.$zoneInfo=e,this.$dashboard=t,this.$worksheet=i},{getObjectType:function e(){return this.$zoneInfo.objectType},getDashboard:function e(){return this.$dashboard},getWorksheet:function e(){return this.$worksheet},getPosition:function e(){return this.$zoneInfo.position},getSize:function e(){return this.$zoneInfo.size}}),tF=j.tableauSoftware.DataSource=en.mkType(eQ,"tableauSoftware.DataSource",function(e){this.$impl=null,this.$impl=e},{getName:function e(){return this.$impl.get_name()},getFields:function e(){return this.$impl.get_fields()._toApiCollection()},getIsPrimary:function e(){return this.$impl.get_isPrimary()}}),tO=j.tableauSoftware.Field=en.mkType(eQ,"tableauSoftware.Field",function(e,t,i,n){this.$dataSource=null,this.$name=null,this.$fieldRoleType=null,this.$fieldAggrType=null,this.$dataSource=e,this.$name=t,this.$fieldRoleType=i,this.$fieldAggrType=n},{getDataSource:function e(){return this.$dataSource},getName:function e(){return this.$name},getRole:function e(){return this.$fieldRoleType},getAggregation:function e(){return this.$fieldAggrType}}),tD=j.tableauSoftware.Filter=en.mkType(eQ,"tableauSoftware.Filter",function(e,t){this.$worksheetImpl=null,this.$type=null,this.$fieldCaption=null,this.$fieldName=null,this.$field=null,this.$dataSourceName=null,this.$fieldRole=null,this.$fieldAggregation=null,this.$worksheetImpl=e,this.$initializeFromJson(t)},{getFilterType:function e(){return this.$type},getFieldName:function e(){return this.$fieldCaption},getWorksheet:function e(){return this.$worksheetImpl.get_worksheet()},getFieldAsync:function e(){var t=new tQ._Deferred;if(en.isNullOrUndefined(this.$field)){var i=function(e){return t.reject(e),null},n=en.mkdel(this,function(e){return this.$field=new tO(e,this.$fieldCaption,this.$fieldRole,this.$fieldAggregation),t.resolve(this.$field),null});this.$worksheetImpl.$getDataSourceAsync(this.$dataSourceName).then(n,i)}else window.setTimeout(en.mkdel(this,function(){t.resolve(this.$field)}),0);return t.get_promise()},getAppliedWorksheetsAsync:function e(){return this.$worksheetImpl.$getAppliedWorksheetsAsync(this.getWorksheet().getName(),this.$fieldName)},setAppliedWorksheetsAsync:function e(t){return this.$worksheetImpl.$setAppliedWorksheetsAsync(t,this.getWorksheet().getName(),this.$fieldName,this.$fieldCaption)},_update:function e(t){this.$initializeFromJson(t),this._updateFromJson(t)},_addFieldParams:function e(t){},_updateFromJson:null,$initializeFromJson:function e(t){this.$fieldName=t.fieldName,this.$fieldCaption=t.caption,this.$type=tQ.ApiEnumConverter.convertFilterType(t.filterType),this.$field=null,this.$dataSourceName=t.dataSourceName,this.$fieldRole=tQ.ApiEnumConverter.convertFieldRole(en.coalesce(t.fieldRole,"unknown")),this.$fieldAggregation=tQ.ApiEnumConverter.convertFieldAggregation(en.coalesce(t.fieldAggregation,"NONE"))}},{$createFilter:function e(t,i){switch(i.filterType){case"categorical":return new tA(t,i);case"relativedate":return new tx(t,i);case"hierarchical":return new tR(t,i);case"quantitative":return new tz(t,i)}return null},processFiltersList:function e(t,i){for(var n=new tQ._Collection,r=0;r<i.filters.length;r++){var a=i.filters[r];n._has(a.caption)||n._add(a.caption,a.caption)}for(var s=new tQ._Collection,o=0;o<i.filters.length;o++){var l=i.filters[o],u=tD.$createFilter(t,l);if(!s._has(l.caption)){s._add(l.caption,u);continue}for(var c=l.caption.toString()+"_"+l.filterType.toString(),h=c,m=1;n._has(h);)h=c+"_"+m,m++;s._add(h,u)}return s}}),tR=j.tableauSoftware.HierarchicalFilter=en.mkType(eQ,"tableauSoftware.HierarchicalFilter",function(e,t){this.$levels=0,tD.call(this,e,t),this.$initializeFromJson$1(t)},{_addFieldParams:function e(t){t["api.filterHierarchicalLevels"]=this.$levels},_updateFromJson:function e(t){this.$initializeFromJson$1(t)},$initializeFromJson$1:function e(t){this.$levels=t.levels}}),tP=j.tableauSoftware.Parameter=en.mkType(eQ,"tableauSoftware.Parameter",function(e){this._impl=null,this._impl=e},{getName:function e(){return this._impl.get_$name()},getCurrentValue:function e(){return this._impl.get_$currentValue()},getDataType:function e(){return this._impl.get_$dataType()},getAllowableValuesType:function e(){return this._impl.get_$allowableValuesType()},getAllowableValues:function e(){return this._impl.get_$allowableValues()},getMinValue:function e(){return this._impl.get_$minValue()},getMaxValue:function e(){return this._impl.get_$maxValue()},getStepSize:function e(){return this._impl.get_$stepSize()},getDateStepPeriod:function e(){return this._impl.get_$dateStepPeriod()}}),tz=j.tableauSoftware.QuantitativeFilter=en.mkType(eQ,"tableauSoftware.QuantitativeFilter",function(e,t){this.$domainMin=null,this.$domainMax=null,this.$min=null,this.$max=null,this.$includeNullValues=!1,tD.call(this,e,t),this.$initializeFromJson$1(t)},{getMin:function e(){return this.$min},getMax:function e(){return this.$max},getIncludeNullValues:function e(){return this.$includeNullValues},getDomainMin:function e(){return this.$domainMin},getDomainMax:function e(){return this.$domainMax},_updateFromJson:function e(t){this.$initializeFromJson$1(t)},$initializeFromJson$1:function e(t){this.$domainMin=tQ._Utility.getDataValue(t.domainMinValue),this.$domainMax=tQ._Utility.getDataValue(t.domainMaxValue),this.$min=tQ._Utility.getDataValue(t.minValue),this.$max=tQ._Utility.getDataValue(t.maxValue),this.$includeNullValues=t.includeNullValues}}),tx=j.tableauSoftware.RelativeDateFilter=en.mkType(eQ,"tableauSoftware.RelativeDateFilter",function(e,t){this.$periodType=null,this.$rangeType=null,this.$rangeN=0,tD.call(this,e,t),this.$initializeFromJson$1(t)},{getPeriod:function e(){return this.$periodType},getRange:function e(){return this.$rangeType},getRangeN:function e(){return this.$rangeN},_updateFromJson:function e(t){this.$initializeFromJson$1(t)},$initializeFromJson$1:function e(t){en.isValue(t.periodType)&&(this.$periodType=tQ.ApiEnumConverter.convertPeriodType(en.unbox(t.periodType))),en.isValue(t.rangeType)&&(this.$rangeType=tQ.ApiEnumConverter.convertDateRange(en.unbox(t.rangeType))),en.isValue(t.rangeN)&&(this.$rangeN=en.unbox(t.rangeN))}}),tU=j.tableauSoftware.Sheet=en.mkType(eQ,"tableauSoftware.Sheet",function(e){this._impl=null,tQ._Param.verifyValue(e,"sheetImpl"),this._impl=e},{getName:function e(){return this._impl.get_name()},getIndex:function e(){return this._impl.get_index()},getWorkbook:function e(){return this._impl.get_workbookImpl().get_workbook()},getSize:function e(){return this._impl.get_size()},getIsHidden:function e(){return this._impl.get_isHidden()},getIsActive:function e(){return this._impl.get_isActive()},getSheetType:function e(){return this._impl.get_sheetType()},getUrl:function e(){return this._impl.get_url()},changeSizeAsync:function e(t){return this._impl.changeSizeAsync(t)}}),t$=j.tableauSoftware.SheetInfo=en.mkType(eQ,"tableauSoftware.SheetInfo",function(e){this.$impl=null,this.$impl=e},{getName:function e(){return this.$impl.name},getSheetType:function e(){return this.$impl.sheetType},getSize:function e(){return this.$impl.size},getIndex:function e(){return this.$impl.index},getUrl:function e(){return this.$impl.url},getIsActive:function e(){return this.$impl.isActive},getIsHidden:function e(){return this.$impl.isHidden},getWorkbook:function e(){return this.$impl.workbook}}),tM=j.tableauSoftware.Story=en.mkType(eQ,"tableauSoftware.Story",function(e){this._impl=null,tU.call(this,e)},{getActiveStoryPoint:function e(){return this._impl.get_activeStoryPointImpl().get_storyPoint()},getStoryPointsInfo:function e(){return this._impl.get_storyPointsInfo()},activatePreviousStoryPointAsync:function e(){return this._impl.activatePreviousStoryPointAsync()},activateNextStoryPointAsync:function e(){return this._impl.activateNextStoryPointAsync()},activateStoryPointAsync:function e(t){return this._impl.activateStoryPointAsync(t)},revertStoryPointAsync:function e(t){return this._impl.revertStoryPointAsync(t)}}),t_=j.tableauSoftware.StoryPoint=en.mkType(eQ,"tableauSoftware.StoryPoint",function(e){this.$impl=null,this.$impl=e},{getCaption:function e(){return this.$impl.get_caption()},getContainedSheet:function e(){return en.isValue(this.$impl.get_containedSheetImpl())?this.$impl.get_containedSheetImpl().get_sheet():null},getIndex:function e(){return this.$impl.get_index()},getIsActive:function e(){return this.$impl.get_isActive()},getIsUpdated:function e(){return this.$impl.get_isUpdated()},getParentStory:function e(){return this.$impl.get_parentStoryImpl().get_story()}}),tH=j.tableauSoftware.StoryPointInfo=en.mkType(eQ,"tableauSoftware.StoryPointInfo",function(e){this._impl=null,this._impl=e},{getCaption:function e(){return this._impl.caption},getIndex:function e(){return this._impl.index},getIsActive:function e(){return this._impl.isActive},getIsUpdated:function e(){return this._impl.isUpdated},getParentStory:function e(){return this._impl.parentStoryImpl.get_story()}}),tL=j.tableauSoftware.ToolbarState=en.mkType(eQ,"tableauSoftware.ToolbarState",function(e){this._impl=null,this._impl=e},{getViz:function e(){return this._impl.get_viz()},isButtonEnabled:function e(t){return this._impl.isButtonEnabled(t)}}),tW=j.tableauSoftware.Version=en.mkType(eQ,"tableauSoftware.Version",function(e,t,i,n){this.$major=0,this.$minor=0,this.$patch=0,this.$metadata=null,this.$major=e,this.$minor=t,this.$patch=i,this.$metadata=en.coalesce(n,null)},{getMajor:function e(){return this.$major},getMinor:function e(){return this.$minor},getPatch:function e(){return this.$patch},getMetadata:function e(){return this.$metadata},toString:function e(){var t=this.$major+"."+this.$minor+"."+this.$patch;return en.isValue(this.$metadata)&&this.$metadata.length>0&&(t+="-"+this.$metadata),t}},{getCurrent:function e(){return tW.$currentVersion}}),tj=j.tableauSoftware.Viz=en.mkType(eQ,"tableauSoftware.Viz",function(e,t,i){this._impl=null;var n=tQ._ApiObjectRegistry.getApiMessageRouter();this._impl=new tC(n,this,e,t,i),this._impl.$create()},{getAreTabsHidden:function e(){return this._impl.get_$areTabsHidden()},getIsToolbarHidden:function e(){return this._impl.get_$isToolbarHidden()},getIsHidden:function e(){return this._impl.get_$isHidden()},getInstanceId:function e(){return this._impl.get_instanceId()},getParentElement:function e(){return this._impl.get_$parentElement()},getUrl:function e(){return this._impl.get_$url()},getVizSize:function e(){return this._impl.get_$vizSize()},getWorkbook:function e(){return this._impl.get_$workbook()},getAreAutomaticUpdatesPaused:function e(){return this._impl.get_$areAutomaticUpdatesPaused()},getCurrentUrlAsync:function e(){return this._impl.getCurrentUrlAsync()},addEventListener:function e(t,i){this._impl.addEventListener(t,i)},removeEventListener:function e(t,i){this._impl.removeEventListener(t,i)},dispose:function e(){this._impl.$dispose()},switchToViz:function e(t){return this._impl.switchToViz(t)},show:function e(){this._impl.$show()},hide:function e(){this._impl.$hide()},showExportDataDialog:function e(t){this._impl.$showExportDataDialog(t)},showDownloadDialog:function e(){this._impl.$showDownloadDialog()},showExportCrossTabDialog:function e(t){this._impl.$showExportCrossTabDialog(t)},showExportImageDialog:function e(){this._impl.$showExportImageDialog()},showExportPDFDialog:function e(){this._impl.$showExportPDFDialog()},showExportPowerPointDialog:function e(){this._impl.$showExportPowerPointDialog()},exportCrossTabToExcel:function e(t){this._impl.$exportCrossTabToExcel(t)},revertAllAsync:function e(){return this._impl.$revertAllAsync()},refreshDataAsync:function e(){return this._impl.$refreshDataAsync()},showShareDialog:function e(){this._impl.$showShareDialog()},showDownloadWorkbookDialog:function e(){this._impl.$showDownloadWorkbookDialog()},pauseAutomaticUpdatesAsync:function e(){return this._impl.$pauseAutomaticUpdatesAsync()},resumeAutomaticUpdatesAsync:function e(){return this._impl.$resumeAutomaticUpdatesAsync()},toggleAutomaticUpdatesAsync:function e(){return this._impl.$toggleAutomaticUpdatesAsync()},refreshSize:function e(){this._impl.$refreshSize()},setFrameSize:function e(t,i){var n=t,r=i;tQ._Utility.isNumber(t)&&(n=t.toString()+"px"),tQ._Utility.isNumber(i)&&(r=i.toString()+"px"),this._impl.$setFrameSizeAndUpdate(n,r)},redoAsync:function e(){return this._impl.$redoAsync()},undoAsync:function e(){return this._impl.$undoAsync()}},{getLastRequestMessage:function e(){return tQ._ApiCommand.lastRequestMessage},getLastResponseMessage:function e(){return tQ._ApiCommand.lastResponseMessage},getLastClientInfoResponseMessage:function e(){return tQ._ApiCommand.lastClientInfoResponseMessage}}),tG=j.tableauSoftware.VizManager=en.mkType(eQ,"tableauSoftware.VizManager",null,null,{getVizs:function e(){return e6.get_$clonedVizs()}}),tB=j.tableauSoftware.Workbook=en.mkType(eQ,"tableauSoftware.Workbook",function(e){this.$workbookImpl=null,this.$workbookImpl=e},{getViz:function e(){return this.$workbookImpl.get_viz()},getPublishedSheetsInfo:function e(){return this.$workbookImpl.get_publishedSheets()._toApiCollection()},getName:function e(){return this.$workbookImpl.get_name()},getActiveSheet:function e(){return this.$workbookImpl.get_activeSheetImpl().get_sheet()},getActiveCustomView:function e(){return this.$workbookImpl.get_activeCustomView()},activateSheetAsync:function e(t){return this.$workbookImpl._setActiveSheetAsync(t)},revertAllAsync:function e(){return this.$workbookImpl._revertAllAsync()},getCustomViewsAsync:function e(){return this.$workbookImpl.$getCustomViewsAsync()},showCustomViewAsync:function e(t){return this.$workbookImpl.$showCustomViewAsync(t)},removeCustomViewAsync:function e(t){return this.$workbookImpl.$removeCustomViewAsync(t)},rememberCustomViewAsync:function e(t){return this.$workbookImpl.$rememberCustomViewAsync(t)},setActiveCustomViewAsDefaultAsync:function e(){return this.$workbookImpl.$setActiveCustomViewAsDefaultAsync()},getParametersAsync:function e(){return this.$workbookImpl.$getParametersAsync()},changeParameterValueAsync:function e(t,i){return this.$workbookImpl.$changeParameterValueAsync(t,i)}}),tq=j.tableauSoftware.Worksheet=en.mkType(eQ,"tableauSoftware.Worksheet",function(e){this._impl=null,tU.call(this,e)},{getParentDashboard:function e(){return this._impl.get_parentDashboard()},getParentStoryPoint:function e(){return this._impl.get_parentStoryPoint()},getDataSourcesAsync:function e(){return this._impl.$getDataSourcesAsync()},getFilterAsync:function e(t,i){return this._impl.$getFilterAsync(null,t,i)},getFiltersAsync:function e(t){return this._impl.$getFiltersAsync(t)},applyFilterAsync:function e(t,i,n,r){return this._impl.$applyFilterAsync(t,i,n,r)},clearFilterAsync:function e(t){return this._impl.$clearFilterAsync(t)},applyRangeFilterAsync:function e(t,i){return this._impl.$applyRangeFilterAsync(t,i)},applyRelativeDateFilterAsync:function e(t,i){return this._impl.$applyRelativeDateFilterAsync(t,i)},applyHierarchicalFilterAsync:function e(t,i,n,r){return this._impl.$applyHierarchicalFilterAsync(t,i,n,r)},clearSelectedMarksAsync:function e(){return this._impl.$clearSelectedMarksAsync()},selectMarksAsync:function e(t,i,n){return this._impl.$selectMarksAsync(t,i,n)},getSelectedMarksAsync:function e(){return this._impl.$getSelectedMarksAsync()},getSummaryDataAsync:function e(t){return this._impl.$getSummaryDataAsync(t)},getUnderlyingDataAsync:function e(t){return console.warn("Method getUnderlyingDataAsync is deprecated. Please use getUnderlyingTableDataAsync instead."),this._impl.$getUnderlyingDataAsync(t)},getUnderlyingTablesAsync:function e(){return this._impl.$getUnderlyingTablesAsync()},getUnderlyingTableDataAsync:function e(t,i){return this._impl.$getUnderlyingTableDataAsync(t,i)},clearHighlightedMarksAsync:function e(){return this._impl.$clearHighlightedMarksAsync()},highlightMarksAsync:function e(t,i){return this._impl.$highlightMarksAsync(t,i)},highlightMarksByPatternMatchAsync:function e(t,i){return this._impl.$highlightMarksByPatternMatchAsync(t,i)},getHighlightedMarksAsync:function e(){return this._impl.$getHighlightedMarksAsync()}}),en.initClass(eK),en.initClass(e0),en.initClass(e1),en.initClass(eY,e1),en.initClass(eJ),en.initClass(eX,Object),en.initClass(e2,e1),en.initClass(e4),en.initClass(eZ,Object),en.initClass(e5),en.initClass(e6),en.initClass(e3),en.initClass(e7),en.initClass(te,e1),en.initClass(tu),en.initClass(tt,tu),en.initClass(ti),en.initClass(tn,tu),en.initClass(tr,tu),en.initClass(ta,tu),en.initClass(ts,tu),en.initClass(to),en.initClass(t8),en.initClass(tl,t8),en.initClass(tk,t8),en.initClass(tc,tk),en.initClass(th,t8),en.initClass(tm,tk),en.initInterface(td,{add_customViewsListLoad:null,remove_customViewsListLoad:null,handleVizLoad:null,handleVizListening:null,sendScaleFactor:null}),en.initClass(tp),en.initClass(tf),en.initClass(tg,tk),en.initClass(t9,t8),en.initClass(tv),en.initClass(ty,t8),en.initClass(tw,t8),en.initClass(tb,t8),en.initClass(tS,t8),en.initClass(tC,null,[td]),en.initClass(tI,t8),en.initClass(tT,Object),en.initClass(tD),en.initClass(tA,tD),en.initClass(tE),en.initClass(tU),en.initClass(tV,tU),en.initClass(tN),en.initClass(tF),en.initClass(tO),en.initClass(tR,tD),en.initClass(tP),en.initClass(tz,tD),en.initClass(tx,tD),en.initClass(t$),en.initClass(tM,tU),en.initClass(t_),en.initClass(tH),en.initClass(tL),en.initClass(tW),en.initClass(tj),en.initClass(tG),en.initClass(tB),en.initClass(tq,tU),e6.$vizs=[],e1.noZoneId=4294967295,te.$regexHierarchicalFieldName=RegExp("\\[[^\\]]+\\]\\.","g"),tW.$currentVersion=new tW(2,8,0,"null"),window.tableau=window.tableauSoftware=j.tableauSoftware,tableauSoftware.Promise=tQ._PromiseImpl,tQ._Deferred=tQ._DeferredImpl,tQ._Collection=tQ._CollectionImpl,tQ._ApiBootstrap.initialize(),window.tableau._apiLoaded=!0}();